<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Models\Template.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Reflection;
using System.Runtime.Serialization;
using System.Text;
using Umbraco.Core.Configuration;
using Umbraco.Core.Configuration.UmbracoSettings;
using Umbraco.Core.IO;
using Umbraco.Core.Models.EntityBase;
using Umbraco.Core.Services;
using Umbraco.Core.Strings;

namespace Umbraco.Core.Models
{
    /// &lt;summary&gt;
    /// Represents a Template file
    /// &lt;/summary&gt;
    [Serializable]
    [DataContract(IsReference = true)]
    public class Template : File, ITemplate
    {
        private string _alias;
        private string _name;
        private string _masterTemplateAlias;
        private Lazy&lt;int&gt; _masterTemplateId;

        private static readonly Lazy&lt;PropertySelectors&gt; Ps = new Lazy&lt;PropertySelectors&gt;();

        private class PropertySelectors
        {
            public readonly PropertyInfo MasterTemplateAliasSelector = ExpressionHelper.GetPropertyInfo&lt;Template, string&gt;(x =&gt; x.MasterTemplateAlias);
            public readonly PropertyInfo MasterTemplateIdSelector = ExpressionHelper.GetPropertyInfo&lt;Template, Lazy&lt;int&gt;&gt;(x =&gt; x.MasterTemplateId);
            public readonly PropertyInfo AliasSelector = ExpressionHelper.GetPropertyInfo&lt;Template, string&gt;(x =&gt; x.Alias);
            public readonly PropertyInfo NameSelector = ExpressionHelper.GetPropertyInfo&lt;Template, string&gt;(x =&gt; x.Name);
        }

        public Template(string name, string alias)
            : this(name, alias, (Func&lt;File, string&gt;) null)
        { }

        internal Template(string name, string alias, Func&lt;File, string&gt; getFileContent)
            : base(string.Empty, getFileContent)
        {
            _name = name;
            _alias = alias.ToCleanString(CleanStringType.UnderscoreAlias);
            _masterTemplateId = new Lazy&lt;int&gt;(() =&gt; -1);
        }

        [Obsolete(&quot;This constructor should not be used, file path is determined by alias, setting the path here will have no affect&quot;)]
        public Template(string path, string name, string alias)
            : this(name, alias)
        {            
        }

        [DataMember]
        public Lazy&lt;int&gt; MasterTemplateId
        {
            get { return _masterTemplateId; }
            set { SetPropertyValueAndDetectChanges(value, ref _masterTemplateId, Ps.Value.MasterTemplateIdSelector); }
        }

        public string MasterTemplateAlias
        {
            get { return _masterTemplateAlias; }
            set { SetPropertyValueAndDetectChanges(value, ref _masterTemplateAlias, Ps.Value.MasterTemplateAliasSelector); }
        }

        [DataMember]
        public new string Name
        {
            get { return _name; }
            set { SetPropertyValueAndDetectChanges(value, ref _name, Ps.Value.NameSelector); }
        }

        [DataMember]
        public new string Alias
        {
            get { return _alias; }
            set { SetPropertyValueAndDetectChanges(value.ToCleanString(CleanStringType.UnderscoreAlias), ref _alias, Ps.Value.AliasSelector); }
        }

        /// &lt;summary&gt;
        /// Returns true if the template is used as a layout for other templates (i.e. it has &#39;children&#39;)
        /// &lt;/summary&gt;
        public bool IsMasterTemplate { get; internal set; }

        [Obsolete(&quot;This is no longer used and will be removed from the codebase in future versions, use the IFileSystem DetermineRenderingEngine method instead&quot;)]
        public RenderingEngine GetTypeOfRenderingEngine()
        {
            //Hack! TODO: Remove this method entirely
            return ApplicationContext.Current.Services.FileService.DetermineTemplateRenderingEngine(this);
        }

        public void SetMasterTemplate(ITemplate masterTemplate)
        {
            if (masterTemplate == null)
            {
                MasterTemplateId = new Lazy&lt;int&gt;(() =&gt; -1);
                MasterTemplateAlias = null;
            }
            else
            {
                MasterTemplateId = new Lazy&lt;int&gt;(() =&gt; masterTemplate.Id);
                MasterTemplateAlias = masterTemplate.Alias;
            }
           
        }

        protected override void DeepCloneNameAndAlias(File clone)
        {
            // do nothing - prevents File from doing its stuff
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[29,9,29,92,1],[33,13,33,151,1],[34,13,34,148,1],[35,13,35,123,1],[36,13,36,121,1],[40,15,40,59,1],[41,9,41,10,1],[41,11,41,12,1],[44,15,44,49,1],[45,9,45,10,1],[46,13,46,26,1],[47,13,47,75,1],[48,13,48,53,1],[48,53,48,55,1],[48,55,48,57,1],[48,13,48,57,1],[49,9,49,10,1],[53,15,53,32,1],[54,9,54,10,1],[55,9,55,10,1],[60,17,60,18,1],[60,19,60,44,1],[60,45,60,46,1],[61,17,61,18,1],[61,19,61,117,1],[61,118,61,119,1],[66,17,66,18,1],[66,19,66,47,1],[66,48,66,49,1],[67,17,67,18,1],[67,19,67,123,1],[67,124,67,125,1],[73,17,73,18,1],[73,19,73,32,1],[73,33,73,34,1],[74,17,74,18,0],[74,19,74,93,0],[74,94,74,95,0],[80,17,80,18,1],[80,19,80,33,1],[80,34,80,35,1],[81,17,81,18,1],[81,19,81,142,1],[81,143,81,144,1],[87,40,87,44,1],[87,45,87,58,1],[91,9,91,10,0],[93,13,93,107,0],[94,9,94,10,0],[97,9,97,10,1],[98,13,98,40,1],[99,13,99,14,1],[100,17,100,56,1],[100,56,100,58,1],[100,58,100,60,1],[100,17,100,60,1],[101,17,101,44,1],[102,13,102,14,1],[104,13,104,14,1],[105,17,105,56,1],[105,56,105,73,1],[105,73,105,75,1],[105,17,105,75,1],[106,17,106,60,1],[107,13,107,14,1],[109,9,109,10,1],[112,9,112,10,1],[114,9,114,10,1]]);
    </script>
  </body>
</html>