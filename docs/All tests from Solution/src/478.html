<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\webservices\Developer.asmx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Globalization;
using System.Web.Services;
using System.Xml;
using Umbraco.Core;
using Umbraco.Web.WebServices;
using umbraco.BusinessLogic;
using umbraco.presentation.webservices;

namespace umbraco.webservices
{
	/// &lt;summary&gt;
	/// Summary description for Developer.
	/// &lt;/summary&gt;
	[WebService(Namespace=&quot;http://umbraco.org/webservices/&quot;)]
    public class Developer : UmbracoAuthorizedWebService
	{
		
		[WebMethod]
		public string BootStrapTidy(string html, string ContextID)
		{
            //pretty sure this is legacy and it used to throw an exception so we&#39;ll continue to do the same
            //true = throw if invalid
		    AuthorizeRequest(true);

			return cms.helpers.xhtml.BootstrapTidy(html);
		}

		[WebMethod]
		public XmlNode GetMacros(string Login, string Password)
		{
		    if (ValidateCredentials(Login, Password) 
                &amp;&amp; UserHasAppAccess(DefaultApps.developer.ToString(), Login))  
			{
				var xmlDoc = new XmlDocument();
				var macros = xmlDoc.CreateElement(&quot;macros&quot;);
				foreach (var m in cms.businesslogic.macro.Macro.GetAll()) 
				{
					var mXml = xmlDoc.CreateElement(&quot;macro&quot;);
					mXml.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;id&quot;, m.Id.ToString(CultureInfo.InvariantCulture)));
                    mXml.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;alias&quot;, m.Alias));
                    mXml.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;name&quot;, m.Name));
					macros.AppendChild(mXml);
				}
				return macros;
			}
		    return null;
		}

	    [WebMethod]
		public XmlNode GetMacro(int Id, string Login, string Password)
		{
		    if (ValidateCredentials(Login, Password)
                &amp;&amp; UserHasAppAccess(DefaultApps.developer.ToString(), Login)) 
			{
				var xmlDoc = new XmlDocument();
				var macro = xmlDoc.CreateElement(&quot;macro&quot;);
				var m = new cms.businesslogic.macro.Macro(Id);
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;id&quot;, m.Id.ToString(CultureInfo.InvariantCulture)));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;refreshRate&quot;, m.RefreshRate.ToString(CultureInfo.InvariantCulture)));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;useInEditor&quot;, m.UseInEditor.ToString()));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;alias&quot;, m.Alias));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;name&quot;, m.Name));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;assembly&quot;, m.Assembly));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;type&quot;, m.Type));
                macro.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;xslt&quot;, m.Xslt));
				var properties = xmlDoc.CreateElement(&quot;properties&quot;);
				foreach (var mp in m.Properties) 
				{
					var pXml = xmlDoc.CreateElement(&quot;property&quot;);
                    pXml.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;alias&quot;, mp.Alias));
                    pXml.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;name&quot;, mp.Name));
				    pXml.Attributes.Append(XmlHelper.AddAttribute(xmlDoc, &quot;public&quot;, true.ToString()));
					properties.AppendChild(pXml);
				}
				macro.AppendChild(properties);
				return macro;
			}
		    return null;
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[20,3,20,4,0],[23,7,23,30,0],[25,4,25,49,0],[26,3,26,4,0],[30,3,30,4,0],[31,7,32,78,0],[33,4,33,5,0],[34,5,34,36,0],[35,5,35,49,0],[36,5,36,12,0],[36,14,36,19,0],[36,20,36,22,0],[36,23,36,61,0],[37,5,37,6,0],[38,6,38,47,0],[39,6,39,112,0],[40,21,40,94,0],[41,21,41,92,0],[42,6,42,31,0],[43,5,43,6,0],[44,5,44,19,0],[46,7,46,19,0],[47,3,47,4,0],[51,3,51,4,0],[52,7,53,78,0],[54,4,54,5,0],[55,5,55,36,0],[56,5,56,47,0],[57,5,57,51,0],[58,17,58,124,0],[59,17,59,142,0],[60,17,60,114,0],[61,17,61,91,0],[62,17,62,89,0],[63,17,63,97,0],[64,17,64,89,0],[65,17,65,89,0],[66,5,66,57,0],[67,5,67,12,0],[67,14,67,20,0],[67,21,67,23,0],[67,24,67,36,0],[68,5,68,6,0],[69,6,69,50,0],[70,21,70,95,0],[71,21,71,93,0],[72,9,72,91,0],[73,6,73,35,0],[74,5,74,6,0],[75,5,75,35,0],[76,5,76,18,0],[78,7,78,19,0],[79,3,79,4,0]]);
    </script>
  </body>
</html>