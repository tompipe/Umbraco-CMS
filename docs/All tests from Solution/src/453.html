<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\uQuery\NodeExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Xml;
using umbraco.cms.businesslogic.web;
using umbraco.interfaces;
using umbraco.NodeFactory;

namespace umbraco
{
    /// &lt;summary&gt;
    /// uQuery extensions for the Node object.
    /// &lt;/summary&gt;
    public static class NodeExtensions
    {
        /// &lt;summary&gt;
        /// Gets the ancestor by path level.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;level&quot;&gt;The level.&lt;/param&gt;
        /// &lt;returns&gt;Returns an ancestor node by path level.&lt;/returns&gt;
        public static Node GetAncestorByPathLevel(this Node node, int level)
        {
            return (Node)GetAncestorByPathLevel((INode)node, level);
        }

        /// &lt;summary&gt;
        /// Gets the ancestor by path level.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;level&quot;&gt;The level.&lt;/param&gt;
        /// &lt;returns&gt;Returns an ancestor node by path level.&lt;/returns&gt;
        public static INode GetAncestorByPathLevel(this INode node, int level)
        {
            var nodeId = uQuery.GetNodeIdByPathLevel(node.Path, level);
            return uQuery.GetNode(nodeId);
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;ancestor&#39;
        /// Get the Ancestor Nodes from current to root, (useful for breadcrumbs)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetAncestorNodes(this Node node)
        {
            return GetAncestorNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;ancestor&#39;
        /// Get the Ancestor Nodes from current to root (useful for breadcrumbs)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetAncestorNodes(this INode node)
        {
            var ancestor = node.Parent;

            while (ancestor != null)
            {
                yield return ancestor as INode;

                ancestor = ancestor.Parent;
            }
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;ancestor-or-self&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetAncestorOrSelfNodes(this Node node)
        {
            return GetAncestorOrSelfNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;ancestor-or-self&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetAncestorOrSelfNodes(this INode node)
        {
            yield return node;

            foreach (var ancestor in node.GetAncestorNodes())
            {
                yield return ancestor;
            }
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;preceding-sibling&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetPrecedingSiblingNodes(this Node node)
        {
            return GetPrecedingSiblingNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;preceding-sibling&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetPrecedingSiblingNodes(this INode node)
        {
            if (node.Parent != null)
            {
                var parentNode = node.Parent as INode;
                foreach (var precedingSiblingNode in parentNode.GetChildNodes().Where(childNode =&gt; childNode.SortOrder &lt; node.SortOrder))
                {
                    yield return precedingSiblingNode;
                }
            }
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;following-sibling&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetFollowingSiblingNodes(this Node node)
        {
            return GetFollowingSiblingNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;following-sibling&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetFollowingSiblingNodes(this INode node)
        {
            if (node.Parent != null)
            {
                var parentNode = node.Parent as INode;
                foreach (var followingSiblingNode in parentNode.GetChildNodes().Where(childNode =&gt; childNode.SortOrder &gt; node.SortOrder))
                {
                    yield return followingSiblingNode;
                }
            }
        }

        /// &lt;summary&gt;
        /// Gets all sibling Nodes
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetSiblingNodes(this Node node)
        {
            return GetSiblingNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Gets all sibling Nodes
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetSiblingNodes(this INode node)
        {
            if (node.Parent != null)
            {
                var parentNode = node.Parent as INode;
                foreach (var siblingNode in parentNode.GetChildNodes().Where(childNode =&gt; childNode.Id != node.Id))
                {
                    yield return siblingNode;
                }
            }
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;descendant-or-self&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetDescendantOrSelfNodes(this Node node)
        {
            return GetDescendantOrSelfNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;descendant-or-self&#39;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetDescendantOrSelfNodes(this INode node)
        {
            yield return node;

            foreach (var descendant in node.GetDescendantNodes())
            {
                yield return descendant;
            }
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;descendant&#39;
        /// Make the All Descendants LINQ queryable
        /// taken from: http://our.umbraco.org/wiki/how-tos/useful-helper-extension-methods-%28linq-null-safe-access%29
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetDescendantNodes(this Node node)
        {
            return GetDescendantNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;descendant&#39;
        /// Make the All Descendants LINQ queryable
        /// taken from: http://our.umbraco.org/wiki/how-tos/useful-helper-extension-methods-%28linq-null-safe-access%29
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetDescendantNodes(this INode node)
        {
            foreach (INode child in node.ChildrenAsList)
            {
                yield return child;

                foreach (var descendant in child.GetDescendantNodes())
                {
                    yield return descendant;
                }
            }
        }

        /// &lt;summary&gt;
        /// Drills down into the descendant nodes returning those where Func is true, when Func is false further descendants are not checked
        /// taken from: http://ucomponents.codeplex.com/discussions/246406
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.presentation.nodeFactory.Node&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;func&quot;&gt;The func&lt;/param&gt;
        /// &lt;returns&gt;Nodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetDescendantNodes(this Node node, Func&lt;Node, bool&gt; func)
        {
            Func&lt;INode, bool&gt; convertedFunc = x =&gt; func((Node)x);
            return GetDescendantNodes((INode)node, convertedFunc).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Drills down into the descendant nodes returning those where Func is true, when Func is false further descendants are not checked
        /// taken from: http://ucomponents.codeplex.com/discussions/246406
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.interfaces.INode&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;func&quot;&gt;The func&lt;/param&gt;
        /// &lt;returns&gt;INode as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetDescendantNodes(this INode node, Func&lt;INode, bool&gt; func)
        {
            foreach (INode child in node.ChildrenAsList)
            {
                if (func(child))
                {
                    yield return child;

                    foreach (var descendant in child.GetDescendantNodes(func))
                    {
                        yield return descendant;
                    }
                }
            }
        }

        /// &lt;summary&gt;
        /// Gets the descendant nodes by document-type.
        /// Get all descendants, and then return only those that match the requested typeAlias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.presentation.nodeFactory.Node&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;documentTypeAlias&quot;&gt;The document type alias.&lt;/param&gt;
        /// &lt;returns&gt;Nodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetDescendantNodesByType(this Node node, string documentTypeAlias)
        {
            return GetDescendantNodesByType((INode)node, documentTypeAlias).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Gets the descendant nodes by document-type.
        /// Get all descendants, and then return only those that match the requested typeAlias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.interfaces.INode&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;documentTypeAlias&quot;&gt;The document type alias.&lt;/param&gt;
        /// &lt;returns&gt;INodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetDescendantNodesByType(this INode node, string documentTypeAlias)
        {
            return node.GetDescendantNodes().Where(x =&gt; x.NodeTypeAlias == documentTypeAlias);
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;child&#39;
        /// Make the imediate Children LINQ queryable
        /// Performance optimised for just imediate children.
        /// taken from: http://our.umbraco.org/wiki/how-tos/useful-helper-extension-methods-%28linq-null-safe-access%29
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;returns&gt;Node as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetChildNodes(this Node node)
        {
            return GetChildNodes((INode)node).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Functionally similar to the XPath axis &#39;child&#39;
        /// Make the imediate Children LINQ queryable
        /// Performance optimised for just imediate children.
        /// taken from: http://our.umbraco.org/wiki/how-tos/useful-helper-extension-methods-%28linq-null-safe-access%29
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;returns&gt;INode as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetChildNodes(this INode node)
        {
            return node.ChildrenAsList;
        }

        /// &lt;summary&gt;
        /// Gets the child nodes.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.presentation.nodeFactory.Node&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;func&quot;&gt;The func.&lt;/param&gt;
        /// &lt;returns&gt;Nodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetChildNodes(this Node node, Func&lt;Node, bool&gt; func)
        {
            Func&lt;INode, bool&gt; convertedFunc = x =&gt; func((Node)x);
            return GetChildNodes((INode)node, convertedFunc).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Gets the child nodes.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.interfaces.INode&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;func&quot;&gt;The func.&lt;/param&gt;
        /// &lt;returns&gt;INodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetChildNodes(this INode node, Func&lt;INode, bool&gt; func)
        {
            foreach (INode child in node.ChildrenAsList)
            {
                if (func(child))
                {
                    yield return child;
                }
            }
        }

        /// &lt;summary&gt;
        /// Gets the child nodes by document-type.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.presentation.nodeFactory.Node&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;documentTypeAlias&quot;&gt;The document type alias.&lt;/param&gt;
        /// &lt;returns&gt;Nodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetChildNodesByType(this Node node, string documentTypeAlias)
        {
            return GetChildNodesByType((INode)node, documentTypeAlias).Cast&lt;Node&gt;();
        }

        /// &lt;summary&gt;
        /// Gets the child nodes by document-type.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The &lt;c&gt;umbraco.interfaces.INode&lt;/c&gt;.&lt;/param&gt;
        /// &lt;param name=&quot;documentTypeAlias&quot;&gt;The document type alias.&lt;/param&gt;
        /// &lt;returns&gt;INodes as IEnumerable&lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetChildNodesByType(this INode node, string documentTypeAlias)
        {
            return node.GetChildNodes(n =&gt; n.NodeTypeAlias == documentTypeAlias);
        }

        /// &lt;summary&gt;
        /// Extension method on Node to retun a matching child node by name
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;parentNode&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;nodeName&quot;&gt;name of node to search for&lt;/param&gt;
        /// &lt;returns&gt;null or Node&lt;/returns&gt;
        public static Node GetChildNodeByName(this Node parentNode, string nodeName)
        {
            return (Node)GetChildNodeByName((INode)parentNode, nodeName);
        }

        /// &lt;summary&gt;
        /// Extension method on Node to retun a matching child node by name
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;parentNode&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;nodeName&quot;&gt;name of node to search for&lt;/param&gt;
        /// &lt;returns&gt;null or INode&lt;/returns&gt;
        public static INode GetChildNodeByName(this INode parentNode, string nodeName)
        {
            return parentNode.ChildrenAsList.FirstOrDefault(child =&gt; child.Name == nodeName);
        }

        /// &lt;summary&gt;
        /// Determines whether the specified node has property.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;The property alias.&lt;/param&gt;
        /// &lt;returns&gt;
        ///   &lt;c&gt;true&lt;/c&gt; if the specified node has property; otherwise, &lt;c&gt;false&lt;/c&gt;.
        /// &lt;/returns&gt;
        public static bool HasProperty(this Node node, string propertyAlias)
        {
            return HasProperty((INode)node, propertyAlias);
        }

        /// &lt;summary&gt;
        /// Determines whether the specified node has property.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The INode.&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;The property alias.&lt;/param&gt;
        /// &lt;returns&gt;
        ///   &lt;c&gt;true&lt;/c&gt; if the specified node has property; otherwise, &lt;c&gt;false&lt;/c&gt;.
        /// &lt;/returns&gt;
        public static bool HasProperty(this INode node, string propertyAlias)
        {
            var property = node.GetProperty(propertyAlias);
            return (property != null);
        }

        /// &lt;summary&gt;
        /// Get a value of type T from a property
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;type T to cast to&lt;/typeparam&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of property to get&lt;/param&gt;
        /// &lt;returns&gt;default(T) or property cast to (T)&lt;/returns&gt;
        public static T GetProperty&lt;T&gt;(this Node node, string propertyAlias)
        {
            return GetProperty&lt;T&gt;((INode)node, propertyAlias);
        }

        /// &lt;summary&gt;
        /// Get a value of type T from a property
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;type T to cast to&lt;/typeparam&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of property to get&lt;/param&gt;
        /// &lt;returns&gt;default(T) or property cast to (T)&lt;/returns&gt;
        public static T GetProperty&lt;T&gt;(this INode node, string propertyAlias)
        {
            // check to see if return object handles it&#39;s own object hydration
            if (typeof(uQuery.IGetProperty).IsAssignableFrom(typeof(T)))
            {
                // create new instance of T with empty constructor
                uQuery.IGetProperty t = (uQuery.IGetProperty)Activator.CreateInstance&lt;T&gt;();

                // call method to hydrate the object from a string value
                t.LoadPropertyValue(node.GetProperty&lt;string&gt;(propertyAlias));

                return (T)t;
            }

            //TODO: This should be converted to our extension method TryConvertTo&lt;T&gt; ....

            var typeConverter = TypeDescriptor.GetConverter(typeof(T));
            if (typeConverter != null)
            {

                // Boolean
                if (typeof(T) == typeof(bool))
                {
                    // Use the GetPropertyAsBoolean method, as this handles true also being stored as &quot;1&quot;
                    return (T)typeConverter.ConvertFrom(node.GetPropertyAsBoolean(propertyAlias).ToString());
                }

                // XmlDocument
                else if (typeof(T) == typeof(XmlDocument))
                {
                    var xmlDocument = new XmlDocument();

                    try
                    {
                        xmlDocument.LoadXml(node.GetPropertyAsString(propertyAlias));
                    }
                    catch
                    {
                        // xml probably invalid
                    }

                    return (T)((object)xmlDocument);
                }

//                // umbraco.MacroEngines DynamicXml
                //                else if (typeof(T) == typeof(DynamicXml))
                //                {
                //                    try
                //                    {
                //                        return (T)((object)new DynamicXml(node.GetPropertyAsString(propertyAlias)));
                //                    }
                //                    catch
                //                    {
                //                    }
                //                }
                else
                {
                    try
                    {
                        return (T)typeConverter.ConvertFromString(node.GetPropertyAsString(propertyAlias));
                    }
                    catch
                    {
                    }
                }
            }

            return default(T);
        }

        /// &lt;summary&gt;
        /// Get a string value for the supplied property alias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of propety to get&lt;/param&gt;
        /// &lt;returns&gt;empty string, or property value as string&lt;/returns&gt;
        private static string GetPropertyAsString(this Node node, string propertyAlias)
        {
            return GetPropertyAsString((INode)node, propertyAlias);
        }

        /// &lt;summary&gt;
        /// Get a string value for the supplied property alias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of propety to get&lt;/param&gt;
        /// &lt;returns&gt;empty string, or property value as string&lt;/returns&gt;
        private static string GetPropertyAsString(this INode node, string propertyAlias)
        {
            var propertyValue = string.Empty;
            var property = node.GetProperty(propertyAlias);

            if (property != null)
            {
                propertyValue = property.Value;
            }

            return propertyValue;
        }

        /// &lt;summary&gt;
        /// Get a boolean value for the supplied property alias (works with built in Yes/No dataype)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of propety to get&lt;/param&gt;
        /// &lt;returns&gt;true if can cast value, else false for all other circumstances&lt;/returns&gt;
        private static bool GetPropertyAsBoolean(this Node node, string propertyAlias)
        {
            return GetPropertyAsBoolean((INode)node, propertyAlias);
        }

        /// &lt;summary&gt;
        /// Get a boolean value for the supplied property alias (works with built in Yes/No dataype)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of propety to get&lt;/param&gt;
        /// &lt;returns&gt;true if can cast value, else false for all other circumstances&lt;/returns&gt;
        private static bool GetPropertyAsBoolean(this INode node, string propertyAlias)
        {
            var propertyValue = false;
            var property = node.GetProperty(propertyAlias);

            if (property != null)
            {
                // Umbraco yes / no datatype stores a string value of &#39;1&#39; or &#39;0&#39;
                if (property.Value == &quot;1&quot;)
                {
                    propertyValue = true;
                }
                else
                {
                    bool.TryParse(property.Value, out propertyValue);
                }
            }

            return propertyValue;
        }

        /// &lt;summary&gt;
        /// Tell me the level of this node (0 = root)
        /// updated from Depth and changed to start at 0
        /// to align with other &#39;Level&#39; methods (eg xslt)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static int Level(this Node node)
        {
            return Level((INode)node);
        }

        /// &lt;summary&gt;
        /// Tell me the level of this node (0 = root)
        /// updated from Depth and changed to start at 0
        /// to align with other &#39;Level&#39; methods (eg xslt)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static int Level(this INode node)
        {
            return node.Path.Split(&#39;,&#39;).Length - 1;
        }

        /// &lt;summary&gt;
        /// Gets the XML for the Node.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;returns&gt;Returns an &lt;c&gt;XmlNode&lt;/c&gt; for the selected Node&lt;/returns&gt;
        public static XmlNode ToXml(this Node node)
        {
            return ToXml((INode)node);
        }

        /// &lt;summary&gt;
        /// Gets the XML for the Node.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The INode.&lt;/param&gt;
        /// &lt;returns&gt;Returns an &lt;c&gt;XmlNode&lt;/c&gt; for the selected Node&lt;/returns&gt;
        public static XmlNode ToXml(this INode node)
        {
            return ((IHasXmlNode)umbraco.library.GetXmlNodeById(node.Id.ToString()).Current).GetNode();
        }

        /// &lt;summary&gt;
        /// Returns the url for a given crop name using the built in Image Cropper datatype
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;property alias&lt;/param&gt;
        /// &lt;param name=&quot;cropName&quot;&gt;name of crop to get url for&lt;/param&gt;
        /// &lt;returns&gt;emtpy string or url&lt;/returns&gt;
        public static string GetImageCropperUrl(this Node node, string propertyAlias, string cropName)
        {
            return GetImageCropperUrl((INode)node, propertyAlias, cropName);
        }

        /// &lt;summary&gt;
        /// Returns the url for a given crop name using the built in Image Cropper datatype
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;property alias&lt;/param&gt;
        /// &lt;param name=&quot;cropName&quot;&gt;name of crop to get url for&lt;/param&gt;
        /// &lt;returns&gt;emtpy string or url&lt;/returns&gt;
        public static string GetImageCropperUrl(this INode node, string propertyAlias, string cropName)
        {
            string cropUrl = string.Empty;

            /*
            * Example xml : 
            * 
            * &lt;crops date=&quot;28/11/2010 16:08:13&quot;&gt;
            *   &lt;crop name=&quot;Big&quot; x=&quot;0&quot; y=&quot;0&quot; x2=&quot;1024&quot; y2=&quot;768&quot; url=&quot;/media/135/image_Big.jpg&quot; /&gt;
            *   &lt;crop name=&quot;Small&quot; x=&quot;181&quot; y=&quot;0&quot; x2=&quot;608&quot; y2=&quot;320&quot; url=&quot;/media/135/image_Small.jpg&quot; /&gt;
            * &lt;/crops&gt;
            * 
            */

            if (!string.IsNullOrEmpty(node.GetProperty&lt;string&gt;(propertyAlias)))
            {
                var xml = node.GetProperty&lt;string&gt;(propertyAlias);

                // TODO: [??] Add Node extension method: GetPropertyAsXmlNode()

                var xmlDocument = new XmlDocument();
                xmlDocument.LoadXml(xml);

                var cropNode = xmlDocument.SelectSingleNode(string.Concat(&quot;descendant::crops/crop[@name=&#39;&quot;, cropName, &quot;&#39;]&quot;));

                if (cropNode != null)
                {
                    cropUrl = cropNode.Attributes.GetNamedItem(&quot;url&quot;).InnerText;
                }
            }

            return cropUrl;
        }

        /// &lt;summary&gt;
        /// Sets a property value on this node
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of property to set&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;value to set&lt;/param&gt;
        /// &lt;returns&gt;the same node object on which this is an extension method&lt;/returns&gt;
        public static Node SetProperty(this Node node, string propertyAlias, object value)
        {
            return (Node)SetProperty((INode)node, propertyAlias, value);
        }

        /// &lt;summary&gt;
        /// Sets a property value on this node
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;propertyAlias&quot;&gt;alias of property to set&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;value to set&lt;/param&gt;
        /// &lt;returns&gt;the same node object on which this is an extension method&lt;/returns&gt;
        public static INode SetProperty(this INode node, string propertyAlias, object value)
        {
            var document = new Document(node.Id);

            document.SetProperty(propertyAlias, value);

            return node;
        }

        /// &lt;summary&gt;
        /// Republishes this node
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.presentation.nodeFactory.Node object&lt;/param&gt;
        /// &lt;param name=&quot;useAdminUser&quot;&gt;if true then publishes under the context of User(0), if false uses current user&lt;/param&gt;
        /// &lt;returns&gt;the same node object on which this is an extension method&lt;/returns&gt;
        public static Node Publish(this Node node, bool useAdminUser)
        {
            return (Node)Publish((INode)node, useAdminUser);
        }

        /// &lt;summary&gt;
        /// Republishes this node
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;an umbraco.interfaces.INode object&lt;/param&gt;
        /// &lt;param name=&quot;useAdminUser&quot;&gt;if true then publishes under the context of User(0), if false uses current user&lt;/param&gt;
        /// &lt;returns&gt;the same node object on which this is an extension method&lt;/returns&gt;
        public static INode Publish(this INode node, bool useAdminUser)
        {
            var document = new Document(node.Id);

            document.Publish(useAdminUser);

            return node;
        }

        /// &lt;summary&gt;
        /// Gets a random node.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodes&quot;&gt;The nodes.&lt;/param&gt;
        /// &lt;returns&gt;
        /// Returns a random node from a collection of nodes.
        /// &lt;/returns&gt;
        public static Node GetRandom(this IList&lt;Node&gt; nodes)
        {
            return (Node)GetRandom(nodes.Cast&lt;INode&gt;().ToList());
        }

        /// &lt;summary&gt;
        /// Gets a random node.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodes&quot;&gt;The nodes.&lt;/param&gt;
        /// &lt;returns&gt;
        /// Returns a random INode from a collection of INodes.
        /// &lt;/returns&gt;
        public static INode GetRandom(this IList&lt;INode&gt; nodes)
        {
            var random = umbraco.library.GetRandom();
            return nodes[random.Next(0, nodes.Count)];
        }

        /// &lt;summary&gt;
        /// Gets a collection of random nodes.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodes&quot;&gt;The nodes.&lt;/param&gt;
        /// &lt;param name=&quot;numberOfItems&quot;&gt;The number of items.&lt;/param&gt;
        /// &lt;returns&gt;
        /// Returns the specified number of random nodes from a collection of nodes.
        /// &lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; GetRandom(this IList&lt;Node&gt; nodes, int numberOfItems)
        {
            var randomNodes = GetRandom(nodes.Cast&lt;INode&gt;().ToList(), numberOfItems);
            return randomNodes.Cast&lt;Node&gt;().ToList();
        }

        /// &lt;summary&gt;
        /// Gets a collection of random nodes.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodes&quot;&gt;The nodes.&lt;/param&gt;
        /// &lt;param name=&quot;numberOfItems&quot;&gt;The number of items.&lt;/param&gt;
        /// &lt;returns&gt;
        /// Returns the specified number of random INodes from a collection of INodes.
        /// &lt;/returns&gt;
        public static IEnumerable&lt;INode&gt; GetRandom(this IList&lt;INode&gt; nodes, int numberOfItems)
        {
            var output = new List&lt;INode&gt;(numberOfItems);

            while (output.Count &lt; numberOfItems)
            {
                var randomNode = nodes.GetRandom();
                if (!output.Contains(randomNode))
                {
                    output.Add(randomNode);
                }
            }

            return output;
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this Node node)
        {
            return GetFullNiceUrl((INode)node);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node as INode.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this INode node)
        {
            if (!string.IsNullOrEmpty(node.NiceUrl) &amp;&amp; node.NiceUrl[0] == &#39;/&#39;)
            {
                return string.Concat(library.RequestServerVariables(&quot;HTTP_HOST&quot;), node.NiceUrl);
            }

            return node.NiceUrl;
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;language&quot;&gt;The language.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this Node node, string language)
        {
            return GetFullNiceUrl((INode)node, language);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node as INode.&lt;/param&gt;
        /// &lt;param name=&quot;language&quot;&gt;The language.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this INode node, string language)
        {
            return node.GetFullNiceUrl(language, false);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;language&quot;&gt;The language.&lt;/param&gt;
        /// &lt;param name=&quot;ssl&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [SSL].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this Node node, string language, bool ssl)
        {
            return GetFullNiceUrl((INode)node, language, ssl);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node as INode.&lt;/param&gt;
        /// &lt;param name=&quot;language&quot;&gt;The language.&lt;/param&gt;
        /// &lt;param name=&quot;ssl&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [SSL].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this INode node, string language, bool ssl)
        {
            foreach (var domain in library.GetCurrentDomains(node.Id))
            {
                if (domain.Language.Equals(language))
                {
                    return node.GetFullNiceUrl(domain, ssl);
                }
            }

            return string.Empty;
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;domain&quot;&gt;The domain.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this Node node, Domain domain)
        {
            return GetFullNiceUrl((INode)node, domain);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node as INode.&lt;/param&gt;
        /// &lt;param name=&quot;domain&quot;&gt;The domain.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this INode node, Domain domain)
        {
            return node.GetFullNiceUrl(domain, false);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node.&lt;/param&gt;
        /// &lt;param name=&quot;domain&quot;&gt;The domain.&lt;/param&gt;
        /// &lt;param name=&quot;ssl&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [SSL].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this Node node, Domain domain, bool ssl)
        {
            return GetFullNiceUrl((INode)node, domain, ssl);
        }

        /// &lt;summary&gt;
        /// Gets the full nice URL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;The node as INode.&lt;/param&gt;
        /// &lt;param name=&quot;domain&quot;&gt;The domain.&lt;/param&gt;
        /// &lt;param name=&quot;ssl&quot;&gt;if set to &lt;c&gt;true&lt;/c&gt; [SSL].&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFullNiceUrl(this INode node, Domain domain, bool ssl)
        {
            // TODO: [OA] Document on Codeplex
            if (!string.IsNullOrEmpty(node.NiceUrl) &amp;&amp; node.NiceUrl[0] == &#39;/&#39;)
            {
                return (ssl ? &quot;https://&quot; : &quot;http://&quot;) + domain.Name + node.NiceUrl;
            }

            return node.NiceUrl.Replace(library.RequestServerVariables(&quot;HTTP_HOST&quot;), string.Concat((ssl ? &quot;https://&quot; : &quot;http://&quot;), domain.Name));
        }


#pragma warning disable 0618

        /// &lt;summary&gt;
        /// Converts legacy nodeFactory collection to INode collection
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodes&quot;&gt;The legacy nodeFactory nodes.&lt;/param&gt;
        /// &lt;returns&gt;Returns the legacy nodeFactory nodes as INode nodes.&lt;/returns&gt;
        public static IEnumerable&lt;Node&gt; ToINodes(this IEnumerable&lt;umbraco.presentation.nodeFactory.Node&gt; nodes)
        {
            return nodes.Select(n =&gt; new Node(n.Id));
        }

        /// &lt;summary&gt;
        /// Converts INode collection to legacy nodeFactory collection
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodes&quot;&gt;The nodes.&lt;/param&gt;
        /// &lt;returns&gt;Returns the nodes as legacy nodeFactory nodes.&lt;/returns&gt;
        public static IEnumerable&lt;umbraco.presentation.nodeFactory.Node&gt; ToLegacyNodes(this IEnumerable&lt;Node&gt; nodes)
        {
            return nodes.Select(n =&gt; new umbraco.presentation.nodeFactory.Node(n.Id));
        }
#pragma warning restore 0618
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[24,9,24,10,0],[25,13,25,69,0],[26,9,26,10,0],[35,9,35,10,0],[36,13,36,72,0],[37,13,37,43,0],[38,9,38,10,0],[47,9,47,10,0],[48,13,48,63,0],[49,9,49,10,0],[75,9,75,10,0],[76,13,76,69,0],[77,9,77,10,0],[100,9,100,10,0],[101,13,101,71,0],[102,9,102,10,0],[127,9,127,10,0],[128,13,128,71,0],[129,9,129,10,0],[154,9,154,10,0],[155,13,155,62,0],[156,9,156,10,0],[181,9,181,10,0],[182,13,182,71,0],[183,9,183,10,0],[208,9,208,10,0],[209,13,209,65,0],[210,9,210,10,0],[240,9,240,10,0],[241,13,241,52,0],[241,52,241,65,0],[241,65,241,66,0],[241,13,241,66,0],[242,13,242,80,0],[243,9,243,10,0],[276,9,276,10,0],[277,13,277,90,0],[278,9,278,10,0],[288,9,288,10,0],[289,13,289,57,0],[289,57,289,93,0],[289,93,289,95,0],[289,13,289,95,0],[290,9,290,10,0],[301,9,301,10,0],[302,13,302,60,0],[303,9,303,10,0],[314,9,314,10,0],[315,13,315,40,0],[316,9,316,10,0],[325,9,325,10,0],[326,13,326,52,0],[326,52,326,65,0],[326,65,326,66,0],[326,13,326,66,0],[327,13,327,75,0],[328,9,328,10,0],[354,9,354,10,0],[355,13,355,85,0],[356,9,356,10,0],[365,9,365,10,0],[366,13,366,44,0],[366,44,366,80,0],[366,80,366,82,0],[366,13,366,82,0],[367,9,367,10,0],[376,9,376,10,0],[377,13,377,74,0],[378,9,378,10,0],[387,9,387,10,0],[388,13,388,70,0],[388,70,388,92,0],[388,92,388,94,0],[388,13,388,94,0],[389,9,389,10,0],[400,9,400,10,0],[401,13,401,60,0],[402,9,402,10,0],[413,9,413,10,0],[414,13,414,60,0],[415,13,415,39,0],[416,9,416,10,0],[426,9,426,10,0],[427,13,427,63,0],[428,9,428,10,0],[438,9,438,10,0],[440,13,440,73,0],[441,13,441,14,0],[443,17,443,92,0],[446,17,446,78,0],[448,17,448,29,0],[453,13,453,72,0],[454,13,454,39,0],[455,13,455,14,0],[458,17,458,47,0],[459,17,459,18,0],[461,21,461,110,0],[465,22,465,59,0],[466,17,466,18,0],[467,21,467,57,0],[470,21,470,22,0],[471,25,471,86,0],[472,21,472,22,0],[473,21,473,26,0],[474,21,474,22,0],[476,21,476,22,0],[478,21,478,53,0],[493,17,493,18,0],[495,21,495,22,0],[496,25,496,108,0],[498,21,498,26,0],[499,21,499,22,0],[500,21,500,22,0],[501,17,501,18,0],[502,13,502,14,0],[504,13,504,31,0],[505,9,505,10,0],[514,9,514,10,0],[515,13,515,68,0],[516,9,516,10,0],[525,9,525,10,0],[526,13,526,46,0],[527,13,527,60,0],[529,13,529,34,0],[530,13,530,14,0],[531,17,531,48,0],[532,13,532,14,0],[534,13,534,34,0],[535,9,535,10,0],[544,9,544,10,0],[545,13,545,69,0],[546,9,546,10,0],[555,9,555,10,0],[556,13,556,39,0],[557,13,557,60,0],[559,13,559,34,0],[560,13,560,14,0],[562,17,562,43,0],[563,17,563,18,0],[564,21,564,42,0],[565,17,565,18,0],[567,17,567,18,0],[568,21,568,70,0],[569,17,569,18,0],[570,13,570,14,0],[572,13,572,34,0],[573,9,573,10,0],[583,9,583,10,0],[584,13,584,39,0],[585,9,585,10,0],[595,9,595,10,0],[596,13,596,52,0],[597,9,597,10,0],[605,9,605,10,0],[606,13,606,39,0],[607,9,607,10,0],[615,9,615,10,0],[616,13,616,104,0],[617,9,617,10,0],[627,9,627,10,0],[628,13,628,77,0],[629,9,629,10,0],[639,9,639,10,0],[640,13,640,43,0],[652,13,652,80,0],[653,13,653,14,0],[654,17,654,67,0],[658,17,658,53,0],[659,17,659,42,0],[661,17,661,126,0],[663,17,663,38,0],[664,17,664,18,0],[665,21,665,81,0],[666,17,666,18,0],[667,13,667,14,0],[669,13,669,28,0],[670,9,670,10,0],[680,9,680,10,0],[681,13,681,73,0],[682,9,682,10,0],[692,9,692,10,0],[693,13,693,50,0],[695,13,695,56,0],[697,13,697,25,0],[698,9,698,10,0],[707,9,707,10,0],[708,13,708,61,0],[709,9,709,10,0],[718,9,718,10,0],[719,13,719,50,0],[721,13,721,44,0],[723,13,723,25,0],[724,9,724,10,0],[734,9,734,10,0],[735,13,735,66,0],[736,9,736,10,0],[746,9,746,10,0],[747,13,747,54,0],[748,13,748,55,0],[749,9,749,10,0],[760,9,760,10,0],[761,13,761,86,0],[762,13,762,54,0],[763,9,763,10,0],[774,9,774,10,0],[775,13,775,57,0],[777,13,777,49,0],[778,13,778,14,0],[779,17,779,52,0],[780,17,780,50,0],[781,17,781,18,0],[782,21,782,44,0],[783,17,783,18,0],[784,13,784,14,0],[786,13,786,27,0],[787,9,787,10,0],[795,9,795,10,0],[796,13,796,48,0],[797,9,797,10,0],[805,9,805,10,0],[806,13,806,79,0],[807,13,807,14,0],[808,17,808,97,0],[811,13,811,33,0],[812,9,812,10,0],[821,9,821,10,0],[822,13,822,58,0],[823,9,823,10,0],[832,9,832,10,0],[833,13,833,57,0],[834,9,834,10,0],[844,9,844,10,0],[845,13,845,63,0],[846,9,846,10,0],[856,9,856,10,0],[857,13,857,20,0],[857,22,857,32,0],[857,33,857,35,0],[857,36,857,70,0],[858,13,858,14,0],[859,17,859,54,0],[860,17,860,18,0],[861,21,861,61,0],[863,13,863,14,0],[865,13,865,33,0],[866,9,866,10,0],[875,9,875,10,0],[876,13,876,56,0],[877,9,877,10,0],[886,9,886,10,0],[887,13,887,55,0],[888,9,888,10,0],[898,9,898,10,0],[899,13,899,61,0],[900,9,900,10,0],[910,9,910,10,0],[912,13,912,79,0],[913,13,913,14,0],[914,17,914,84,0],[917,13,917,146,0],[918,9,918,10,0],[929,9,929,10,0],[930,13,930,38,0],[930,38,930,52,0],[930,52,930,54,0],[930,13,930,54,0],[931,9,931,10,0],[939,9,939,10,0],[940,13,940,38,0],[940,38,940,85,0],[940,85,940,87,0],[940,13,940,87,0],[941,9,941,10,0]]);
    </script>
  </body>
</html>