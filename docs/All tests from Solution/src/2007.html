<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Models\Relation.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Reflection;
using System.Runtime.Serialization;
using Umbraco.Core.Models.EntityBase;
using Umbraco.Core.Persistence.Mappers;

namespace Umbraco.Core.Models
{
    /// &lt;summary&gt;
    /// Represents a Relation between two items
    /// &lt;/summary&gt;
    [Serializable]
    [DataContract(IsReference = true)]
    public class Relation : Entity, IAggregateRoot, IRelation
    {
        //NOTE: The datetime column from umbracoRelation is set on CreateDate on the Entity
        private int _parentId;
        private int _childId;
        private IRelationType _relationType;
        private string _comment;

        public Relation(int parentId, int childId, IRelationType relationType)
        {
            _parentId = parentId;
            _childId = childId;
            _relationType = relationType;
        }

        private static readonly Lazy&lt;PropertySelectors&gt; Ps = new Lazy&lt;PropertySelectors&gt;();

        private class PropertySelectors
        {
            public readonly PropertyInfo ParentIdSelector = ExpressionHelper.GetPropertyInfo&lt;Relation, int&gt;(x =&gt; x.ParentId);
            public readonly PropertyInfo ChildIdSelector = ExpressionHelper.GetPropertyInfo&lt;Relation, int&gt;(x =&gt; x.ChildId);
            public readonly PropertyInfo RelationTypeSelector = ExpressionHelper.GetPropertyInfo&lt;Relation, IRelationType&gt;(x =&gt; x.RelationType);
            public readonly PropertyInfo CommentSelector = ExpressionHelper.GetPropertyInfo&lt;Relation, string&gt;(x =&gt; x.Comment);
        }

        /// &lt;summary&gt;
        /// Gets or sets the Parent Id of the Relation (Source)
        /// &lt;/summary&gt;
        [DataMember]
        public int ParentId
        {
            get { return _parentId; }
            set { SetPropertyValueAndDetectChanges(value, ref _parentId, Ps.Value.ParentIdSelector); }
        }

        /// &lt;summary&gt;
        /// Gets or sets the Child Id of the Relation (Destination)
        /// &lt;/summary&gt;
        [DataMember]
        public int ChildId
        {
            get { return _childId; }
            set { SetPropertyValueAndDetectChanges(value, ref _childId, Ps.Value.ChildIdSelector); }
        }

        /// &lt;summary&gt;
        /// Gets or sets the &lt;see cref=&quot;RelationType&quot;/&gt; for the Relation
        /// &lt;/summary&gt;
        [DataMember]
        public IRelationType RelationType
        {
            get { return _relationType; }
            set { SetPropertyValueAndDetectChanges(value, ref _relationType, Ps.Value.RelationTypeSelector); }
        }

        /// &lt;summary&gt;
        /// Gets or sets a comment for the Relation
        /// &lt;/summary&gt;
        [DataMember]
        public string Comment
        {
            get { return _comment; }
            set { SetPropertyValueAndDetectChanges(value, ref _comment, Ps.Value.CommentSelector); }
        }

        /// &lt;summary&gt;
        /// Gets the Id of the &lt;see cref=&quot;RelationType&quot;/&gt; that this Relation is based on.
        /// &lt;/summary&gt;
        [IgnoreDataMember]
        public int RelationTypeId
        {
            get { return _relationType.Id; }
        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,9,22,79,1],[23,9,23,10,1],[24,13,24,34,1],[25,13,25,32,1],[26,13,26,42,1],[27,9,27,10,1],[29,9,29,92,1],[33,13,33,126,1],[34,13,34,124,1],[35,13,35,144,1],[36,13,36,127,1],[45,17,45,18,1],[45,19,45,36,1],[45,37,45,38,1],[46,17,46,18,0],[46,19,46,101,0],[46,102,46,103,0],[55,17,55,18,1],[55,19,55,35,1],[55,36,55,37,1],[56,17,56,18,0],[56,19,56,99,0],[56,100,56,101,0],[65,17,65,18,1],[65,19,65,40,1],[65,41,65,42,1],[66,17,66,18,1],[66,19,66,109,1],[66,110,66,111,1],[75,17,75,18,1],[75,19,75,35,1],[75,36,75,37,1],[76,17,76,18,1],[76,19,76,99,1],[76,100,76,101,1],[85,17,85,18,1],[85,19,85,43,1],[85,44,85,45,1]]);
    </script>
  </body>
</html>