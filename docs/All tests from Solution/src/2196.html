<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Configuration\OptionalCommaDelimitedConfigurationElement.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Configuration;
using Umbraco.Core.Configuration.UmbracoSettings;

namespace Umbraco.Core.Configuration
{
    /// &lt;summary&gt;
    /// Used for specifying default values for comma delimited config
    /// &lt;/summary&gt;
    internal class OptionalCommaDelimitedConfigurationElement : CommaDelimitedConfigurationElement
    {
        private readonly CommaDelimitedConfigurationElement _wrapped;
        private readonly string[] _defaultValue;

        public OptionalCommaDelimitedConfigurationElement()
        {            
        }

        public OptionalCommaDelimitedConfigurationElement(CommaDelimitedConfigurationElement wrapped, string[] defaultValue)
        {
            _wrapped = wrapped;
            _defaultValue = defaultValue;
        }

        public override CommaDelimitedStringCollection Value
        {
            get
            {
                if (_wrapped == null)
                {
                    return base.Value;
                }

                if (string.IsNullOrEmpty(_wrapped.RawValue))
                {
                    var val = new CommaDelimitedStringCollection();
                    val.AddRange(_defaultValue);
                    return val;
                }
                return _wrapped.Value;
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,60,1],[15,9,15,10,1],[16,9,16,10,1],[18,9,18,125,1],[19,9,19,10,1],[20,13,20,32,1],[21,13,21,42,1],[22,9,22,10,1],[27,13,27,14,1],[28,17,28,38,1],[29,17,29,18,1],[30,21,30,39,1],[33,17,33,61,1],[34,17,34,18,1],[35,21,35,68,1],[36,21,36,49,1],[37,21,37,32,1],[39,17,39,39,1],[40,13,40,14,1]]);
    </script>
  </body>
</html>