<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\Slider\SliderDataType.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using umbraco.cms.businesslogic.datatype;
using umbraco.interfaces;

namespace umbraco.editorControls.Slider
{
    /// &lt;summary&gt;
    /// A jQuery UI Slider data-type for Umbraco.
    /// &lt;/summary&gt;
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class SliderDataType : AbstractDataEditor
    {
        /// &lt;summary&gt;
        /// The SliderControl.
        /// &lt;/summary&gt;
        private SliderControl m_Control = new SliderControl();

        /// &lt;summary&gt;
        /// The PreValue Editor for the data-type.
        /// &lt;/summary&gt;
        private SliderPrevalueEditor m_PreValueEditor;

        /// &lt;summary&gt;
        /// Initializes a new instance of the &lt;see cref=&quot;SliderDataType&quot;/&gt; class.
        /// &lt;/summary&gt;
        public SliderDataType()
            : base()
        {
            // set the render control as the placeholder
            this.RenderControl = this.m_Control;

            // assign the initialise event for the placeholder
            this.m_Control.Init += new EventHandler(this.m_Control_Init);

            // assign the save event for the data-type/editor
            this.DataEditorControl.OnSave += this.DataEditorControl_OnSave;
        }

        /// &lt;summary&gt;
        /// Gets the id of the data-type.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The id of the data-type.&lt;/value&gt;
        public override Guid Id
        {
            get
            {
                return new Guid(DataTypeGuids.SliderId);
            }
        }

        /// &lt;summary&gt;
        /// Gets the name of the data type.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The name of the data type.&lt;/value&gt;
        public override string DataTypeName
        {
            get
            {
                return &quot;Slider&quot;;
            }
        }

        /// &lt;summary&gt;
        /// Gets the prevalue editor.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The prevalue editor.&lt;/value&gt;
        public override IDataPrevalue PrevalueEditor
        {
            get
            {
                if (this.m_PreValueEditor == null)
                {
                    this.m_PreValueEditor = new SliderPrevalueEditor(this);
                }

                return this.m_PreValueEditor;
            }
        }

        /// &lt;summary&gt;
        /// Handles the Init event of the m_Placeholder control.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;The source of the event.&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;The &lt;see cref=&quot;System.EventArgs&quot;/&gt; instance containing the event data.&lt;/param&gt;
        private void m_Control_Init(object sender, EventArgs e)
        {
            // get the slider options from the Prevalue Editor.
            var options = ((SliderPrevalueEditor)this.PrevalueEditor).GetPreValueOptions&lt;SliderOptions&gt;();

            // set the value of the control (not on PostBack)
            if (!this.m_Control.Page.IsPostBack &amp;&amp; this.Data.Value != null)
            {
                var data = this.Data.Value.ToString();
                if (data.Length &gt; 0)
                {
                    double value1, value2;
                    var values = data.Split(&#39;,&#39;);

                    if (double.TryParse(values[0], out value1))
                    {
                        options.Value = value1;

                        if (values.Length &gt; 1 &amp;&amp; double.TryParse(values[1], out value2))
                        {
                            options.Value2 = value2;
                        }
                    }
                }
            }

            // set the slider options
            this.m_Control.Options = options;
        }

        /// &lt;summary&gt;
        /// Saves the editor control value.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;e&quot;&gt;The &lt;see cref=&quot;System.EventArgs&quot;/&gt; instance containing the event data.&lt;/param&gt;
        private void DataEditorControl_OnSave(EventArgs e)
        {
            // set the values (on PostBack)
            var value1 = this.m_Control.Options.MinValue;
            var value2 = this.m_Control.Options.MaxValue;
            var values = this.m_Control.Text.Split(&#39;,&#39;);

            if (double.TryParse(values[0], out value1))
            {
                this.m_Control.Options.Value = value1;

                if (values.Length &gt; 1 &amp;&amp; double.TryParse(values[1], out value2))
                {
                    this.m_Control.Options.Value2 = value2;
                }
            }

            // save the value of the control
            if (values.Length &gt; 1 &amp;&amp; value2 &gt;= this.m_Control.Options.MinValue
                &amp;&amp; value2 &lt;= this.m_Control.Options.MaxValue)
            {
                this.Data.Value = string.Concat(value1, &#39;,&#39;, value2);
            }
            else if (value1 &gt;= this.m_Control.Options.MinValue &amp;&amp; value1 &lt;= this.m_Control.Options.MaxValue)
            {
                int value1int;

                // return an integer instead of double if applicable
                if (this.m_Control.Options.DBType == DBTypes.Integer &amp;&amp; int.TryParse(value1.ToString(), out value1int))
                {
                    this.Data.Value = value1int;
                }
                else
                {
                    this.Data.Value = value1.ToString();
                }
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,63,0],[27,15,27,21,0],[28,9,28,10,0],[30,13,30,49,0],[33,13,33,74,0],[36,13,36,76,0],[37,9,37,10,0],[46,13,46,14,0],[47,17,47,57,0],[48,13,48,14,0],[58,13,58,14,0],[59,17,59,33,0],[60,13,60,14,0],[70,13,70,14,0],[71,17,71,51,0],[72,17,72,18,0],[73,21,73,76,0],[74,17,74,18,0],[76,17,76,46,0],[77,13,77,14,0],[86,9,86,10,0],[88,13,88,107,0],[91,13,91,76,0],[92,13,92,14,0],[93,17,93,55,0],[94,17,94,37,0],[95,17,95,18,0],[97,21,97,50,0],[99,21,99,64,0],[100,21,100,22,0],[101,25,101,48,0],[103,25,103,89,0],[104,25,104,26,0],[105,29,105,53,0],[106,25,106,26,0],[107,21,107,22,0],[108,17,108,18,0],[109,13,109,14,0],[112,13,112,46,0],[113,9,113,10,0],[120,9,120,10,0],[122,13,122,58,0],[123,13,123,58,0],[124,13,124,57,0],[126,13,126,56,0],[127,13,127,14,0],[128,17,128,55,0],[130,17,130,81,0],[131,17,131,18,0],[132,21,132,60,0],[133,17,133,18,0],[134,13,134,14,0],[137,13,138,62,0],[139,13,139,14,0],[140,17,140,70,0],[141,13,141,14,0],[142,18,142,109,0],[143,13,143,14,0],[147,17,147,120,0],[148,17,148,18,0],[149,21,149,49,0],[150,17,150,18,0],[152,17,152,18,0],[153,21,153,57,0],[154,17,154,18,0],[155,13,155,14,0],[156,9,156,10,0]]);
    </script>
  </body>
</html>