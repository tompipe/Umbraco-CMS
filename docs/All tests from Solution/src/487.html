<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\developer\Xslt\getXsltStatus.asmx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Web;
using System.Web.Services;
using System.Xml;
using System.IO;
using Umbraco.Core.IO;
using umbraco.presentation.webservices;

namespace umbraco.developer
{
	/// &lt;summary&gt;
	/// Summary description for getXsltStatus.
	/// &lt;/summary&gt;
	[WebService(Namespace=&quot;http://umbraco.org/webservices&quot;)]
	public class getXsltStatus : System.Web.Services.WebService
	{
		public getXsltStatus()
		{
			//CODEGEN: This call is required by the ASP.NET Web Services Designer
			InitializeComponent();
		}

		// TODO: Security-check
		[WebMethod]
		public XmlDocument FilesFromDirectory(string dir) 
		{
            legacyAjaxCalls.Authorize();

			XmlDocument xd = new XmlDocument();
			xd.LoadXml(&quot;&lt;files/&gt;&quot;);
			foreach (string file in System.IO.Directory.GetFiles(IOHelper.MapPath(SystemDirectories.Umbraco + &quot;/xslt/&quot; + dir), &quot;*.xsl*&quot;))
			{
				FileInfo fi = new FileInfo(file);
				FileAttributes fa = fi.Attributes;
				XmlElement fileXml = xd.CreateElement(&quot;file&quot;);
				fileXml.SetAttribute(&quot;name&quot;, fi.Name);
				//fileXml.SetAttribute(&quot;created&quot;, fi.CreationTimeUtc);
				fileXml.SetAttribute(&quot;modified&quot;, fi.LastWriteTimeUtc.ToString());
				fileXml.SetAttribute(&quot;size&quot;, fi.Length.ToString());
				xd.DocumentElement.AppendChild((XmlNode) fileXml);
			}
			return xd;
		}

		#region Component Designer generated code
		
		//Required by the Web Services Designer 
		private IContainer components = null;
				
		/// &lt;summary&gt;
		/// Required method for Designer support - do not modify
		/// the contents of this method with the code editor.
		/// &lt;/summary&gt;
		private void InitializeComponent()
		{
		}

		/// &lt;summary&gt;
		/// Clean up any resources being used.
		/// &lt;/summary&gt;
		protected override void Dispose( bool disposing )
		{
			if(disposing &amp;&amp; components != null)
			{
				components.Dispose();
			}
			base.Dispose(disposing);		
		}
		
		#endregion

		// WEB SERVICE EXAMPLE
		// The HelloWorld() example service returns the string Hello World
		// To build, uncomment the following lines then save and build the project
		// To test this web service, press F5

//		[WebMethod]
//		public string HelloWorld()
//		{
//			return &quot;Hello World&quot;;
//		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[21,3,21,25,0],[22,3,22,4,0],[24,4,24,26,0],[25,3,25,4,0],[30,3,30,4,0],[31,13,31,41,0],[33,4,33,39,0],[34,4,34,27,0],[35,4,35,11,0],[35,13,35,24,0],[35,25,35,27,0],[35,28,35,128,0],[36,4,36,5,0],[37,5,37,38,0],[38,5,38,39,0],[39,5,39,51,0],[40,5,40,43,0],[42,5,42,70,0],[43,5,43,56,0],[44,5,44,55,0],[45,4,45,5,0],[46,4,46,14,0],[47,3,47,4,0],[52,3,52,40,0],[59,3,59,4,0],[60,3,60,4,0],[66,3,66,4,0],[67,4,67,39,0],[68,4,68,5,0],[69,5,69,26,0],[70,4,70,5,0],[71,4,71,28,0],[72,3,72,4,0]]);
    </script>
  </body>
</html>