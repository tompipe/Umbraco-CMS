<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Resolvers\XsltExtensionsResolverTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Linq;
using Moq;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Core.Cache;
using Umbraco.Core.Logging;
using Umbraco.Core.Macros;
using Umbraco.Core.ObjectResolution;
using Umbraco.Core.Profiling;
using Umbraco.Web;
using Umbraco.Web.Macros;
using umbraco;

namespace Umbraco.Tests.Resolvers
{
    [TestFixture]
    public class XsltExtensionsResolverTests : ResolverBaseTest
    {
        [TearDown]
        public void TearDown()
        {
            ActionsResolver.Reset();
        }

        // NOTE
        // ManyResolverTests ensure that we&#39;ll get our actions back and ActionsResolver works,
        // so all we&#39;re testing here is that plugin manager _does_ find our actions
        // which should be ensured by PlugingManagerTests anyway, so this is useless?
        // maybe not as it seems to handle the &quot;instance&quot; thing... so we test that we respect the singleton?
        [Test]
        public void Find_All_Extensions()
        {
            XsltExtensionsResolver.Current = new XsltExtensionsResolver(
                new ActivatorServiceProvider(),ProfilingLogger.Logger,
                () =&gt; PluginManager.ResolveXsltExtensions());

            Resolution.Freeze();

            var extensions = XsltExtensionsResolver.Current.XsltExtensions;
            Assert.AreEqual(3, extensions.Count());

            Assert.IsTrue(extensions.Select(x =&gt; x.ExtensionObject.GetType()).Contains(typeof (XsltEx1)));
            Assert.IsTrue(extensions.Select(x =&gt; x.ExtensionObject.GetType()).Contains(typeof(XsltEx2)));
            Assert.AreEqual(&quot;test1&quot;, extensions.Single(x =&gt; x.ExtensionObject.GetType() == typeof(XsltEx1)).Namespace);
            Assert.AreEqual(&quot;test2&quot;, extensions.Single(x =&gt; x.ExtensionObject.GetType() == typeof(XsltEx2)).Namespace);
        }

        #region Classes for tests

        [Umbraco.Core.Macros.XsltExtension(&quot;test1&quot;)]
        public class XsltEx1
        {
            
        }

        //test with legacy one
        [umbraco.XsltExtension(&quot;test2&quot;)]
        public class XsltEx2
        {
        }

        #endregion
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[21,9,21,10,1],[22,13,22,37,1],[23,9,23,10,1],[32,9,32,10,1],[33,13,35,23,1],[35,23,35,60,1],[35,60,35,62,1],[33,13,35,62,1],[37,13,37,33,1],[39,13,39,76,1],[40,13,40,52,1],[42,13,42,50,1],[42,50,42,77,1],[42,77,42,107,1],[42,13,42,107,1],[43,13,43,50,1],[43,50,43,77,1],[43,77,43,106,1],[43,13,43,106,1],[44,13,44,61,1],[44,61,44,107,1],[44,107,44,120,1],[44,13,44,120,1],[45,13,45,61,1],[45,61,45,107,1],[45,107,45,120,1],[45,13,45,120,1],[46,9,46,10,1]]);
    </script>
  </body>
</html>