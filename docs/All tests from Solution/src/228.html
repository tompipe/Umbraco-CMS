<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Models\Collections\SimpleOrder.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.Linq;
using Umbraco.Core;

namespace Umbraco.Tests.Models.Collections
{
    public class SimpleOrder : KeyedCollection&lt;int, OrderItem&gt;, INotifyCollectionChanged
    {
        // The parameterless constructor of the base class creates a  
        // KeyedCollection with an internal dictionary. For this code  
        // example, no other constructors are exposed. 
        // 
        public SimpleOrder() : base() { }

        public SimpleOrder(IEnumerable&lt;OrderItem&gt; properties)
        {
            Reset(properties);
        }

        // This is the only method that absolutely must be overridden, 
        // because without it the KeyedCollection cannot extract the 
        // keys from the items. The input parameter type is the  
        // second generic type argument, in this case OrderItem, and  
        // the return value type is the first generic type argument, 
        // in this case int. 
        // 
        protected override int GetKeyForItem(OrderItem item)
        {
            // In this example, the key is the part number. 
            return item.PartNumber;
        }

        internal void Reset(IEnumerable&lt;OrderItem&gt; properties)
        {
            Clear();
            properties.ForEach(Add);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset));
        }

        protected override void SetItem(int index, OrderItem item)
        {
            base.SetItem(index, item);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, item, index));
        }

        protected override void RemoveItem(int index)
        {
            var removed = this[index];
            base.RemoveItem(index);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Remove, removed));
        }

        protected override void InsertItem(int index, OrderItem item)
        {
            base.InsertItem(index, item);
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, item));
        }

        protected override void ClearItems()
        {
            base.ClearItems();
            OnCollectionChanged(new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Reset));
        }

        public new bool Contains(int partNumber)
        {
            return this.Any(x =&gt; x.PartNumber == partNumber);
        }

        public event NotifyCollectionChangedEventHandler CollectionChanged;

        protected virtual void OnCollectionChanged(NotifyCollectionChangedEventArgs args)
        {
            if (CollectionChanged != null)
            {
                CollectionChanged(this, args);
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[15,32,15,38,1],[15,39,15,40,1],[15,41,15,42,1],[17,9,17,62,0],[18,9,18,10,0],[19,13,19,31,0],[20,9,20,10,0],[30,9,30,10,0],[32,13,32,36,0],[33,9,33,10,0],[36,9,36,10,0],[37,13,37,21,0],[38,13,38,37,0],[39,13,39,108,0],[40,9,40,10,0],[43,9,43,10,0],[44,13,44,39,0],[45,13,45,119,0],[46,9,46,10,0],[49,9,49,10,0],[50,13,50,39,0],[51,13,51,36,0],[52,13,52,118,0],[53,9,53,10,0],[56,9,56,10,0],[57,13,57,42,0],[58,13,58,112,0],[59,9,59,10,0],[62,9,62,10,0],[63,13,63,31,0],[64,13,64,108,0],[65,9,65,10,0],[68,9,68,10,0],[69,13,69,34,0],[69,34,69,60,0],[69,60,69,62,0],[69,13,69,62,0],[70,9,70,10,0],[75,9,75,10,0],[76,13,76,43,0],[77,13,77,14,0],[78,17,78,47,0],[79,13,79,14,0],[80,9,80,10,0]]);
    </script>
  </body>
</html>