<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Migrations\AlterMigrationTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Diagnostics;
using System.Linq;
using Moq;
using NUnit.Framework;
using Umbraco.Core.Logging;
using Umbraco.Core.Persistence;
using Umbraco.Core.Persistence.Migrations;
using Umbraco.Core.Persistence.SqlSyntax;
using Umbraco.Tests.Migrations.Stubs;

namespace Umbraco.Tests.Migrations
{
    [TestFixture]
    public class AlterMigrationTests
    {

        [Test]
        public void Drop_Foreign_Key()
        {
            // Arrange
            var context = new MigrationContext(DatabaseProviders.SqlServerCE, null, Mock.Of&lt;ILogger&gt;());
            var stub = new DropForeignKeyMigrationStub(new SqlCeSyntaxProvider(), Mock.Of&lt;ILogger&gt;());

            // Act
            stub.GetUpExpressions(context);

            // Assert
            Assert.That(context.Expressions.Count(), Is.EqualTo(1));
            Assert.That(context.Expressions.Single().ToString(), Is.EqualTo(&quot;ALTER TABLE [umbracoUser2app] DROP CONSTRAINT [FK_umbracoUser2app_umbracoUser_id]&quot;));

        }

        [NUnit.Framework.Ignore(&quot;this doesn&#39;t actually test anything&quot;)]
        [Test]
        public void Can_Get_Up_Migration_From_MigrationStub()
        {
            // Arrange
            var context = new MigrationContext(DatabaseProviders.SqlServerCE, null, Mock.Of&lt;ILogger&gt;());
            var stub = new AlterUserTableMigrationStub(new SqlCeSyntaxProvider(), Mock.Of&lt;ILogger&gt;());

            // Act
            stub.GetUpExpressions(context);

            // Assert
            Assert.That(context.Expressions.Any(), Is.True);

            //Console output
            Debug.Print(&quot;Number of expressions in context: {0}&quot;, context.Expressions.Count);
            Debug.Print(&quot;&quot;);
            foreach (var expression in context.Expressions)
            {
                Debug.Print(expression.ToString());
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[20,9,20,10,1],[22,13,22,105,1],[23,13,23,103,1],[26,13,26,44,1],[29,13,29,69,1],[30,13,30,163,1],[32,9,32,10,1],[37,9,37,10,0],[39,13,39,105,0],[40,13,40,103,0],[43,13,43,44,0],[46,13,46,61,0],[49,13,49,93,0],[50,13,50,29,0],[51,13,51,20,0],[51,22,51,36,0],[51,37,51,39,0],[51,40,51,59,0],[52,13,52,14,0],[53,17,53,52,0],[54,13,54,14,0],[55,9,55,10,0]]);
    </script>
  </body>
</html>