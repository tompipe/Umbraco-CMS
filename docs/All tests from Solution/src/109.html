<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\CodeFirst\ContentTypeMapper.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using Umbraco.Core;
using Umbraco.Core.Models;

namespace Umbraco.Tests.CodeFirst
{
    public static class ContentTypeMapper
    {
        public static T Map&lt;T&gt;(IPublishedContent content) where T : ContentTypeBase, new()
        {
            //TODO Verify passed in type T against DocumentType name/alias
            //TODO Cache mapped properties?

            T mapped = new T();
            mapped.Content = content;

            var propertyInfos = typeof(T).GetProperties();

            foreach (var property in content.Properties)
            {
                var @alias = property.PropertyTypeAlias.ToLowerInvariant();

                var propertyInfo = propertyInfos.FirstOrDefault(x =&gt; x.Name.ToLowerInvariant() == @alias);
                if (propertyInfo == null) continue;

                object value = null;
                //TODO Proper mapping of types
                if (propertyInfo.PropertyType == typeof(string))
                    value = property.Value;
                else if (propertyInfo.PropertyType == typeof(DateTime))
                    value = DateTime.Parse(property.Value.ToString());
                else if (propertyInfo.PropertyType == typeof(Boolean))
                {
                    if (String.IsNullOrEmpty(property.Value.ToString()) || property.Value == &quot;0&quot;)
                    {
                        value = false;
                    }
                    else
                    {
                        value = true;
                    }
                }

                propertyInfo.SetValue(mapped, value, null);
            }

            return mapped;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[11,9,11,10,1],[15,13,15,32,1],[16,13,16,38,1],[18,13,18,59,1],[20,13,20,20,1],[20,22,20,34,1],[20,35,20,37,1],[20,38,20,56,1],[21,13,21,14,1],[22,17,22,76,1],[24,17,24,70,1],[24,70,24,105,1],[24,105,24,107,1],[24,17,24,107,1],[25,17,25,42,1],[25,43,25,52,1],[27,17,27,37,1],[29,17,29,65,1],[30,21,30,44,1],[31,22,31,72,1],[32,21,32,71,1],[33,22,33,71,0],[34,17,34,18,0],[35,21,35,98,0],[36,21,36,22,0],[37,25,37,39,0],[38,21,38,22,0],[40,21,40,22,0],[41,25,41,38,0],[42,21,42,22,0],[43,17,43,18,0],[45,17,45,60,1],[46,13,46,14,1],[48,13,48,27,1],[49,9,49,10,1]]);
    </script>
  </body>
</html>