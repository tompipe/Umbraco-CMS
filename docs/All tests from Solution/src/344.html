<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Persistence\Querying\ContentTypeSqlMappingTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Core.Models;
using Umbraco.Core.Models.Rdbms;
using Umbraco.Core.Persistence;
using Umbraco.Core.Persistence.Relators;
using Umbraco.Core.Persistence.Repositories;
using Umbraco.Core.Persistence.SqlSyntax;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Persistence.Querying
{
    [DatabaseTestBehavior(DatabaseBehavior.NewDbFileAndSchemaPerTest)]
    [TestFixture]
    public class ContentTypeSqlMappingTests : BaseDatabaseFactoryTest
    {
        [Test]
        public void Can_Map_Content_Type_Templates_And_Allowed_Types()
        {
            using (var transaction = DatabaseContext.Database.GetTransaction())
            {
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;umbracoNode&quot;))));
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 55554, Trashed = false, ParentId = -1, UserId = 0, Level = 1, Path = &quot;-1,55554&quot;, SortOrder = 1, UniqueId = new Guid(&quot;87D1EAB6-AB27-4852-B3DF-DE8DBA4A1AA0&quot;), Text = &quot;Template 1&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.Template), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 55555, Trashed = false, ParentId = -1, UserId = 0, Level = 1, Path = &quot;-1,55555&quot;, SortOrder = 1, UniqueId = new Guid(&quot;3390BDF4-C974-4211-AA95-3812A8CE7C46&quot;), Text = &quot;Template 2&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.Template), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99997, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99997&quot;, SortOrder = 0, UniqueId = new Guid(&quot;BB3241D5-6842-4EFA-A82A-5F56885CF528&quot;), Text = &quot;Test Content Type 1&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.DocumentType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99998, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99998&quot;, SortOrder = 0, UniqueId = new Guid(&quot;EEA66B06-302E-49BA-A8B2-EDF07248BC59&quot;), Text = &quot;Test Content Type 2&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.DocumentType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99999, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99999&quot;, SortOrder = 0, UniqueId = new Guid(&quot;C45CC083-BB27-4C1C-B448-6F703CC9B799&quot;), Text = &quot;Test Content Type 2&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.DocumentType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;umbracoNode&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsTemplate&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsTemplate&quot;, &quot;pk&quot;, false, new TemplateDto { NodeId = 55554, Alias = &quot;testTemplate1&quot;, Design = &quot;&quot;, PrimaryKey = 22221});
                DatabaseContext.Database.Insert(&quot;cmsTemplate&quot;, &quot;pk&quot;, false, new TemplateDto { NodeId = 55555, Alias = &quot;testTemplate2&quot;, Design = &quot;&quot;, PrimaryKey = 22222 });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsTemplate&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsContentType&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88887, NodeId = 99997, Alias = &quot;TestContentType1&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88888, NodeId = 99998, Alias = &quot;TestContentType2&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88889, NodeId = 99999, Alias = &quot;TestContentType3&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsContentType&quot;))));

                DatabaseContext.Database.Insert(new ContentTypeTemplateDto { ContentTypeNodeId = 99997, IsDefault = true, TemplateNodeId = 55555 });
                DatabaseContext.Database.Insert(new ContentTypeTemplateDto { ContentTypeNodeId = 99997, IsDefault = false, TemplateNodeId = 55554 });

                DatabaseContext.Database.Insert(new ContentTypeAllowedContentTypeDto { AllowedId = 99998, Id = 99997, SortOrder = 1 });
                DatabaseContext.Database.Insert(new ContentTypeAllowedContentTypeDto { AllowedId = 99999, Id = 99997, SortOrder = 2});

                DatabaseContext.Database.Insert(new ContentType2ContentTypeDto { ChildId = 99999, ParentId = 99997});
                DatabaseContext.Database.Insert(new ContentType2ContentTypeDto { ChildId = 99998, ParentId = 99997 });
                
                transaction.Complete();
            }

            IDictionary&lt;int, List&lt;ContentTypeRepository.ContentTypeQueryMapper.AssociatedTemplate&gt;&gt; allAssociatedTemplates;
            IDictionary&lt;int, List&lt;int&gt;&gt; allParentContentTypeIds;
            var contentTypes = ContentTypeRepository.ContentTypeQueryMapper.MapContentTypes(
                DatabaseContext.Database, SqlSyntax, out allAssociatedTemplates, out allParentContentTypeIds)                
                .Where(x =&gt; (new[] {99997, 99998}).Contains(x.Id))
                .ToArray();

            var contentType1 = contentTypes.SingleOrDefault(x =&gt; x.Id == 99997);
            Assert.IsNotNull(contentType1);

            var associatedTemplates1 = allAssociatedTemplates[contentType1.Id];
            var parentContentTypes1 = allParentContentTypeIds[contentType1.Id];

            Assert.AreEqual(2, contentType1.AllowedContentTypes.Count());
            Assert.AreEqual(2, associatedTemplates1.Count());
            Assert.AreEqual(0, parentContentTypes1.Count());

            var contentType2 = contentTypes.SingleOrDefault(x =&gt; x.Id == 99998);
            Assert.IsNotNull(contentType2);

            var associatedTemplates2 = allAssociatedTemplates[contentType2.Id];
            var parentContentTypes2 = allParentContentTypeIds[contentType2.Id];

            Assert.AreEqual(0, contentType2.AllowedContentTypes.Count());
            Assert.AreEqual(0, associatedTemplates2.Count());
            Assert.AreEqual(1, parentContentTypes2.Count());

        }

        [Test]
        public void Can_Map_Media_Type_And_Allowed_Types()
        {
            using (var transaction = DatabaseContext.Database.GetTransaction())
            {
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;umbracoNode&quot;))));                
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99997, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99997&quot;, SortOrder = 0, UniqueId = new Guid(&quot;BB3241D5-6842-4EFA-A82A-5F56885CF528&quot;), Text = &quot;Test Media Type 1&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.MediaType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99998, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99998&quot;, SortOrder = 0, UniqueId = new Guid(&quot;EEA66B06-302E-49BA-A8B2-EDF07248BC59&quot;), Text = &quot;Test Media Type 2&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.MediaType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99999, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99999&quot;, SortOrder = 0, UniqueId = new Guid(&quot;C45CC083-BB27-4C1C-B448-6F703CC9B799&quot;), Text = &quot;Test Media Type 2&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.MediaType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;umbracoNode&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsContentType&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88887, NodeId = 99997, Alias = &quot;TestContentType1&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88888, NodeId = 99998, Alias = &quot;TestContentType2&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88889, NodeId = 99999, Alias = &quot;TestContentType3&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsContentType&quot;))));

                DatabaseContext.Database.Insert(new ContentTypeAllowedContentTypeDto { AllowedId = 99998, Id = 99997, SortOrder = 1 });
                DatabaseContext.Database.Insert(new ContentTypeAllowedContentTypeDto { AllowedId = 99999, Id = 99997, SortOrder = 2 });

                DatabaseContext.Database.Insert(new ContentType2ContentTypeDto { ChildId = 99999, ParentId = 99997 });
                DatabaseContext.Database.Insert(new ContentType2ContentTypeDto { ChildId = 99998, ParentId = 99997 });

                transaction.Complete();
            }

            IDictionary&lt;int, List&lt;int&gt;&gt; allParentContentTypeIds;
            var contentTypes = ContentTypeRepository.ContentTypeQueryMapper.MapMediaTypes(
                DatabaseContext.Database, SqlSyntax, out allParentContentTypeIds)
                .Where(x =&gt; (new[] { 99997, 99998 }).Contains(x.Id))
                .ToArray();

            var contentType1 = contentTypes.SingleOrDefault(x =&gt; x.Id == 99997);
            Assert.IsNotNull(contentType1);

            var parentContentTypes1 = allParentContentTypeIds[contentType1.Id];

            Assert.AreEqual(2, contentType1.AllowedContentTypes.Count());
            Assert.AreEqual(0, parentContentTypes1.Count());

            var contentType2 = contentTypes.SingleOrDefault(x =&gt; x.Id == 99998);
            Assert.IsNotNull(contentType2);

            var parentContentTypes2 = allParentContentTypeIds[contentType2.Id];

            Assert.AreEqual(0, contentType2.AllowedContentTypes.Count());
            Assert.AreEqual(1, parentContentTypes2.Count());

        }

        [Test]
        public void Can_Map_All_Property_Groups_And_Types()
        {
            using (var transaction = DatabaseContext.Database.GetTransaction())
            {
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;umbracoNode&quot;))));
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 55555, Trashed = false, ParentId = -1, UserId = 0, Level = 1, Path = &quot;-1,55555&quot;, SortOrder = 1, UniqueId = new Guid(&quot;3390BDF4-C974-4211-AA95-3812A8CE7C46&quot;), Text = &quot;Test Data Type&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.DataType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Insert(&quot;umbracoNode&quot;, &quot;id&quot;, false, new NodeDto { NodeId = 99999, Trashed = false, ParentId = -1, UserId = 0, Level = 0, Path = &quot;-1,99999&quot;, SortOrder = 0, UniqueId = new Guid(&quot;129241F0-D24E-4FC3-92D1-BC2D48B7C431&quot;), Text = &quot;Test Content Type&quot;, NodeObjectType = new Guid(Constants.ObjectTypes.DocumentType), CreateDate = DateTime.Now });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;umbracoNode&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsDataType&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsDataType&quot;, &quot;pk&quot;, false, new DataTypeDto { PrimaryKey = 44444, DataTypeId = 55555, PropertyEditorAlias = Constants.PropertyEditors.TextboxAlias, DbType = &quot;Nvarchar&quot; });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsDataType&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsContentType&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsContentType&quot;, &quot;pk&quot;, false, new ContentTypeDto { PrimaryKey = 88888, NodeId = 99999, Alias = &quot;TestContentType&quot;, Icon = &quot;icon-folder&quot;, Thumbnail = &quot;folder.png&quot;, IsContainer = false, AllowAtRoot = true });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsContentType&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsPropertyTypeGroup&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsPropertyTypeGroup&quot;, &quot;id&quot;, false, new PropertyTypeGroupDto { Id = 77776, UniqueId = 77776.ToGuid(), ContentTypeNodeId = 99999, Text = &quot;Group1&quot;, SortOrder = 1 });
                DatabaseContext.Database.Insert(&quot;cmsPropertyTypeGroup&quot;, &quot;id&quot;, false, new PropertyTypeGroupDto { Id = 77777, UniqueId = 77777.ToGuid(), ContentTypeNodeId = 99999, Text = &quot;Group2&quot;, SortOrder = 2 });
                DatabaseContext.Database.Insert(&quot;cmsPropertyTypeGroup&quot;, &quot;id&quot;, false, new PropertyTypeGroupDto { Id = 77778, UniqueId = 77778.ToGuid(), ContentTypeNodeId = 99999, Text = &quot;Group3&quot;, SortOrder = 3 });
                DatabaseContext.Database.Insert(&quot;cmsPropertyTypeGroup&quot;, &quot;id&quot;, false, new PropertyTypeGroupDto { Id = 77779, UniqueId = 77779.ToGuid(), ContentTypeNodeId = 99999, Text = &quot;Group4&quot;, SortOrder = 4 });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsPropertyTypeGroup&quot;))));

                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} ON &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsPropertyType&quot;))));
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66662, UniqueId = 66662.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = 77776, Alias = &quot;property1&quot;, Name = &quot;Property 1&quot;, SortOrder = 0, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66663, UniqueId = 66663.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = 77776, Alias = &quot;property2&quot;, Name = &quot;Property 2&quot;, SortOrder = 1, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66664, UniqueId = 66664.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = 77777, Alias = &quot;property3&quot;, Name = &quot;Property 3&quot;, SortOrder = 2, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66665, UniqueId = 66665.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = 77777, Alias = &quot;property4&quot;, Name = &quot;Property 4&quot;, SortOrder = 3, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66666, UniqueId = 66666.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = null, Alias = &quot;property5&quot;, Name = &quot;Property 5&quot;, SortOrder = 4, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66667, UniqueId = 66667.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = 77778, Alias = &quot;property6&quot;, Name = &quot;Property 6&quot;, SortOrder = 5, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Insert(&quot;cmsPropertyType&quot;, &quot;id&quot;, false, new PropertyTypeDto { Id = 66668, UniqueId = 66668.ToGuid(), DataTypeId = 55555, ContentTypeId = 99999, PropertyTypeGroupId = 77778, Alias = &quot;property7&quot;, Name = &quot;Property 7&quot;, SortOrder = 6, Mandatory = false, ValidationRegExp = null, Description = null });
                DatabaseContext.Database.Execute(new Sql(string.Format(&quot;SET IDENTITY_INSERT {0} OFF &quot;, SqlSyntaxContext.SqlSyntaxProvider.GetQuotedTableName(&quot;cmsPropertyType&quot;))));

                transaction.Complete();
            }

            IDictionary&lt;int, PropertyTypeCollection&gt; allPropTypeCollection;
            IDictionary&lt;int, PropertyGroupCollection&gt; allPropGroupCollection;
            ContentTypeRepository.ContentTypeQueryMapper.MapGroupsAndProperties(new[] { 99999 }, DatabaseContext.Database, SqlSyntax, out allPropTypeCollection, out allPropGroupCollection);

            var propGroupCollection = allPropGroupCollection[99999];
            var propTypeCollection = allPropTypeCollection[99999];

            Assert.AreEqual(4, propGroupCollection.Count);
            Assert.AreEqual(2, propGroupCollection[&quot;Group1&quot;].PropertyTypes.Count);
            Assert.IsTrue(propGroupCollection[&quot;Group1&quot;].PropertyTypes.Contains(&quot;property1&quot;));
            Assert.IsTrue(propGroupCollection[&quot;Group1&quot;].PropertyTypes.Contains(&quot;property2&quot;));
            Assert.AreEqual(2, propGroupCollection[&quot;Group2&quot;].PropertyTypes.Count);
            Assert.IsTrue(propGroupCollection[&quot;Group2&quot;].PropertyTypes.Contains(&quot;property3&quot;));
            Assert.IsTrue(propGroupCollection[&quot;Group2&quot;].PropertyTypes.Contains(&quot;property4&quot;));
            Assert.AreEqual(2, propGroupCollection[&quot;Group3&quot;].PropertyTypes.Count);
            Assert.IsTrue(propGroupCollection[&quot;Group3&quot;].PropertyTypes.Contains(&quot;property6&quot;));
            Assert.IsTrue(propGroupCollection[&quot;Group3&quot;].PropertyTypes.Contains(&quot;property7&quot;));
            Assert.AreEqual(0, propGroupCollection[&quot;Group4&quot;].PropertyTypes.Count);

            Assert.AreEqual(1, propTypeCollection.Count);
            Assert.IsTrue(propTypeCollection.Contains(&quot;property5&quot;));

        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[24,9,24,10,1],[25,20,25,79,1],[26,13,26,14,1],[27,17,27,175,1],[28,17,28,366,1],[29,17,29,366,1],[30,17,30,379,1],[31,17,31,379,1],[32,17,32,379,1],[33,17,33,176,1],[35,17,35,175,1],[36,17,36,170,1],[37,17,37,171,1],[38,17,38,176,1],[40,17,40,178,1],[41,17,41,256,1],[42,17,42,256,1],[43,17,43,256,1],[44,17,44,179,1],[46,17,46,149,1],[47,17,47,150,1],[49,17,49,136,1],[50,17,50,135,1],[52,17,52,118,1],[53,17,53,119,1],[55,17,55,40,1],[56,13,56,14,1],[60,13,62,29,1],[62,29,62,66,1],[62,66,63,28,1],[60,13,63,28,1],[65,13,65,66,1],[65,66,65,79,1],[65,79,65,81,1],[65,13,65,81,1],[66,13,66,44,1],[68,13,68,80,1],[69,13,69,80,1],[71,13,71,74,1],[72,13,72,62,1],[73,13,73,61,1],[75,13,75,66,1],[75,66,75,79,1],[75,79,75,81,1],[75,13,75,81,1],[76,13,76,44,1],[78,13,78,80,1],[79,13,79,80,1],[81,13,81,74,1],[82,13,82,62,1],[83,13,83,61,1],[85,9,85,10,1],[89,9,89,10,1],[90,20,90,79,1],[91,13,91,14,1],[92,17,92,175,1],[93,17,93,374,1],[94,17,94,374,1],[95,17,95,374,1],[96,17,96,176,1],[98,17,98,178,1],[99,17,99,256,1],[100,17,100,256,1],[101,17,101,256,1],[102,17,102,179,1],[104,17,104,136,1],[105,17,105,136,1],[107,17,107,119,1],[108,17,108,119,1],[110,17,110,40,1],[111,13,111,14,1],[114,13,116,29,1],[116,29,116,68,1],[116,68,117,28,1],[114,13,117,28,1],[119,13,119,66,1],[119,66,119,79,1],[119,79,119,81,1],[119,13,119,81,1],[120,13,120,44,1],[122,13,122,80,1],[124,13,124,74,1],[125,13,125,61,1],[127,13,127,66,1],[127,66,127,79,1],[127,79,127,81,1],[127,13,127,81,1],[128,13,128,44,1],[130,13,130,80,1],[132,13,132,74,1],[133,13,133,61,1],[135,9,135,10,1],[139,9,139,10,1],[140,20,140,79,1],[141,13,141,14,1],[142,17,142,175,1],[143,17,143,370,1],[144,17,144,377,1],[145,17,145,176,1],[147,17,147,175,1],[148,17,148,220,1],[149,17,149,176,1],[151,17,151,178,1],[152,17,152,255,1],[153,17,153,179,1],[155,17,155,184,1],[156,17,156,213,1],[157,17,157,213,1],[158,17,158,213,1],[159,17,159,213,1],[160,17,160,185,1],[162,17,162,179,1],[163,17,163,337,1],[164,17,164,337,1],[165,17,165,337,1],[166,17,166,337,1],[167,17,167,336,1],[168,17,168,337,1],[169,17,169,337,1],[170,17,170,180,1],[172,17,172,40,1],[173,13,173,14,1],[177,13,177,190,1],[179,13,179,69,1],[180,13,180,67,1],[182,13,182,59,1],[183,13,183,83,1],[184,13,184,94,1],[185,13,185,94,1],[186,13,186,83,1],[187,13,187,94,1],[188,13,188,94,1],[189,13,189,83,1],[190,13,190,94,1],[191,13,191,94,1],[192,13,192,83,1],[194,13,194,58,1],[195,13,195,69,1],[197,9,197,10,1]]);
    </script>
  </body>
</html>