<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.cms\businesslogic\macro\MacroModel.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace umbraco.cms.businesslogic.macro
{

    [Serializable]
    public class MacroModel
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Alias { get; set; }
        public string MacroControlIdentifier { get; set; }
        public MacroTypes MacroType { get; set; }

        public string TypeAssembly { get; set; }
        public string TypeName { get; set; }
        public string Xslt { get; set; }
        public string ScriptName { get; set; }
        public string ScriptCode { get; set; }
        public string ScriptLanguage { get; set; }

        public int CacheDuration { get; set; }
        public bool CacheByPage { get; set; }
        public bool CacheByMember { get; set; }

        public bool RenderInEditor { get; set; }

        public string CacheIdentifier { get; set; }

        public List&lt;MacroPropertyModel&gt; Properties { get; set; }

        public MacroModel()
        {
            Properties = new List&lt;MacroPropertyModel&gt;();
        }

        public MacroModel(Macro m)
        {
            Properties = new List&lt;MacroPropertyModel&gt;();
            if (m != null)
            {
                Id = m.Id;
                Name = m.Name;
                Alias = m.Alias;
                TypeAssembly = m.Assembly;
                TypeName = m.Type;
                Xslt = m.Xslt;
                ScriptName = m.ScriptingFile;
                CacheDuration = m.RefreshRate;
                CacheByPage = m.CacheByPage;
                CacheByMember = m.CachePersonalized;
                RenderInEditor = m.RenderContent;
                foreach (MacroProperty mp in m.Properties)
                {
                    Properties.Add(
                        new MacroPropertyModel(mp.Alias, string.Empty, mp.Type.Alias, mp.Type.BaseType));
                }
                MacroType = Macro.FindMacroType(Xslt, ScriptName, TypeName, TypeAssembly);
            }
        }

        public MacroModel(string name, string alias, string typeAssembly, string typeName, string xslt, string scriptName, int cacheDuration, bool cacheByPage, bool cacheByMember)
        {
            Name = name;
            Alias = alias;
            TypeAssembly = typeAssembly;
            TypeName = typeName;
            Xslt = xslt;
            ScriptName = scriptName;
            CacheDuration = cacheDuration;
            CacheByPage = cacheByPage;
            CacheByMember = cacheByMember;

            Properties = new List&lt;MacroPropertyModel&gt;();

            MacroType = Macro.FindMacroType(Xslt, ScriptName, TypeName, TypeAssembly);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[13,25,13,29,0],[13,30,13,34,0],[14,30,14,34,0],[14,35,14,39,1],[15,31,15,35,0],[15,36,15,40,1],[16,48,16,52,0],[16,53,16,57,0],[17,39,17,43,1],[17,44,17,48,1],[19,38,19,42,1],[19,43,19,47,1],[20,34,20,38,1],[20,39,20,43,1],[21,30,21,34,1],[21,35,21,39,1],[22,36,22,40,1],[22,41,22,45,1],[23,36,23,40,0],[23,41,23,45,0],[24,40,24,44,0],[24,45,24,49,0],[26,36,26,40,0],[26,41,26,45,1],[27,35,27,39,0],[27,40,27,44,1],[28,37,28,41,0],[28,42,28,46,1],[30,38,30,42,0],[30,43,30,47,0],[32,41,32,45,1],[32,46,32,50,0],[34,54,34,58,1],[34,59,34,63,1],[36,9,36,28,0],[37,9,37,10,0],[38,13,38,57,0],[39,9,39,10,0],[41,9,41,35,0],[42,9,42,10,0],[43,13,43,57,0],[44,13,44,27,0],[45,13,45,14,0],[46,17,46,27,0],[47,17,47,31,0],[48,17,48,33,0],[49,17,49,43,0],[50,17,50,35,0],[51,17,51,31,0],[52,17,52,46,0],[53,17,53,47,0],[54,17,54,45,0],[55,17,55,53,0],[56,17,56,50,0],[57,17,57,24,0],[57,26,57,42,0],[57,43,57,45,0],[57,46,57,58,0],[58,17,58,18,0],[59,21,60,106,0],[61,17,61,18,0],[62,17,62,91,0],[63,13,63,14,0],[64,9,64,10,0],[66,9,66,180,1],[67,9,67,10,1],[68,13,68,25,1],[69,13,69,27,1],[70,13,70,41,1],[71,13,71,33,1],[72,13,72,25,1],[73,13,73,37,1],[74,13,74,43,1],[75,13,75,39,1],[76,13,76,43,1],[78,13,78,57,1],[80,13,80,87,1],[81,9,81,10,1]]);
    </script>
  </body>
</html>