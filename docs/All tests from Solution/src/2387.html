<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.cms\businesslogic\utilities\Zip.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Web;
using ICSharpCode.SharpZipLib.Zip;
using umbraco;

namespace umbraco.cms.businesslogic.utilities
{
    public class Zip
    {
        public static void UnPack(string ZipFilePath, string UnPackDirectory, bool DeleteZipFile)
        {
            // Unzip
            string tempDir = UnPackDirectory;
            Directory.CreateDirectory(tempDir);

            ZipInputStream s = new ZipInputStream(File.OpenRead(ZipFilePath));

            ZipEntry theEntry;
            while ((theEntry = s.GetNextEntry()) != null)
            {
                string directoryName = Path.GetDirectoryName(theEntry.Name);
                string fileName = Path.GetFileName(theEntry.Name);

                if (fileName != String.Empty)
                {
                    FileStream streamWriter = File.Create(tempDir + Path.DirectorySeparatorChar + fileName);

                    int size = 2048;
                    byte[] data = new byte[2048];
                    while (true)
                    {
                        size = s.Read(data, 0, data.Length);
                        if (size &gt; 0)
                        {
                            streamWriter.Write(data, 0, size);
                        }
                        else
                        {
                            break;
                        }
                    }

                    streamWriter.Close();

                }
            }

            // Clean up
            s.Close();
            if (DeleteZipFile)
                File.Delete(ZipFilePath);

        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,10,0],[16,13,16,46,0],[17,13,17,48,0],[19,13,19,79,0],[22,13,22,58,0],[23,13,23,14,0],[24,17,24,77,0],[25,17,25,67,0],[27,17,27,46,0],[28,17,28,18,0],[29,21,29,109,0],[31,21,31,37,0],[32,21,32,50,0],[33,21,33,33,0],[34,21,34,22,0],[35,25,35,61,0],[36,25,36,38,0],[37,25,37,26,0],[38,29,38,63,0],[39,25,39,26,0],[41,25,41,26,0],[42,29,42,35,0],[44,21,44,22,0],[46,21,46,42,0],[48,17,48,18,0],[49,13,49,14,0],[52,13,52,23,0],[53,13,53,31,0],[54,17,54,42,0],[56,9,56,10,0]]);
    </script>
  </body>
</html>