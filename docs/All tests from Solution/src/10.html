<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\ObjectExtensionsTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Threading;
using System.Web.UI.WebControls;
using NUnit.Framework;
using Umbraco.Core;

namespace Umbraco.Tests
{
	[TestFixture]
	public class ObjectExtensionsTests
	{
        [TestFixtureSetUp]
		public void FixtureSetup()
		{
		}

        [Test]
        public void CanParseStringToUnit()
        {
            var stringUnit = &quot;1234px&quot;;
            object objUnit = &quot;1234px&quot;;
            var result = stringUnit.TryConvertTo&lt;Unit&gt;();
            var result2 = objUnit.TryConvertTo&lt;Unit&gt;();
            var unit = new Unit(&quot;1234px&quot;);
            Assert.IsTrue(result.Success);
            Assert.IsTrue(result2.Success);
            Assert.AreEqual(unit, result.Result);
            Assert.AreEqual(unit, result2.Result);
        }

	    [Test]
	    public void Can_Convert_List_To_Enumerable()
	    {
	        var list = new List&lt;string&gt;() {&quot;hello&quot;, &quot;world&quot;, &quot;awesome&quot;};
	        var result = list.TryConvertTo&lt;IEnumerable&lt;string&gt;&gt;();
	        Assert.IsTrue(result.Success);
            Assert.AreEqual(3, result.Result.Count());
	    }

	    [Test]
		public void ObjectExtensions_Object_To_Dictionary()
		{
			//Arrange

			var obj = new { Key1 = &quot;value1&quot;, Key2 = &quot;value2&quot;, Key3 = &quot;value3&quot; };

			//Act

			var d = obj.ToDictionary&lt;string&gt;();

			//Assert

			Assert.IsTrue(d.Keys.Contains(&quot;Key1&quot;));
			Assert.IsTrue(d.Keys.Contains(&quot;Key2&quot;));
			Assert.IsTrue(d.Keys.Contains(&quot;Key3&quot;));
			Assert.AreEqual(d[&quot;Key1&quot;], &quot;value1&quot;);
			Assert.AreEqual(d[&quot;Key2&quot;], &quot;value2&quot;);
			Assert.AreEqual(d[&quot;Key3&quot;], &quot;value3&quot;);
		}

		[Test]
		public void CanConvertIntToNullableInt()
		{
			var i = 1;
			var result = i.TryConvertTo&lt;int?&gt;();
			Assert.That(result.Success, Is.True);
		}

		[Test]
		public void CanConvertNullableIntToInt()
		{
			int? i = 1;
			var result = i.TryConvertTo&lt;int&gt;();
			Assert.That(result.Success, Is.True);
		}

		[Test]
		public virtual void CanConvertStringToBool()
		{
			var testCases = new Dictionary&lt;string, bool&gt;
				{
					{&quot;TRUE&quot;, true},
					{&quot;True&quot;, true},
					{&quot;true&quot;, true},
					{&quot;1&quot;, true},
					{&quot;FALSE&quot;, false},
					{&quot;False&quot;, false},
					{&quot;false&quot;, false},
					{&quot;0&quot;, false},
					{&quot;&quot;, false}
				};

			foreach (var testCase in testCases)
			{
				var result = testCase.Key.TryConvertTo&lt;bool&gt;();

				Assert.IsTrue(result.Success, testCase.Key);
				Assert.AreEqual(testCase.Value, result.Result, testCase.Key);
			}
		}

        [TestCase(&quot;2012-11-10&quot;, true)]
        [TestCase(&quot;2012/11/10&quot;, true)]
        [TestCase(&quot;10/11/2012&quot;, true)]// assuming your culture uses DD/MM/YYYY
        [TestCase(&quot;11/10/2012&quot;, false)]// assuming your culture uses DD/MM/YYYY
        [TestCase(&quot;Sat 10, Nov 2012&quot;, true)]
        [TestCase(&quot;Saturday 10, Nov 2012&quot;, true)]
        [TestCase(&quot;Sat 10, November 2012&quot;, true)]
        [TestCase(&quot;Saturday 10, November 2012&quot;, true)]
        [TestCase(&quot;2012-11-10 13:14:15&quot;, true)]
        [TestCase(&quot;2012-11-10T13:14:15Z&quot;, true)]
		public virtual void CanConvertStringToDateTime(string date, bool outcome)
		{
			var dateTime = new DateTime(2012, 11, 10, 13, 14, 15);

            var result = date.TryConvertTo&lt;DateTime&gt;();

            Assert.IsTrue(result.Success, date);
            Assert.AreEqual(DateTime.Equals(dateTime.Date, result.Result.Date), outcome, date);
		}

        [Test]
        public virtual void CanConvertBlankStringToNullDateTime()
        {
            var result = &quot;&quot;.TryConvertTo&lt;DateTime?&gt;();
            Assert.IsTrue(result.Success);
            Assert.IsNull(result.Result);
        }

        [Test]
        public virtual void CanConvertBlankStringToNullBool()
        {
            var result = &quot;&quot;.TryConvertTo&lt;bool?&gt;();
            Assert.IsTrue(result.Success);
            Assert.IsNull(result.Result);
        }

		[Test]
		public virtual void CanConvertBlankStringToDateTime()
		{
			var result = &quot;&quot;.TryConvertTo&lt;DateTime&gt;();
			Assert.IsTrue(result.Success);
			Assert.AreEqual(DateTime.MinValue, result.Result);
		}

		[Test]
		public virtual void CanConvertObjectToString_Using_ToString_Overload()
		{
			var result = new MyTestObject().TryConvertTo&lt;string&gt;();

			Assert.IsTrue(result.Success);
			Assert.AreEqual(&quot;Hello world&quot;, result.Result);
		}

		        [Test]
        public virtual void CanConvertObjectToSameObject()
        {
            var obj = new MyTestObject();
            var result = obj.TryConvertTo&lt;object&gt;();

            Assert.AreEqual(obj, result.Result);            
        }
		
		private CultureInfo savedCulture;

	    /// &lt;summary&gt;
		/// Run once before each test in derived test fixtures.
		/// &lt;/summary&gt;
        [SetUp]
		public void TestSetup()
		{
			savedCulture = Thread.CurrentThread.CurrentCulture;
			Thread.CurrentThread.CurrentCulture = new CultureInfo(&quot;en-GB&quot;); // make sure the dates parse correctly
			return;
		}

		/// &lt;summary&gt;
		/// Run once after each test in derived test fixtures.
		/// &lt;/summary&gt;
	    [TearDown]
		public void TestTearDown()
		{
			Thread.CurrentThread.CurrentCulture = savedCulture;
			return;
		}

        private class MyTestObject
        {
            public override string ToString()
            {
                return &quot;Hello world&quot;;
            }
        }
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[17,3,17,4,1],[18,3,18,4,1],[22,9,22,10,1],[23,13,23,39,1],[24,13,24,39,1],[25,13,25,58,1],[26,13,26,56,1],[27,13,27,43,1],[28,13,28,43,1],[29,13,29,44,1],[30,13,30,50,1],[31,13,31,51,1],[32,9,32,10,1],[36,6,36,7,1],[37,10,37,70,1],[38,10,38,64,1],[39,10,39,40,1],[40,13,40,55,1],[41,6,41,7,1],[45,3,45,4,1],[48,4,48,72,1],[52,4,52,39,1],[56,4,56,43,1],[57,4,57,43,1],[58,4,58,43,1],[59,4,59,41,1],[60,4,60,41,1],[61,4,61,41,1],[62,3,62,4,1],[66,3,66,4,1],[67,4,67,14,1],[68,4,68,40,1],[69,4,69,41,1],[70,3,70,4,1],[74,3,74,4,1],[75,4,75,15,1],[76,4,76,39,1],[77,4,77,41,1],[78,3,78,4,1],[82,3,82,4,1],[83,4,94,7,1],[96,4,96,11,1],[96,13,96,25,1],[96,26,96,28,1],[96,29,96,38,1],[97,4,97,5,1],[98,5,98,52,1],[100,5,100,49,1],[101,5,101,66,1],[102,4,102,5,1],[103,3,103,4,1],[116,3,116,4,1],[117,4,117,58,1],[119,13,119,56,1],[121,13,121,49,1],[122,13,122,96,1],[123,3,123,4,1],[127,9,127,10,1],[128,13,128,55,1],[129,13,129,43,1],[130,13,130,42,1],[131,9,131,10,1],[135,9,135,10,1],[136,13,136,51,1],[137,13,137,43,1],[138,13,138,42,1],[139,9,139,10,1],[143,3,143,4,1],[144,4,144,45,1],[145,4,145,34,1],[146,4,146,54,1],[147,3,147,4,1],[151,3,151,4,1],[152,4,152,59,1],[154,4,154,34,1],[155,4,155,50,1],[156,3,156,4,1],[160,9,160,10,1],[161,13,161,42,1],[162,13,162,53,1],[164,13,164,49,1],[165,9,165,10,1],[174,3,174,4,1],[175,4,175,55,1],[176,4,176,67,1],[177,4,177,11,1],[178,3,178,4,1],[185,3,185,4,1],[186,4,186,55,1],[187,4,187,11,1],[188,3,188,4,1],[193,13,193,14,1],[194,17,194,38,1],[195,13,195,14,1]]);
    </script>
  </body>
</html>