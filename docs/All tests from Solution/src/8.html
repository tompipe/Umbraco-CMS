<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\HashCodeCombinerTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.IO;
using System.Reflection;
using NUnit.Framework;
using Umbraco.Core;

namespace Umbraco.Tests
{
	[TestFixture]
	public class HashCodeCombinerTests 
	{

		private DirectoryInfo PrepareFolder()
		{
			var assDir = new FileInfo(Assembly.GetExecutingAssembly().Location).Directory;
			var dir = Directory.CreateDirectory(Path.Combine(assDir.FullName, &quot;HashCombiner&quot;, Guid.NewGuid().ToString(&quot;N&quot;)));
			foreach (var f in dir.GetFiles())
			{
				f.Delete();
			}
			return dir;
		}

		[Test]
		public void HashCombiner_Test_String()
		{
			var combiner1 = new HashCodeCombiner();
			combiner1.AddCaseInsensitiveString(&quot;Hello&quot;);

			var combiner2 = new HashCodeCombiner();
			combiner2.AddCaseInsensitiveString(&quot;hello&quot;);

			Assert.AreEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());

			combiner2.AddCaseInsensitiveString(&quot;world&quot;);

			Assert.AreNotEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());
		}

		[Test]
		public void HashCombiner_Test_Int()
		{
			var combiner1 = new HashCodeCombiner();
			combiner1.AddInt(1234);

			var combiner2 = new HashCodeCombiner();
			combiner2.AddInt(1234);

			Assert.AreEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());

			combiner2.AddInt(1);

			Assert.AreNotEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());
		}

		[Test]
		public void HashCombiner_Test_DateTime()
		{
			var dt = DateTime.Now;
			var combiner1 = new HashCodeCombiner();
			combiner1.AddDateTime(dt);

			var combiner2 = new HashCodeCombiner();
			combiner2.AddDateTime(dt);

			Assert.AreEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());

			combiner2.AddDateTime(DateTime.Now);

			Assert.AreNotEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());
		}

		[Test]
		public void HashCombiner_Test_File()
		{
			var dir = PrepareFolder();
			var file1Path = Path.Combine(dir.FullName, &quot;hastest1.txt&quot;);
			File.Delete(file1Path);
			using (var file1 = File.CreateText(Path.Combine(dir.FullName, &quot;hastest1.txt&quot;)))
			{
				file1.WriteLine(&quot;hello&quot;);
			}
			var file2Path = Path.Combine(dir.FullName, &quot;hastest2.txt&quot;);
			File.Delete(file2Path);
			using (var file2 = File.CreateText(Path.Combine(dir.FullName, &quot;hastest2.txt&quot;)))
			{
				//even though files are the same, the dates are different
				file2.WriteLine(&quot;hello&quot;);
			}

			var combiner1 = new HashCodeCombiner();
			combiner1.AddFile(new FileInfo(file1Path));

			var combiner2 = new HashCodeCombiner();
			combiner2.AddFile(new FileInfo(file1Path));

			var combiner3 = new HashCodeCombiner();
			combiner3.AddFile(new FileInfo(file2Path));

			Assert.AreEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());
			Assert.AreNotEqual(combiner1.GetCombinedHashCode(), combiner3.GetCombinedHashCode());

			combiner2.AddFile(new FileInfo(file2Path));

			Assert.AreNotEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());
		}

		[Test]
		public void HashCombiner_Test_Folder()
		{
			var dir = PrepareFolder();
			var file1Path = Path.Combine(dir.FullName, &quot;hastest1.txt&quot;);
			File.Delete(file1Path);
			using (var file1 = File.CreateText(Path.Combine(dir.FullName, &quot;hastest1.txt&quot;)))
			{
				file1.WriteLine(&quot;hello&quot;);
			}

			//first test the whole folder
			var combiner1 = new HashCodeCombiner();
			combiner1.AddFolder(dir);

			var combiner2 = new HashCodeCombiner();
			combiner2.AddFolder(dir);

			Assert.AreEqual(combiner1.GetCombinedHashCode(), combiner2.GetCombinedHashCode());

			//now add a file to the folder

			var file2Path = Path.Combine(dir.FullName, &quot;hastest2.txt&quot;);
			File.Delete(file2Path);
			using (var file2 = File.CreateText(Path.Combine(dir.FullName, &quot;hastest2.txt&quot;)))
			{
				//even though files are the same, the dates are different
				file2.WriteLine(&quot;hello&quot;);
			}

			var combiner3 = new HashCodeCombiner();
			combiner3.AddFolder(dir);

			Assert.AreNotEqual(combiner1.GetCombinedHashCode(), combiner3.GetCombinedHashCode());
		}

	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[14,3,14,4,1],[15,4,15,82,1],[16,4,16,117,1],[17,4,17,11,1],[17,13,17,18,0],[17,19,17,21,1],[17,22,17,36,1],[18,4,18,5,0],[19,5,19,16,0],[20,4,20,5,0],[21,4,21,15,1],[22,3,22,4,1],[26,3,26,4,1],[27,4,27,43,1],[28,4,28,48,1],[30,4,30,43,1],[31,4,31,48,1],[33,4,33,86,1],[35,4,35,48,1],[37,4,37,89,1],[38,3,38,4,1],[42,3,42,4,1],[43,4,43,43,1],[44,4,44,27,1],[46,4,46,43,1],[47,4,47,27,1],[49,4,49,86,1],[51,4,51,24,1],[53,4,53,89,1],[54,3,54,4,1],[58,3,58,4,1],[59,4,59,26,1],[60,4,60,43,1],[61,4,61,30,1],[63,4,63,43,1],[64,4,64,30,1],[66,4,66,86,1],[68,4,68,40,1],[70,4,70,89,1],[71,3,71,4,1],[75,3,75,4,1],[76,4,76,30,1],[77,4,77,63,1],[78,4,78,27,1],[79,11,79,82,1],[80,4,80,5,1],[81,5,81,30,1],[82,4,82,5,1],[83,4,83,63,1],[84,4,84,27,1],[85,11,85,82,1],[86,4,86,5,1],[88,5,88,30,1],[89,4,89,5,1],[91,4,91,43,1],[92,4,92,47,1],[94,4,94,43,1],[95,4,95,47,1],[97,4,97,43,1],[98,4,98,47,1],[100,4,100,86,1],[101,4,101,89,1],[103,4,103,47,1],[105,4,105,89,1],[106,3,106,4,1],[110,3,110,4,1],[111,4,111,30,1],[112,4,112,63,1],[113,4,113,27,1],[114,11,114,82,1],[115,4,115,5,1],[116,5,116,30,1],[117,4,117,5,1],[120,4,120,43,1],[121,4,121,29,1],[123,4,123,43,1],[124,4,124,29,1],[126,4,126,86,1],[130,4,130,63,1],[131,4,131,27,1],[132,11,132,82,1],[133,4,133,5,1],[135,5,135,30,1],[136,4,136,5,1],[138,4,138,43,1],[139,4,139,29,1],[141,4,141,89,1],[142,3,142,4,1]]);
    </script>
  </body>
</html>