<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.cms\businesslogic\Packager\PackageActions\addApplicationTree.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Text;
using System.Xml;

namespace umbraco.cms.businesslogic.packager.standardPackageActions
{
    /*Build in standard actions */

    /// &lt;summary&gt;
    /// This class implements the IPackageAction Interface, used to execute code when packages are installed.
    /// All IPackageActions only takes a PackageName and a XmlNode as input, and executes based on the data in the xmlnode.
    /// &lt;/summary&gt;
    public class addApplicationTree : umbraco.interfaces.IPackageAction
    {

        #region IPackageAction Members

        /// &lt;summary&gt;
        /// Executes the specified package action.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;packageName&quot;&gt;Name of the package.&lt;/param&gt;
        /// &lt;param name=&quot;xmlData&quot;&gt;The XML data.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;example&gt;&lt;code&gt;
        /// &lt;Action runat=&quot;install&quot; [undo=&quot;false&quot;] alias=&quot;addApplicationTree&quot; silent=&quot;[true/false]&quot;  initialize=&quot;[true/false]&quot; sortOrder=&quot;1&quot; 
        /// applicationAlias=&quot;appAlias&quot; treeAlias=&quot;myTree&quot; treeTitle=&quot;My Tree&quot; iconOpened=&quot;folder_o.gif&quot; iconClosed=&quot;folder.gif&quot;
        /// assemblyName=&quot;umbraco&quot; treeHandlerType=&quot;treeClass&quot; action=&quot;alert(&#39;you clicked my tree&#39;)&quot;/&gt;
        /// &lt;/code&gt;&lt;/example&gt;
        public bool Execute(string packageName, XmlNode xmlData)
        {
            bool silent = bool.Parse(xmlData.Attributes[&quot;silent&quot;].Value);
            bool initialize = bool.Parse(xmlData.Attributes[&quot;initialize&quot;].Value);
            byte sortOrder = byte.Parse(xmlData.Attributes[&quot;sortOrder&quot;].Value);

            string applicationAlias = xmlData.Attributes[&quot;applicationAlias&quot;].Value;
            string treeAlias = xmlData.Attributes[&quot;treeAlias&quot;].Value;
            string treeTitle = xmlData.Attributes[&quot;treeTitle&quot;].Value;
            string iconOpened = xmlData.Attributes[&quot;iconOpened&quot;].Value;
            string iconClosed = xmlData.Attributes[&quot;iconClosed&quot;].Value;

            string assemblyName = xmlData.Attributes[&quot;assemblyName&quot;].Value;
            string type = xmlData.Attributes[&quot;treeHandlerType&quot;].Value;
            string action = xmlData.Attributes[&quot;action&quot;].Value;


            BusinessLogic.ApplicationTree.MakeNew(silent, initialize, sortOrder, applicationAlias, treeAlias, treeTitle, iconClosed, iconOpened, assemblyName, type, action);

            return true;
        }

        /// &lt;summary&gt;
        /// Undoes the action
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;packageName&quot;&gt;Name of the package.&lt;/param&gt;
        /// &lt;param name=&quot;xmlData&quot;&gt;The XML data.&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool Undo(string packageName, XmlNode xmlData)
        {
            string treeAlias = xmlData.Attributes[&quot;treeAlias&quot;].Value;
            BusinessLogic.ApplicationTree.getByAlias(treeAlias).Delete();
            return true;
        }

        /// &lt;summary&gt;
        /// Action alias.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string Alias()
        {
            return &quot;addApplicationTree&quot;;
        }

        #endregion


        public XmlNode SampleXml()
        {

            string sample = &quot;&lt;Action runat=\&quot;install\&quot; undo=\&quot;true/false\&quot; alias=\&quot;addApplicationTree\&quot; silent=\&quot;true/false\&quot;  initialize=\&quot;true/false\&quot; sortOrder=\&quot;1\&quot; applicationAlias=\&quot;appAlias\&quot; treeAlias=\&quot;myTree\&quot; treeTitle=\&quot;My Tree\&quot; iconOpened=\&quot;folder_o.gif\&quot; iconClosed=\&quot;folder.gif\&quot; assemblyName=\&quot;umbraco\&quot; treeHandlerType=\&quot;treeClass\&quot; action=\&quot;alert(&#39;you clicked my tree&#39;)\&quot;/&gt;&quot;;
            return helper.parseStringToXmlNode(sample);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[30,9,30,10,0],[31,13,31,74,0],[32,13,32,82,0],[33,13,33,80,0],[35,13,35,84,0],[36,13,36,70,0],[37,13,37,70,0],[38,13,38,72,0],[39,13,39,72,0],[41,13,41,76,0],[42,13,42,71,0],[43,13,43,64,0],[46,13,46,174,0],[48,13,48,25,0],[49,9,49,10,0],[58,9,58,10,0],[59,13,59,70,0],[60,13,60,74,0],[61,13,61,25,0],[62,9,62,10,0],[69,9,69,10,0],[70,13,70,41,0],[71,9,71,10,0],[77,9,77,10,0],[79,13,79,395,0],[80,13,80,56,0],[81,9,81,10,0]]);
    </script>
  </body>
</html>