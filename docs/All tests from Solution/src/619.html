<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\translation\details.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.IO;
using System.Text;
using System.Xml;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

using umbraco.BasePages;
using umbraco.BusinessLogic;
using umbraco.cms.businesslogic.propertytype;
using umbraco.cms.businesslogic.task;
using umbraco.cms.businesslogic.translation;
using umbraco.cms.businesslogic.web;

using ICSharpCode.SharpZipLib.BZip2;
using ICSharpCode.SharpZipLib.Zip;
using ICSharpCode.SharpZipLib.Zip.Compression;
using ICSharpCode.SharpZipLib.Zip.Compression.Streams;
using ICSharpCode.SharpZipLib.GZip;

namespace umbraco.presentation.umbraco.translation {
    public partial class details : BasePages.UmbracoEnsuredPage {

        public details()
        {
            CurrentApp = BusinessLogic.DefaultApps.translation.ToString();

        }
        protected void closeTask(object sender, EventArgs e) {
            int translationId = int.Parse(Request[&quot;id&quot;]);
            Task t = new Task(translationId);

            if (t != null &amp;&amp; (t.ParentUser.Id == base.getUser().Id || t.User.Id == base.getUser().Id)) {
                t.Closed = true;
                t.Save();
                Response.Redirect(&quot;default.aspx&quot;);
            }
        }


        protected void Page_Load(object sender, EventArgs e) {
            int translationId = int.Parse(Request[&quot;id&quot;]);
            Task t = new Task(translationId);
            Document page = new Document(t.Node.Id);

            //Bind meta data and language... 
            Literal lt = new Literal();
            lt.Text = t.Date.ToLongDateString() + &quot; &quot; + t.Date.ToLongTimeString();
            pp_date.Controls.Add(lt);
            pp_date.Text = ui.Text(&quot;translation&quot;,&quot;taskOpened&quot;);

            lt = new Literal();
            lt.Text = t.ParentUser.Name;
            pp_owner.Controls.Add(lt);
            pp_owner.Text = ui.Text(&quot;translation&quot;, &quot;taskAssignedBy&quot;);

            lt = new Literal();
            lt.Text = Translation.CountWords(t.Node.Id).ToString();
            pp_totalWords.Controls.Add(lt);
            pp_totalWords.Text = ui.Text(&quot;translation&quot;, &quot;totalWords&quot;);

            lt = new Literal();
            lt.Text = library.ReplaceLineBreaks(t.Comment);
            pp_comment.Controls.Add(lt);
            pp_comment.Text = ui.Text(&quot;comment&quot;);

            lt = new Literal();
            lt.Text =  &quot;&lt;a target=\&quot;_blank\&quot; href=\&quot;xml.aspx?id=&quot; + t.Id + &quot;\&quot;&gt;&quot; + ui.Text(&quot;download&quot;) + &quot;&lt;/a&gt;&quot;;
            pp_xml.Controls.Add(lt);
            pp_xml.Text = ui.Text(&quot;translation&quot;, &quot;downloadTaskAsXml&quot;);

            pane_details.Text = ui.Text(&quot;translation&quot;, &quot;details&quot;);
            panel1.Text = ui.Text(&quot;translation&quot;, &quot;details&quot;);

            pane_fields.Text = ui.Text(&quot;translation&quot;, &quot;fields&quot;);
            pane_tasks.Text = ui.Text(&quot;translation&quot;, &quot;translationOptions&quot;);
            lt = new Literal();
            lt.Text = &quot;&lt;a href=\&quot;default.aspx?id=&quot; + t.Id + &quot;\&quot;&gt;&quot; + ui.Text(&quot;upload&quot;) + &quot;&lt;/a&gt;&quot;;
            pp_upload.Controls.Add(lt);
            pp_upload.Text = ui.Text(&quot;translation&quot;, &quot;uploadTranslationXml&quot;);

            if (t.Closed)
                pp_closeTask.Visible = false;
            else {
                pp_closeTask.Text = ui.Text(&quot;translation&quot;, &quot;closeTask&quot;);
                bt_close.Text = ui.Text(&quot;close&quot;);
            }


            //Bind page fields
            DataTable pageTable = new DataTable();
            pageTable.Columns.Add(ui.Text(&quot;name&quot;));
            pageTable.Columns.Add(ui.Text(&quot;value&quot;));
            
            DataRow pageRow = pageTable.NewRow();
            pageRow[ui.Text(&quot;name&quot;)] = ui.Text(&quot;nodeName&quot;);
            pageRow[ui.Text(&quot;value&quot;)] = page.Text;
            pageTable.Rows.Add(pageRow);
            
            foreach (PropertyType pt in page.ContentType.PropertyTypes) {
                pageRow = pageTable.NewRow();
                pageRow[ui.Text(&quot;name&quot;)] = pt.Name;
                pageRow[ui.Text(&quot;value&quot;)] = page.getProperty(pt.Alias).Value;
                pageTable.Rows.Add(pageRow);
            }
            
            dg_fields.DataSource = pageTable;
            dg_fields.DataBind();
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[26,9,26,25,0],[27,9,27,10,0],[28,13,28,75,0],[30,9,30,10,0],[31,62,31,63,0],[32,13,32,58,0],[33,13,33,46,0],[35,13,35,103,0],[35,104,35,105,0],[36,17,36,33,0],[37,17,37,26,0],[38,17,38,51,0],[39,13,39,14,0],[40,9,40,10,0],[43,62,43,63,0],[44,13,44,58,0],[45,13,45,46,0],[46,13,46,53,0],[49,13,49,40,0],[50,13,50,83,0],[51,13,51,38,0],[52,13,52,64,0],[54,13,54,32,0],[55,13,55,41,0],[56,13,56,39,0],[57,13,57,70,0],[59,13,59,32,0],[60,13,60,68,0],[61,13,61,44,0],[62,13,62,71,0],[64,13,64,32,0],[65,13,65,60,0],[66,13,66,41,0],[67,13,67,50,0],[69,13,69,32,0],[70,13,70,113,0],[71,13,71,37,0],[72,13,72,71,0],[74,13,74,67,0],[75,13,75,61,0],[77,13,77,65,0],[78,13,78,76,0],[79,13,79,32,0],[80,13,80,96,0],[81,13,81,40,0],[82,13,82,77,0],[84,13,84,26,0],[85,17,85,46,0],[86,18,86,19,0],[87,17,87,73,0],[88,17,88,50,0],[89,13,89,14,0],[93,13,93,51,0],[94,13,94,52,0],[95,13,95,53,0],[97,13,97,50,0],[98,13,98,60,0],[99,13,99,51,0],[100,13,100,41,0],[102,13,102,20,0],[102,22,102,37,0],[102,38,102,40,0],[102,41,102,71,0],[102,73,102,74,0],[103,17,103,46,0],[104,17,104,52,0],[105,17,105,78,0],[106,17,106,45,0],[107,13,107,14,0],[109,13,109,46,0],[110,13,110,34,0],[111,9,111,10,0]]);
    </script>
  </body>
</html>