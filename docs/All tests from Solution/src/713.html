<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\FormDataCollectionExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http.Formatting;
using System.Text;
using Umbraco.Core;

namespace Umbraco.Web
{
    
    public static class FormDataCollectionExtensions
    {
        /// &lt;summary&gt;
        /// Converts a dictionary object to a query string representation such as:
        /// firstname=shannon&amp;lastname=deminick
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;items&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;keysToIgnore&quot;&gt;Any keys found in this collection will be removed from the output&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string ToQueryString(this FormDataCollection items, params string[] keysToIgnore)
        {
            if (items == null) return &quot;&quot;;
            if (items.Any() == false) return &quot;&quot;;

            var builder = new StringBuilder();
            foreach (var i in items.Where(i =&gt; keysToIgnore.InvariantContains(i.Key) == false))
            {
                builder.Append(string.Format(&quot;{0}={1}&amp;&quot;, i.Key, i.Value));
            }
            return builder.ToString().TrimEnd(&#39;&amp;&#39;);
        }

        /// &lt;summary&gt;
        /// Converts the FormCollection to a dictionary
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;items&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static IDictionary&lt;string, object&gt; ToDictionary(this FormDataCollection items)
        {
            return items.ToDictionary(x =&gt; x.Key, x =&gt; (object)x.Value);
        }

        /// &lt;summary&gt;
        /// Returns the value of a mandatory item in the FormCollection
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;items&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetRequiredString(this FormDataCollection items, string key)
        {
            if (items.HasKey(key) == false)
                throw new ArgumentNullException(&quot;The &quot; + key + &quot; query string parameter was not found but is required&quot;);
            return items.Single(x =&gt; x.Key.InvariantEquals(key)).Value;
        }

        /// &lt;summary&gt;
        /// Checks if the collection contains the key
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;items&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static bool HasKey(this FormDataCollection items, string key)
        {
            return items.Any(x =&gt; x.Key.InvariantEquals(key));
        }

        /// &lt;summary&gt;
        /// Returns the object based in the collection based on it&#39;s key. This does this with a conversion so if it doesn&#39;t convert a null object is returned.
        /// &lt;/summary&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;param name=&quot;items&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static T GetValue&lt;T&gt;(this FormDataCollection items, string key)
        {
            var val = items.Get(key);
            if (string.IsNullOrEmpty(val)) return default(T);

            var converted = val.TryConvertTo&lt;T&gt;();
            return converted.Success 
                ? converted.Result 
                : default(T);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[21,9,21,10,0],[22,13,22,31,0],[22,32,22,42,0],[23,13,23,38,0],[23,39,23,49,0],[25,13,25,47,0],[26,13,26,20,0],[26,22,26,27,0],[26,28,26,30,0],[26,31,26,48,0],[26,48,26,94,0],[26,94,26,95,0],[26,31,26,95,0],[27,13,27,14,0],[28,17,28,75,0],[29,13,29,14,0],[30,13,30,52,0],[31,9,31,10,0],[39,9,39,10,0],[40,13,40,44,0],[40,44,40,49,0],[40,49,40,56,0],[40,56,40,71,0],[40,71,40,73,0],[40,13,40,73,0],[41,9,41,10,0],[50,9,50,10,0],[51,13,51,44,0],[52,17,52,121,0],[53,13,53,38,0],[53,38,53,64,0],[53,64,53,72,0],[53,13,53,72,0],[54,9,54,10,0],[63,9,63,10,0],[64,13,64,35,0],[64,35,64,61,0],[64,61,64,63,0],[64,13,64,63,0],[65,9,65,10,0],[75,9,75,10,0],[76,13,76,38,0],[77,13,77,43,0],[77,44,77,62,0],[79,13,79,51,0],[80,13,82,30,0],[83,9,83,10,0]]);
    </script>
  </body>
</html>