<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Services\Importing\PackageImportTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;
using NUnit.Framework;
using Umbraco.Core.Models;
using Umbraco.Core;
using Umbraco.Core.Models.Rdbms;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Services.Importing
{
    [DatabaseTestBehavior(DatabaseBehavior.NewDbFileAndSchemaPerTest)]
    [TestFixture, RequiresSTA]
    public class PackageImportTests : BaseServiceTest
    {
        [SetUp]
        public override void Initialize()
        {
            base.Initialize();
        }

        [TearDown]
        public override void TearDown()
        {
            base.TearDown();
        }

        [Test]
        public void PackagingService_Can_Import_uBlogsy_ContentTypes_And_Verify_Structure()
        {
            // Arrange
            string strXml = ImportResources.uBlogsy_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var dataTypes = packagingService.ImportDataTypeDefinitions(dataTypeElement);
            var templates = packagingService.ImportTemplates(templateElement);
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);

            var numberOfTemplates = (from doc in templateElement.Elements(&quot;Template&quot;) select doc).Count();
            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            // Assert
            Assert.That(dataTypes.Any(), Is.True);
            Assert.That(templates.Any(), Is.True);
            Assert.That(templates.Count(), Is.EqualTo(numberOfTemplates));
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));

            var uBlogsyBaseDocType = contentTypes.First(x =&gt; x.Alias == &quot;uBlogsyBaseDocType&quot;);
            Assert.That(uBlogsyBaseDocType.PropertyTypes.Count(), Is.EqualTo(5));
            Assert.That(uBlogsyBaseDocType.PropertyGroups.Any(), Is.False);

            var uBlogsyBasePage = contentTypes.First(x =&gt; x.Alias == &quot;uBlogsyBasePage&quot;);
            Assert.That(uBlogsyBasePage.ContentTypeCompositionExists(&quot;uBlogsyBaseDocType&quot;), Is.True);
            Assert.That(uBlogsyBasePage.PropertyTypes.Count(), Is.EqualTo(7));
            Assert.That(uBlogsyBasePage.PropertyGroups.Count(), Is.EqualTo(3));
            Assert.That(uBlogsyBasePage.PropertyGroups[&quot;Content&quot;].PropertyTypes.Count(), Is.EqualTo(3));
            Assert.That(uBlogsyBasePage.PropertyGroups[&quot;SEO&quot;].PropertyTypes.Count(), Is.EqualTo(3));
            Assert.That(uBlogsyBasePage.PropertyGroups[&quot;Navigation&quot;].PropertyTypes.Count(), Is.EqualTo(1));
            Assert.That(uBlogsyBasePage.CompositionPropertyTypes.Count(), Is.EqualTo(12));

            var uBlogsyLanding = contentTypes.First(x =&gt; x.Alias == &quot;uBlogsyLanding&quot;);
            Assert.That(uBlogsyLanding.ContentTypeCompositionExists(&quot;uBlogsyBasePage&quot;), Is.True);
            Assert.That(uBlogsyLanding.ContentTypeCompositionExists(&quot;uBlogsyBaseDocType&quot;), Is.True);
            Assert.That(uBlogsyLanding.PropertyTypes.Count(), Is.EqualTo(5));
            Assert.That(uBlogsyLanding.PropertyGroups.Count(), Is.EqualTo(2));
            Assert.That(uBlogsyLanding.CompositionPropertyTypes.Count(), Is.EqualTo(17));
            Assert.That(uBlogsyLanding.CompositionPropertyGroups.Count(), Is.EqualTo(5));
        }

        [Test]
        public void PackagingService_Can_Import_Inherited_ContentTypes_And_Verify_PropertyTypes_UniqueIds()
        {
            // Arrange
            var strXml = ImportResources.InheritedDocTypes_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var dataTypes = packagingService.ImportDataTypeDefinitions(dataTypeElement);
            var templates = packagingService.ImportTemplates(templateElement);
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);

            // Assert
            var mRBasePage = contentTypes.First(x =&gt; x.Alias == &quot;MRBasePage&quot;);
            foreach (var propertyType in mRBasePage.PropertyTypes)
            {
                var propertyTypeDto = this.DatabaseContext.Database.First&lt;PropertyTypeDto&gt;(&quot;WHERE id = @id&quot;, new { id = propertyType.Id });
                Assert.AreEqual(propertyTypeDto.UniqueId, propertyType.Key);
            }
        }

        [Test]
        public void PackagingService_Can_Import_Inherited_ContentTypes_And_Verify_PropertyGroups_And_PropertyTypes()
        {
            // Arrange
            string strXml = ImportResources.InheritedDocTypes_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var dataTypes = packagingService.ImportDataTypeDefinitions(dataTypeElement);
            var templates = packagingService.ImportTemplates(templateElement);
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);

            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            // Assert
            Assert.That(dataTypes.Any(), Is.False);
            Assert.That(templates.Any(), Is.False);
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));

            var mRBasePage = contentTypes.First(x =&gt; x.Alias == &quot;MRBasePage&quot;);
            Assert.That(mRBasePage.PropertyTypes.Count(), Is.EqualTo(3));
            Assert.That(mRBasePage.PropertyGroups.Count(), Is.EqualTo(1));
            Assert.That(mRBasePage.PropertyGroups[&quot;Metadaten&quot;].PropertyTypes.Count(), Is.EqualTo(2));

            var mRStartPage = contentTypes.First(x =&gt; x.Alias == &quot;MRStartPage&quot;);
            Assert.That(mRStartPage.ContentTypeCompositionExists(&quot;MRBasePage&quot;), Is.True);
            Assert.That(mRStartPage.PropertyTypes.Count(), Is.EqualTo(28));
            Assert.That(mRStartPage.PropertyGroups.Count(), Is.EqualTo(7));

            var propertyGroups = mRStartPage.CompositionPropertyGroups.Where(x =&gt; x.Name == &quot;Metadaten&quot;);
            var propertyTypes = propertyGroups.SelectMany(x =&gt; x.PropertyTypes);
            Assert.That(propertyGroups.Count(), Is.EqualTo(2));
            Assert.That(propertyTypes.Count(), Is.EqualTo(6));
        }

        [Test]
        public void PackagingService_Can_Import_Template_Package_Xml()
        {
            // Arrange
            string strXml = ImportResources.StandardMvc_Package;
            var xml = XElement.Parse(strXml);
            var element = xml.Descendants(&quot;Templates&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var templates = packagingService.ImportTemplates(element);
            var numberOfTemplates = (from doc in element.Elements(&quot;Template&quot;) select doc).Count();

            // Assert
            Assert.That(templates, Is.Not.Null);
            Assert.That(templates.Any(), Is.True);
            Assert.That(templates.Count(), Is.EqualTo(numberOfTemplates));
        }

        [Test]
        public void PackagingService_Can_Import_Single_Template()
        {
            // Arrange
            string strXml = ImportResources.StandardMvc_Package;
            var xml = XElement.Parse(strXml);
            var element = xml.Descendants(&quot;Templates&quot;).First().Element(&quot;Template&quot;);
            var packagingService = ServiceContext.PackagingService;

            // Act
            var templates = packagingService.ImportTemplates(element);

            // Assert
            Assert.That(templates, Is.Not.Null);
            Assert.That(templates.Any(), Is.True);
            Assert.That(templates.Count(), Is.EqualTo(1));
        }

        [Test]
        public void PackagingService_Can_Import_StandardMvc_ContentTypes_Package_Xml()
        {
            // Arrange
            string strXml = ImportResources.StandardMvc_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var dataTypeDefinitions = packagingService.ImportDataTypeDefinitions(dataTypeElement);
            var templates = packagingService.ImportTemplates(templateElement);
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);
            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            // Assert
            Assert.That(dataTypeDefinitions, Is.Not.Null);
            Assert.That(dataTypeDefinitions.Any(), Is.True);
            Assert.That(templates.Any(), Is.True);
            Assert.That(contentTypes, Is.Not.Null);
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));
            Assert.That(contentTypes.Count(x =&gt; x.ParentId == -1), Is.EqualTo(1));

            var contentMaster = contentTypes.First(x =&gt; x.Alias == &quot;ContentMaster&quot;);
            Assert.That(contentMaster.PropertyTypes.Count(), Is.EqualTo(3));
            Assert.That(contentMaster.PropertyGroups.Count(), Is.EqualTo(1));
            Assert.That(contentMaster.PropertyGroups[&quot;SEO&quot;].PropertyTypes.Count(), Is.EqualTo(3));
            Assert.That(contentMaster.ContentTypeCompositionExists(&quot;Base&quot;), Is.True);

            var propertyGroupId = contentMaster.PropertyGroups[&quot;SEO&quot;].Id;
            Assert.That(contentMaster.PropertyGroups[&quot;SEO&quot;].PropertyTypes.Any(x =&gt; x.PropertyGroupId.Value != propertyGroupId), Is.False);
        }

        [Test]
        public void PackagingService_Can_Import_StandardMvc_ContentTypes_And_Templates_Xml()
        {
            // Arrange
            string strXml = ImportResources.StandardMvc_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();

            // Act
            var dataTypeDefinitions = ServiceContext.PackagingService.ImportDataTypeDefinitions(dataTypeElement);
            var templates = ServiceContext.PackagingService.ImportTemplates(templateElement);
            var contentTypes = ServiceContext.PackagingService.ImportContentTypes(docTypeElement);
            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            //Assert - Re-Import contenttypes doesn&#39;t throw
            Assert.DoesNotThrow(() =&gt; ServiceContext.PackagingService.ImportContentTypes(docTypeElement));
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));
            Assert.That(dataTypeDefinitions, Is.Not.Null);
            Assert.That(dataTypeDefinitions.Any(), Is.True);
            Assert.That(templates.Any(), Is.True);
        }

        [Test]
        public void PackagingService_Can_Import_Fanoe_Starterkit_ContentTypes_And_Templates_Xml()
        {
            // Arrange
            string strXml = ImportResources.Fanoe_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();

            // Act
            var dataTypeDefinitions = ServiceContext.PackagingService.ImportDataTypeDefinitions(dataTypeElement);
            var templates = ServiceContext.PackagingService.ImportTemplates(templateElement);
            var contentTypes = ServiceContext.PackagingService.ImportContentTypes(docTypeElement);
            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            //Assert - Re-Import contenttypes doesn&#39;t throw
            Assert.DoesNotThrow(() =&gt; ServiceContext.PackagingService.ImportContentTypes(docTypeElement));
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));
            Assert.That(dataTypeDefinitions, Is.Not.Null);
            Assert.That(dataTypeDefinitions.Any(), Is.True);
            Assert.That(templates.Any(), Is.True);
        }

        [Test]
        public void PackagingService_Can_Import_Content_Package_Xml()
        {
            // Arrange
            string strXml = ImportResources.StandardMvc_Package;
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var docTypesElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var element = xml.Descendants(&quot;DocumentSet&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var dataTypeDefinitions = packagingService.ImportDataTypeDefinitions(dataTypeElement);
            var contentTypes = packagingService.ImportContentTypes(docTypesElement);
            var contents = packagingService.ImportContent(element);
            var numberOfDocs = (from doc in element.Descendants()
                                where (string) doc.Attribute(&quot;isDoc&quot;) == &quot;&quot;
                                select doc).Count();

            // Assert
            Assert.That(contents, Is.Not.Null);
            Assert.That(dataTypeDefinitions.Any(), Is.True);
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contents.Any(), Is.True);
            Assert.That(contents.Count(), Is.EqualTo(numberOfDocs));
        }
        
        [Test]
        public void PackagingService_Can_Import_CheckboxList_Content_Package_Xml_With_Property_Editor_Aliases()
        {
            AssertCheckBoxListTests(ImportResources.CheckboxList_Content_Package);
        }

        [Test]
        public void PackagingService_Can_Import_CheckboxList_Content_Package_Xml_With_Legacy_Property_Editor_Ids()
        {
            AssertCheckBoxListTests(ImportResources.CheckboxList_Content_Package_LegacyIds);
        }

        private void AssertCheckBoxListTests(string strXml)
        {
            // Arrange
            var xml = XElement.Parse(strXml);
            var dataTypeElement = xml.Descendants(&quot;DataTypes&quot;).First();
            var docTypesElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var element = xml.Descendants(&quot;DocumentSet&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var dataTypeDefinitions = packagingService.ImportDataTypeDefinitions(dataTypeElement);
            var contentTypes = packagingService.ImportContentTypes(docTypesElement);
            var contents = packagingService.ImportContent(element);
            var numberOfDocs = (from doc in element.Descendants()
                                where (string)doc.Attribute(&quot;isDoc&quot;) == &quot;&quot;
                                select doc).Count();

            var database = ApplicationContext.DatabaseContext.Database;
            var dtos = database.Fetch&lt;DataTypePreValueDto&gt;(&quot;WHERE datatypeNodeId = @Id&quot;, new { dataTypeDefinitions.First().Id });
            int preValueId;
            int.TryParse(contents.First().GetValue&lt;string&gt;(&quot;testList&quot;), out preValueId);
            var preValueKey = dtos.SingleOrDefault(x =&gt; x.Id == preValueId);

            // Assert
            Assert.That(dataTypeDefinitions, Is.Not.Null);
            Assert.That(dataTypeDefinitions.Any(), Is.True);
            Assert.AreEqual(Constants.PropertyEditors.CheckBoxListAlias, dataTypeDefinitions.First().PropertyEditorAlias);
            Assert.That(contents, Is.Not.Null);
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contents.Any(), Is.True);
            Assert.That(contents.Count(), Is.EqualTo(numberOfDocs));
            Assert.That(preValueKey, Is.Not.Null);
            Assert.That(preValueKey.Value, Is.EqualTo(&quot;test3&quot;));
        }

        [Test]
        public void PackagingService_Can_Import_Templates_Package_Xml_With_Invalid_Master()
        {
            // Arrange
            string strXml = ImportResources.XsltSearch_Package;
            var xml = XElement.Parse(strXml);
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var templates = packagingService.ImportTemplates(templateElement);
            var numberOfTemplates = (from doc in templateElement.Elements(&quot;Template&quot;) select doc).Count();

            // Assert
            Assert.That(templates.Any(), Is.True);
            Assert.That(templates.Count(), Is.EqualTo(numberOfTemplates));
        }

        [Test]
        public void PackagingService_Can_Import_Single_DocType()
        {
            // Arrange
            string strXml = ImportResources.SingleDocType;
            var docTypeElement = XElement.Parse(strXml);
            var packagingService = ServiceContext.PackagingService;

            // Act
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);

            // Assert
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Any(x =&gt; x.HasIdentity == false), Is.False);
            Assert.That(contentTypes.Count(), Is.EqualTo(1));
        }

        [Test]
        public void PackagingService_Can_Export_Single_DocType()
        {
            // Arrange
            string strXml = ImportResources.SingleDocType;
            var docTypeElement = XElement.Parse(strXml);
            var packagingService = ServiceContext.PackagingService;

            // Act
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);
            var contentType = contentTypes.FirstOrDefault();
            var element = packagingService.Export(contentType);

            // Assert
            Assert.That(element, Is.Not.Null);
            Assert.That(element.Element(&quot;Info&quot;), Is.Not.Null);
            Assert.That(element.Element(&quot;Structure&quot;), Is.Not.Null);
            Assert.That(element.Element(&quot;GenericProperties&quot;), Is.Not.Null);
            Assert.That(element.Element(&quot;Tabs&quot;), Is.Not.Null);
            //Can&#39;t compare this XElement because the templates are not imported (they don&#39;t exist)
            //Assert.That(XNode.DeepEquals(docTypeElement, element), Is.True);
        }

        [Test]
        public void PackagingService_Can_ReImport_Single_DocType()
        {
            // Arrange
            string strXml = ImportResources.SingleDocType;
            var docTypeElement = XElement.Parse(strXml);

            // Act
            var contentTypes = ServiceContext.PackagingService.ImportContentTypes(docTypeElement);
            var contentTypesUpdated = ServiceContext.PackagingService.ImportContentTypes(docTypeElement);

            // Assert
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Any(x =&gt; x.HasIdentity == false), Is.False);
            Assert.That(contentTypes.Count(), Is.EqualTo(1));
            Assert.That(contentTypes.First().AllowedContentTypes.Count(), Is.EqualTo(1));

            Assert.That(contentTypesUpdated.Any(), Is.True);
            Assert.That(contentTypesUpdated.Any(x =&gt; x.HasIdentity == false), Is.False);
            Assert.That(contentTypesUpdated.Count(), Is.EqualTo(1));
            Assert.That(contentTypesUpdated.First().AllowedContentTypes.Count(), Is.EqualTo(1));
        }

        [Test]
        public void PackagingService_Can_ReImport_Templates_To_Update()
        {
            var newPackageXml = XElement.Parse(ImportResources.TemplateOnly_Package);
            var updatedPackageXml = XElement.Parse(ImportResources.TemplateOnly_Updated_Package);

            var templateElement = newPackageXml.Descendants(&quot;Templates&quot;).First();
            var templateElementUpdated = updatedPackageXml.Descendants(&quot;Templates&quot;).First();
            var packagingService = ServiceContext.PackagingService;
            var fileService = ServiceContext.FileService;

            // Act
            var numberOfTemplates = (from doc in templateElement.Elements(&quot;Template&quot;) select doc).Count();
            var templates = packagingService.ImportTemplates(templateElement);
            var templatesAfterUpdate = packagingService.ImportTemplates(templateElementUpdated);
            var allTemplates = fileService.GetTemplates();
            
            // Assert
            Assert.That(templates.Any(), Is.True);
            Assert.That(templates.Count(), Is.EqualTo(numberOfTemplates));
            Assert.That(templatesAfterUpdate.Count(), Is.EqualTo(numberOfTemplates));
            Assert.That(allTemplates.Count(), Is.EqualTo(numberOfTemplates));
            Assert.That(allTemplates.First(x =&gt; x.Alias == &quot;umbHomepage&quot;).Content, Contains.Substring(&quot;THIS HAS BEEN UPDATED!&quot;));
        }

        [Test]
        public void PackagingService_Can_Import_DictionaryItems()
        {
            // Arrange
            const string expectedEnglishParentValue = &quot;ParentValue&quot;;
            const string expectedNorwegianParentValue = &quot;ForelderVerdi&quot;;
            const string expectedEnglishChildValue = &quot;ChildValue&quot;;
            const string expectedNorwegianChildValue = &quot;BarnVerdi&quot;;

            var newPackageXml = XElement.Parse(ImportResources.Dictionary_Package);
            var dictionaryItemsElement = newPackageXml.Elements(&quot;DictionaryItems&quot;).First();

            AddLanguages();

            // Act
            ServiceContext.PackagingService.ImportDictionaryItems(dictionaryItemsElement);

            // Assert
            AssertDictionaryItem(&quot;Parent&quot;, expectedEnglishParentValue, &quot;en-GB&quot;);
            AssertDictionaryItem(&quot;Parent&quot;, expectedNorwegianParentValue, &quot;nb-NO&quot;);
            AssertDictionaryItem(&quot;Child&quot;, expectedEnglishChildValue, &quot;en-GB&quot;);
            AssertDictionaryItem(&quot;Child&quot;, expectedNorwegianChildValue, &quot;nb-NO&quot;);
        }

        [Test]
        public void PackagingService_Can_Import_Nested_DictionaryItems()
        {
            // Arrange
            const string parentKey = &quot;Parent&quot;;
            const string childKey = &quot;Child&quot;;

            var newPackageXml = XElement.Parse(ImportResources.Dictionary_Package);
            var dictionaryItemsElement = newPackageXml.Elements(&quot;DictionaryItems&quot;).First();

            AddLanguages();

            // Act
            var dictionaryItems = ServiceContext.PackagingService.ImportDictionaryItems(dictionaryItemsElement);

            // Assert
            Assert.That(ServiceContext.LocalizationService.DictionaryItemExists(parentKey), &quot;DictionaryItem parentKey does not exist&quot;);
            Assert.That(ServiceContext.LocalizationService.DictionaryItemExists(childKey), &quot;DictionaryItem childKey does not exist&quot;);

            var parentDictionaryItem = ServiceContext.LocalizationService.GetDictionaryItemByKey(parentKey);
            var childDictionaryItem = ServiceContext.LocalizationService.GetDictionaryItemByKey(childKey);
            
            Assert.That(parentDictionaryItem.ParentId, Is.Not.EqualTo(childDictionaryItem.ParentId));
            Assert.That(childDictionaryItem.ParentId, Is.EqualTo(parentDictionaryItem.Key));
        }

        [Test]
        public void PackagingService_WhenExistingDictionaryKey_ImportsNewChildren()
        {
            // Arrange
            const string expectedEnglishParentValue = &quot;ExistingParentValue&quot;;
            const string expectedNorwegianParentValue = &quot;EksisterendeForelderVerdi&quot;;
            const string expectedEnglishChildValue = &quot;ChildValue&quot;;
            const string expectedNorwegianChildValue = &quot;BarnVerdi&quot;;

            var newPackageXml = XElement.Parse(ImportResources.Dictionary_Package);
            var dictionaryItemsElement = newPackageXml.Elements(&quot;DictionaryItems&quot;).First();

            AddLanguages();
            AddExistingEnglishAndNorwegianParentDictionaryItem(expectedEnglishParentValue, expectedNorwegianParentValue);

            // Act
            ServiceContext.PackagingService.ImportDictionaryItems(dictionaryItemsElement);

            // Assert
            AssertDictionaryItem(&quot;Parent&quot;, expectedEnglishParentValue, &quot;en-GB&quot;);
            AssertDictionaryItem(&quot;Parent&quot;, expectedNorwegianParentValue, &quot;nb-NO&quot;);
            AssertDictionaryItem(&quot;Child&quot;, expectedEnglishChildValue, &quot;en-GB&quot;);
            AssertDictionaryItem(&quot;Child&quot;, expectedNorwegianChildValue, &quot;nb-NO&quot;);
        }

        [Test]
        public void PackagingService_WhenExistingDictionaryKey_OnlyAddsNewLanguages()
        {
            // Arrange
            const string expectedEnglishParentValue = &quot;ExistingParentValue&quot;;
            const string expectedNorwegianParentValue = &quot;ForelderVerdi&quot;;
            const string expectedEnglishChildValue = &quot;ChildValue&quot;;
            const string expectedNorwegianChildValue = &quot;BarnVerdi&quot;;

            var newPackageXml = XElement.Parse(ImportResources.Dictionary_Package);
            var dictionaryItemsElement = newPackageXml.Elements(&quot;DictionaryItems&quot;).First();

            AddLanguages();
            AddExistingEnglishParentDictionaryItem(expectedEnglishParentValue);

            // Act
            ServiceContext.PackagingService.ImportDictionaryItems(dictionaryItemsElement);

            // Assert
            AssertDictionaryItem(&quot;Parent&quot;, expectedEnglishParentValue, &quot;en-GB&quot;);
            AssertDictionaryItem(&quot;Parent&quot;, expectedNorwegianParentValue, &quot;nb-NO&quot;);
            AssertDictionaryItem(&quot;Child&quot;, expectedEnglishChildValue, &quot;en-GB&quot;);
            AssertDictionaryItem(&quot;Child&quot;, expectedNorwegianChildValue, &quot;nb-NO&quot;);
        }

        [Test]
        public void PackagingService_Can_Import_Languages()
        {
            // Arrange
            var newPackageXml = XElement.Parse(ImportResources.Dictionary_Package);
            var LanguageItemsElement = newPackageXml.Elements(&quot;Languages&quot;).First();

            // Act
            var languages = ServiceContext.PackagingService.ImportLanguages(LanguageItemsElement);
            var allLanguages = ServiceContext.LocalizationService.GetAllLanguages();

            // Assert
            Assert.That(languages.Any(x =&gt; x.HasIdentity == false), Is.False);
            foreach (var language in languages)
            {
                Assert.That(allLanguages.Any(x =&gt; x.IsoCode == language.IsoCode), Is.True);
            }
        }

        [Test]
        public void PackagingService_Can_Import_Macros()
        {
            // Arrange
            string strXml = ImportResources.uBlogsy_Package;
            var xml = XElement.Parse(strXml);
            var macrosElement = xml.Descendants(&quot;Macros&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var macros = packagingService.ImportMacros(macrosElement).ToList();

            // Assert
            Assert.That(macros.Any(), Is.True);

            var allMacros = ServiceContext.MacroService.GetAll().ToList();
            foreach (var macro in macros)
            {
                Assert.That(allMacros.Any(x =&gt; x.Alias == macro.Alias), Is.True);
            }
        }

        [Test]
        public void PackagingService_Can_Import_Macros_With_Properties()
        {
            // Arrange
            string strXml = ImportResources.XsltSearch_Package;
            var xml = XElement.Parse(strXml);
            var macrosElement = xml.Descendants(&quot;Macros&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var macros = packagingService.ImportMacros(macrosElement).ToList();

            // Assert
            Assert.That(macros.Any(), Is.True);
            Assert.That(macros.First().Properties.Any(), Is.True);

            var allMacros = ServiceContext.MacroService.GetAll().ToList();
            foreach (var macro in macros)
            {
                Assert.That(allMacros.Any(x =&gt; x.Alias == macro.Alias), Is.True);
            }
        }

        [Test]
        public void PackagingService_Can_Import_Package_With_Compositions()
        {
            // Arrange
            string strXml = ImportResources.CompositionsTestPackage;
            var xml = XElement.Parse(strXml);
            var templateElement = xml.Descendants(&quot;Templates&quot;).First();
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var templates = packagingService.ImportTemplates(templateElement);
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);
            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            // Assert
            Assert.That(contentTypes, Is.Not.Null);
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));
            Assert.That(contentTypes.Count(x =&gt; x.ParentId == -1), Is.EqualTo(3));

            var textpage = contentTypes.First(x =&gt; x.Alias.Equals(&quot;umbTextyPage&quot;));
            Assert.That(textpage.ParentId, Is.Not.EqualTo(-1));
            Assert.That(textpage.ContentTypeComposition.Count(), Is.EqualTo(3));
            Assert.That(textpage.ContentTypeCompositionExists(&quot;umbMaster&quot;), Is.True);
            Assert.That(textpage.ContentTypeCompositionExists(&quot;Meta&quot;), Is.True);
            Assert.That(textpage.ContentTypeCompositionExists(&quot;Seo&quot;), Is.True);
        }

        [Test]
        public void PackagingService_Can_Import_Package_With_Compositions_Ordered()
        {
            // Arrange
            string strXml = ImportResources.CompositionsTestPackage_Random;
            var xml = XElement.Parse(strXml);
            var docTypeElement = xml.Descendants(&quot;DocumentTypes&quot;).First();
            var packagingService = ServiceContext.PackagingService;

            // Act
            var contentTypes = packagingService.ImportContentTypes(docTypeElement);
            var numberOfDocTypes = (from doc in docTypeElement.Elements(&quot;DocumentType&quot;) select doc).Count();

            // Assert
            Assert.That(contentTypes, Is.Not.Null);
            Assert.That(contentTypes.Any(), Is.True);
            Assert.That(contentTypes.Count(), Is.EqualTo(numberOfDocTypes));

            var testContentType = contentTypes.First(x =&gt; x.Alias.Equals(&quot;CompositeTest&quot;));
            Assert.That(testContentType.ContentTypeComposition.Count(), Is.EqualTo(3));
            Assert.That(testContentType.ContentTypeCompositionExists(&quot;Content&quot;), Is.True);
            Assert.That(testContentType.ContentTypeCompositionExists(&quot;Meta&quot;), Is.True);
            Assert.That(testContentType.ContentTypeCompositionExists(&quot;Seo&quot;), Is.True);
        }

        private void AddLanguages()
        {
            var norwegian = new Core.Models.Language(&quot;nb-NO&quot;);
            var english = new Core.Models.Language(&quot;en-GB&quot;);
            ServiceContext.LocalizationService.Save(norwegian, 0);
            ServiceContext.LocalizationService.Save(english, 0);
        }

        private void AssertDictionaryItem(string key, string expectedValue, string cultureCode)
        {
            Assert.That(ServiceContext.LocalizationService.DictionaryItemExists(key), &quot;DictionaryItem key does not exist&quot;);
            var dictionaryItem = ServiceContext.LocalizationService.GetDictionaryItemByKey(key);
            var translation = dictionaryItem.Translations.SingleOrDefault(i =&gt; i.Language.IsoCode == cultureCode);
            Assert.IsNotNull(translation, &quot;Translation to {0} was not added&quot;, cultureCode);
            var value = translation.Value;
            Assert.That(value, Is.EqualTo(expectedValue), &quot;Translation value was not set&quot;);
        }

        private void AddExistingEnglishParentDictionaryItem(string expectedEnglishParentValue)
        {
            var languages = ServiceContext.LocalizationService.GetAllLanguages().ToList();
            var englishLanguage = languages.Single(l =&gt; l.IsoCode == &quot;en-GB&quot;);
            ServiceContext.LocalizationService.Save(
                new DictionaryItem(&quot;Parent&quot;)
                {
                    Translations = new List&lt;IDictionaryTranslation&gt;
                                    {
                                            new DictionaryTranslation(englishLanguage, expectedEnglishParentValue),
                                    }
                }
            );
        }

        private void AddExistingEnglishAndNorwegianParentDictionaryItem(string expectedEnglishParentValue, string expectedNorwegianParentValue)
        {
            var languages = ServiceContext.LocalizationService.GetAllLanguages().ToList();
            var englishLanguage = languages.Single(l =&gt; l.IsoCode == &quot;en-GB&quot;);
            var norwegianLanguage = languages.Single(l =&gt; l.IsoCode == &quot;nb-NO&quot;);
            ServiceContext.LocalizationService.Save(
                new DictionaryItem(&quot;Parent&quot;)
                {
                    Translations = new List&lt;IDictionaryTranslation&gt;
                                    {
                                            new DictionaryTranslation(englishLanguage, expectedEnglishParentValue),
                                            new DictionaryTranslation(norwegianLanguage, expectedNorwegianParentValue),
                                    }
                }
            );
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[19,9,19,10,1],[20,13,20,31,1],[21,9,21,10,1],[25,9,25,10,1],[26,13,26,29,1],[27,9,27,10,1],[31,9,31,10,1],[33,13,33,61,1],[34,13,34,46,1],[35,13,35,72,1],[36,13,36,72,1],[37,13,37,75,1],[38,13,38,68,1],[41,13,41,89,1],[42,13,42,79,1],[43,13,43,84,1],[45,13,45,94,1],[45,94,45,97,1],[45,97,45,107,1],[45,13,45,107,1],[46,13,46,96,1],[46,96,46,99,1],[46,99,46,109,1],[46,13,46,109,1],[49,13,49,51,1],[50,13,50,51,1],[51,13,51,75,1],[52,13,52,54,1],[53,13,53,77,1],[55,13,55,62,1],[55,62,55,93,1],[55,93,55,95,1],[55,13,55,95,1],[56,13,56,82,1],[57,13,57,76,1],[59,13,59,59,1],[59,59,59,87,1],[59,87,59,89,1],[59,13,59,89,1],[60,13,60,102,1],[61,13,61,79,1],[62,13,62,80,1],[63,13,63,105,1],[64,13,64,101,1],[65,13,65,108,1],[66,13,66,91,1],[68,13,68,58,1],[68,58,68,85,1],[68,85,68,87,1],[68,13,68,87,1],[69,13,69,98,1],[70,13,70,101,1],[71,13,71,78,1],[72,13,72,79,1],[73,13,73,90,1],[74,13,74,90,1],[75,9,75,10,1],[79,9,79,10,1],[81,13,81,68,1],[82,13,82,46,1],[83,13,83,72,1],[84,13,84,72,1],[85,13,85,75,1],[86,13,86,68,1],[89,13,89,89,1],[90,13,90,79,1],[91,13,91,84,1],[94,13,94,54,1],[94,54,94,77,1],[94,77,94,79,1],[94,13,94,79,1],[95,13,95,20,1],[95,22,95,38,1],[95,39,95,41,1],[95,42,95,66,1],[96,13,96,14,1],[97,17,97,140,1],[98,17,98,77,1],[99,13,99,14,1],[100,9,100,10,1],[104,9,104,10,1],[106,13,106,71,1],[107,13,107,46,1],[108,13,108,72,1],[109,13,109,72,1],[110,13,110,75,1],[111,13,111,68,1],[114,13,114,89,1],[115,13,115,79,1],[116,13,116,84,1],[118,13,118,96,1],[118,96,118,99,1],[118,99,118,109,1],[118,13,118,109,1],[121,13,121,52,1],[122,13,122,52,1],[123,13,123,54,1],[124,13,124,77,1],[126,13,126,54,1],[126,54,126,77,1],[126,77,126,79,1],[126,13,126,79,1],[127,13,127,74,1],[128,13,128,75,1],[129,13,129,102,1],[131,13,131,55,1],[131,55,131,79,1],[131,79,131,81,1],[131,13,131,81,1],[132,13,132,90,1],[133,13,133,76,1],[134,13,134,76,1],[136,13,136,83,1],[136,83,136,104,1],[136,104,136,106,1],[136,13,136,106,1],[137,13,137,64,1],[137,64,137,79,1],[137,79,137,81,1],[137,13,137,81,1],[138,13,138,64,1],[139,13,139,63,1],[140,9,140,10,1],[144,9,144,10,1],[146,13,146,65,1],[147,13,147,46,1],[148,13,148,64,1],[149,13,149,68,1],[152,13,152,71,1],[153,13,153,86,1],[153,86,153,89,1],[153,89,153,99,1],[153,13,153,99,1],[156,13,156,49,1],[157,13,157,51,1],[158,13,158,75,1],[159,9,159,10,1],[163,9,163,10,1],[165,13,165,65,1],[166,13,166,46,1],[167,13,167,84,1],[168,13,168,68,1],[171,13,171,71,1],[174,13,174,49,1],[175,13,175,51,1],[176,13,176,59,1],[177,9,177,10,1],[181,9,181,10,1],[183,13,183,65,1],[184,13,184,46,1],[185,13,185,72,1],[186,13,186,72,1],[187,13,187,75,1],[188,13,188,68,1],[191,13,191,99,1],[192,13,192,79,1],[193,13,193,84,1],[194,13,194,96,1],[194,96,194,99,1],[194,99,194,109,1],[194,13,194,109,1],[197,13,197,59,1],[198,13,198,61,1],[199,13,199,51,1],[200,13,200,52,1],[201,13,201,54,1],[202,13,202,77,1],[203,13,203,49,1],[203,49,203,65,1],[203,65,203,83,1],[203,13,203,83,1],[205,13,205,57,1],[205,57,205,83,1],[205,83,205,85,1],[205,13,205,85,1],[206,13,206,77,1],[207,13,207,78,1],[208,13,208,99,1],[209,13,209,86,1],[211,13,211,74,1],[212,13,212,84,1],[212,84,212,126,1],[212,126,212,139,1],[212,13,212,139,1],[213,9,213,10,1],[217,9,217,10,1],[219,13,219,65,1],[220,13,220,46,1],[221,13,221,72,1],[222,13,222,72,1],[223,13,223,75,1],[226,13,226,114,1],[227,13,227,94,1],[228,13,228,99,1],[229,13,229,96,1],[229,96,229,99,1],[229,99,229,109,1],[229,13,229,109,1],[232,13,232,39,1],[232,39,232,105,1],[232,105,232,107,1],[232,13,232,107,1],[233,13,233,77,1],[234,13,234,59,1],[235,13,235,61,1],[236,13,236,51,1],[237,9,237,10,1],[241,9,241,10,1],[243,13,243,59,1],[244,13,244,46,1],[245,13,245,72,1],[246,13,246,72,1],[247,13,247,75,1],[250,13,250,114,1],[251,13,251,94,1],[252,13,252,99,1],[253,13,253,96,1],[253,96,253,99,1],[253,99,253,109,1],[253,13,253,109,1],[256,13,256,39,1],[256,39,256,105,1],[256,105,256,107,1],[256,13,256,107,1],[257,13,257,77,1],[258,13,258,59,1],[259,13,259,61,1],[260,13,260,51,1],[261,9,261,10,1],[265,9,265,10,1],[267,13,267,65,1],[268,13,268,46,1],[269,13,269,72,1],[270,13,270,76,1],[271,13,271,66,1],[272,13,272,68,1],[275,13,275,99,1],[276,13,276,85,1],[277,13,277,68,1],[278,13,279,39,1],[279,39,279,76,1],[279,76,280,53,1],[278,13,280,53,1],[283,13,283,48,1],[284,13,284,61,1],[285,13,285,54,1],[286,13,286,50,1],[287,13,287,69,1],[288,9,288,10,1],[292,9,292,10,1],[293,13,293,83,1],[294,9,294,10,1],[298,9,298,10,1],[299,13,299,93,1],[300,9,300,10,1],[303,9,303,10,1],[305,13,305,46,1],[306,13,306,72,1],[307,13,307,76,1],[308,13,308,66,1],[309,13,309,68,1],[312,13,312,99,1],[313,13,313,85,1],[314,13,314,68,1],[315,13,316,39,1],[316,39,316,75,1],[316,75,317,53,1],[315,13,317,53,1],[319,13,319,72,1],[320,13,320,130,1],[322,13,322,89,1],[323,13,323,57,1],[323,57,323,75,1],[323,75,323,77,1],[323,13,323,77,1],[326,13,326,59,1],[327,13,327,61,1],[328,13,328,123,1],[329,13,329,48,1],[330,13,330,54,1],[331,13,331,50,1],[332,13,332,69,1],[333,13,333,51,1],[334,13,334,65,1],[335,9,335,10,1],[339,9,339,10,1],[341,13,341,64,1],[342,13,342,46,1],[343,13,343,72,1],[344,13,344,68,1],[347,13,347,79,1],[348,13,348,94,1],[348,94,348,97,1],[348,97,348,107,1],[348,13,348,107,1],[351,13,351,51,1],[352,13,352,75,1],[353,9,353,10,1],[357,9,357,10,1],[359,13,359,59,1],[360,13,360,57,1],[361,13,361,68,1],[364,13,364,84,1],[367,13,367,54,1],[368,13,368,47,1],[368,47,368,69,1],[368,69,368,82,1],[368,13,368,82,1],[369,13,369,62,1],[370,9,370,10,1],[374,9,374,10,1],[376,13,376,59,1],[377,13,377,57,1],[378,13,378,68,1],[381,13,381,84,1],[382,13,382,61,1],[383,13,383,64,1],[386,13,386,47,1],[387,13,387,63,1],[388,13,388,68,1],[389,13,389,76,1],[390,13,390,63,1],[393,9,393,10,1],[397,9,397,10,1],[399,13,399,59,1],[400,13,400,57,1],[403,13,403,99,1],[404,13,404,106,1],[407,13,407,54,1],[408,13,408,47,1],[408,47,408,69,1],[408,69,408,82,1],[408,13,408,82,1],[409,13,409,62,1],[410,13,410,90,1],[412,13,412,61,1],[413,13,413,54,1],[413,54,413,76,1],[413,76,413,89,1],[413,13,413,89,1],[414,13,414,69,1],[415,13,415,97,1],[416,9,416,10,1],[420,9,420,10,1],[421,13,421,86,1],[422,13,422,98,1],[424,13,424,82,1],[425,13,425,93,1],[426,13,426,68,1],[427,13,427,58,1],[430,13,430,94,1],[430,94,430,97,1],[430,97,430,107,1],[430,13,430,107,1],[431,13,431,79,1],[432,13,432,97,1],[433,13,433,59,1],[436,13,436,51,1],[437,13,437,75,1],[438,13,438,86,1],[439,13,439,78,1],[440,13,440,49,1],[440,49,440,73,1],[440,73,440,130,1],[440,13,440,130,1],[441,9,441,10,1],[445,9,445,10,1],[452,13,452,84,1],[453,13,453,92,1],[455,13,455,28,1],[458,13,458,91,1],[461,13,461,81,1],[462,13,462,83,1],[463,13,463,79,1],[464,13,464,81,1],[465,9,465,10,1],[469,9,469,10,1],[474,13,474,84,1],[475,13,475,92,1],[477,13,477,28,1],[480,13,480,113,1],[483,13,483,136,1],[484,13,484,134,1],[486,13,486,109,1],[487,13,487,107,1],[489,13,489,102,1],[490,13,490,93,1],[491,9,491,10,1],[495,9,495,10,1],[502,13,502,84,1],[503,13,503,92,1],[505,13,505,28,1],[506,13,506,122,1],[509,13,509,91,1],[512,13,512,81,1],[513,13,513,83,1],[514,13,514,79,1],[515,13,515,81,1],[516,9,516,10,1],[520,9,520,10,1],[527,13,527,84,1],[528,13,528,92,1],[530,13,530,28,1],[531,13,531,80,1],[534,13,534,91,1],[537,13,537,81,1],[538,13,538,83,1],[539,13,539,79,1],[540,13,540,81,1],[541,9,541,10,1],[545,9,545,10,1],[547,13,547,84,1],[548,13,548,84,1],[551,13,551,99,1],[552,13,552,85,1],[555,13,555,44,1],[555,44,555,66,1],[555,66,555,79,1],[555,13,555,79,1],[556,13,556,20,1],[556,22,556,34,1],[556,35,556,37,1],[556,38,556,47,1],[557,13,557,14,1],[558,17,558,51,1],[558,51,558,80,1],[558,80,558,92,1],[558,17,558,92,1],[559,13,559,14,1],[560,9,560,10,1],[564,9,564,10,1],[566,13,566,61,1],[567,13,567,46,1],[568,13,568,67,1],[569,13,569,68,1],[572,13,572,80,1],[575,13,575,48,1],[577,13,577,75,1],[578,13,578,20,1],[578,22,578,31,1],[578,32,578,34,1],[578,35,578,41,1],[579,13,579,14,1],[580,17,580,48,1],[580,48,580,70,1],[580,70,580,82,1],[580,17,580,82,1],[581,13,581,14,1],[582,9,582,10,1],[586,9,586,10,1],[588,13,588,64,1],[589,13,589,46,1],[590,13,590,67,1],[591,13,591,68,1],[594,13,594,80,1],[597,13,597,48,1],[598,13,598,67,1],[600,13,600,75,1],[601,13,601,20,1],[601,22,601,31,1],[601,32,601,34,1],[601,35,601,41,1],[602,13,602,14,1],[603,17,603,48,1],[603,48,603,70,1],[603,70,603,82,1],[603,17,603,82,1],[604,13,604,14,1],[605,9,605,10,1],[609,9,609,10,1],[611,13,611,69,1],[612,13,612,46,1],[613,13,613,72,1],[614,13,614,75,1],[615,13,615,68,1],[618,13,618,79,1],[619,13,619,84,1],[620,13,620,96,1],[620,96,620,99,1],[620,99,620,109,1],[620,13,620,109,1],[623,13,623,52,1],[624,13,624,54,1],[625,13,625,77,1],[626,13,626,49,1],[626,49,626,65,1],[626,65,626,83,1],[626,13,626,83,1],[628,13,628,52,1],[628,52,628,82,1],[628,82,628,84,1],[628,13,628,84,1],[629,13,629,64,1],[630,13,630,81,1],[631,13,631,86,1],[632,13,632,81,1],[633,13,633,80,1],[634,9,634,10,1],[638,9,638,10,1],[640,13,640,76,1],[641,13,641,46,1],[642,13,642,75,1],[643,13,643,68,1],[646,13,646,84,1],[647,13,647,96,1],[647,96,647,99,1],[647,99,647,109,1],[647,13,647,109,1],[650,13,650,52,1],[651,13,651,54,1],[652,13,652,77,1],[654,13,654,59,1],[654,59,654,90,1],[654,90,654,92,1],[654,13,654,92,1],[655,13,655,88,1],[656,13,656,91,1],[657,13,657,88,1],[658,13,658,87,1],[659,9,659,10,1],[662,9,662,10,1],[663,13,663,63,1],[664,13,664,61,1],[665,13,665,67,1],[666,13,666,65,1],[667,9,667,10,1],[670,9,670,10,1],[671,13,671,124,1],[672,13,672,97,1],[673,13,673,80,1],[673,80,673,113,1],[673,113,673,115,1],[673,13,673,115,1],[674,13,674,92,1],[675,13,675,43,1],[676,13,676,92,1],[677,9,677,10,1],[680,9,680,10,1],[681,13,681,91,1],[682,13,682,57,1],[682,57,682,77,1],[682,77,682,79,1],[682,13,682,79,1],[683,13,691,15,1],[692,9,692,10,1],[695,9,695,10,1],[696,13,696,91,1],[697,13,697,57,1],[697,57,697,77,1],[697,77,697,79,1],[697,13,697,79,1],[698,13,698,59,1],[698,59,698,79,1],[698,79,698,81,1],[698,13,698,81,1],[699,13,708,15,1],[709,9,709,10,1]]);
    </script>
  </body>
</html>