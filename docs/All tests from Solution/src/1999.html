<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Models\MemberType.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Reflection;
using System.Runtime.Serialization;

namespace Umbraco.Core.Models
{
    /// &lt;summary&gt;
    /// Represents the content type that a &lt;see cref=&quot;Member&quot;/&gt; object is based on
    /// &lt;/summary&gt;
    [Serializable]
    [DataContract(IsReference = true)]
    public class MemberType : ContentTypeCompositionBase, IMemberType
    {
        //Dictionary is divided into string: PropertyTypeAlias, Tuple: MemberCanEdit, VisibleOnProfile, PropertyTypeId
        private string _alias;

        public MemberType(int parentId) : base(parentId)
        {
            MemberTypePropertyTypes = new Dictionary&lt;string, MemberTypePropertyProfileAccess&gt;();
        }

        public MemberType(IContentTypeComposition parent) : this(parent, null)
        {
        }

        public MemberType(IContentTypeComposition parent, string alias)
            : base(parent, alias)
        {
            MemberTypePropertyTypes = new Dictionary&lt;string, MemberTypePropertyProfileAccess&gt;();
        }

        private static readonly Lazy&lt;PropertySelectors&gt; Ps = new Lazy&lt;PropertySelectors&gt;();

        private class PropertySelectors
        {
            public readonly PropertyInfo AliasSelector = ExpressionHelper.GetPropertyInfo&lt;MemberType, string&gt;(x =&gt; x.Alias);
        }

        /// &lt;summary&gt;
        /// The Alias of the ContentType
        /// &lt;/summary&gt;
        [DataMember]
        public override string Alias
        {
            get { return _alias; }
            set
            {
                //NOTE: WE are overriding this because we don&#39;t want to do a ToSafeAlias when the alias is the special case of
                // &quot;_umbracoSystemDefaultProtectType&quot; which is used internally, currently there is an issue with the safe alias as it strips
                // leading underscores which we don&#39;t want in this case.
                // see : http://issues.umbraco.org/issue/U4-3968

                //TODO: BUT, I&#39;m pretty sure we could do this with regards to underscores now:
                // .ToCleanString(CleanStringType.Alias | CleanStringType.UmbracoCase)
                // Need to ask Stephen

                var newVal = value == &quot;_umbracoSystemDefaultProtectType&quot;
                        ? value
                        : (value == null ? string.Empty : value.ToSafeAlias());

                SetPropertyValueAndDetectChanges(newVal, ref _alias, Ps.Value.AliasSelector);
            }
        }

        /// &lt;summary&gt;
        /// Gets or Sets a Dictionary of Tuples (MemberCanEdit, VisibleOnProfile) by the PropertyTypes&#39; alias.
        /// &lt;/summary&gt;
        [DataMember]
        internal IDictionary&lt;string, MemberTypePropertyProfileAccess&gt; MemberTypePropertyTypes { get; private set; }

        /// &lt;summary&gt;
        /// Gets a boolean indicating whether a Property is editable by the Member.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;propertyTypeAlias&quot;&gt;PropertyType Alias of the Property to check&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool MemberCanEditProperty(string propertyTypeAlias)
        {
            if (MemberTypePropertyTypes.ContainsKey(propertyTypeAlias))
            {
                return MemberTypePropertyTypes[propertyTypeAlias].IsEditable;
            }

            return false;
        }

        /// &lt;summary&gt;
        /// Gets a boolean indicating whether a Property is visible on the Members profile.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;propertyTypeAlias&quot;&gt;PropertyType Alias of the Property to check&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool MemberCanViewProperty(string propertyTypeAlias)
        {
            if (MemberTypePropertyTypes.ContainsKey(propertyTypeAlias))
            {
                return MemberTypePropertyTypes[propertyTypeAlias].IsVisible;
            }

            return false;
        }

        /// &lt;summary&gt;
        /// Sets a boolean indicating whether a Property is editable by the Member.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;propertyTypeAlias&quot;&gt;PropertyType Alias of the Property to set&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;Boolean value, true or false&lt;/param&gt;
        public void SetMemberCanEditProperty(string propertyTypeAlias, bool value)
        {
            if (MemberTypePropertyTypes.ContainsKey(propertyTypeAlias))
            {
                MemberTypePropertyTypes[propertyTypeAlias].IsEditable = value;
            }
            else
            {
                var tuple = new MemberTypePropertyProfileAccess(false, value);
                MemberTypePropertyTypes.Add(propertyTypeAlias, tuple);
            }
        }

        /// &lt;summary&gt;
        /// Sets a boolean indicating whether a Property is visible on the Members profile.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;propertyTypeAlias&quot;&gt;PropertyType Alias of the Property to set&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;Boolean value, true or false&lt;/param&gt;
        public void SetMemberCanViewProperty(string propertyTypeAlias, bool value)
        {
            if (MemberTypePropertyTypes.ContainsKey(propertyTypeAlias))
            {
                MemberTypePropertyTypes[propertyTypeAlias].IsVisible = value;
            }
            else
            {
                var tuple = new MemberTypePropertyProfileAccess(value, false);
                MemberTypePropertyTypes.Add(propertyTypeAlias, tuple);
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,43,18,57,1],[19,9,19,10,1],[20,13,20,97,1],[21,9,21,10,1],[23,61,23,79,0],[24,9,24,10,0],[25,9,25,10,0],[28,15,28,34,0],[29,9,29,10,0],[30,13,30,97,0],[31,9,31,10,0],[33,9,33,92,1],[37,13,37,125,1],[46,17,46,18,1],[46,19,46,33,1],[46,34,46,35,1],[48,13,48,14,1],[58,17,60,80,1],[62,17,62,94,1],[63,13,63,14,1],[70,97,70,101,1],[70,102,70,114,1],[78,9,78,10,1],[79,13,79,72,1],[80,13,80,14,1],[81,17,81,78,1],[84,13,84,26,1],[85,9,85,10,1],[93,9,93,10,1],[94,13,94,72,1],[95,13,95,14,1],[96,17,96,77,1],[99,13,99,26,1],[100,9,100,10,1],[108,9,108,10,1],[109,13,109,72,1],[110,13,110,14,0],[111,17,111,79,0],[112,13,112,14,0],[114,13,114,14,1],[115,17,115,79,1],[116,17,116,71,1],[117,13,117,14,1],[118,9,118,10,1],[126,9,126,10,1],[127,13,127,72,1],[128,13,128,14,1],[129,17,129,78,1],[130,13,130,14,1],[132,13,132,14,1],[133,17,133,79,1],[134,17,134,71,1],[135,13,135,14,1],[136,9,136,10,1]]);
    </script>
  </body>
</html>