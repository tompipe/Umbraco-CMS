<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Persistence\Migrations\Syntax\Update\Expressions\UpdateDataExpression.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using Umbraco.Core.Persistence.SqlSyntax;

namespace Umbraco.Core.Persistence.Migrations.Syntax.Update.Expressions
{
    public class UpdateDataExpression : MigrationExpressionBase
    {
        public UpdateDataExpression(DatabaseProviders current, DatabaseProviders[] databaseProviders, ISqlSyntaxProvider sqlSyntax) 
            : base(current, databaseProviders, sqlSyntax)
        {
        }

        public string SchemaName { get; set; }
        public string TableName { get; set; }

        public List&lt;KeyValuePair&lt;string, object&gt;&gt; Set { get; set; }
        public List&lt;KeyValuePair&lt;string, object&gt;&gt; Where { get; set; }
        public bool IsAllRows { get; set; }

        public override string ToString()
        {
            if (IsExpressionSupported() == false)
                return string.Empty;

            var updateItems = new List&lt;string&gt;();
            var whereClauses = new List&lt;string&gt;();

            foreach (var item in Set)
            {
                updateItems.Add(string.Format(&quot;{0} = {1}&quot;,
                                              SqlSyntax.GetQuotedColumnName(item.Key),
                                              GetQuotedValue(item.Value)));
            }

            if (IsAllRows)
            {
                whereClauses.Add(&quot;1 = 1&quot;);
            }
            else
            {
                foreach (var item in Where)
                {
                    whereClauses.Add(string.Format(&quot;{0} {1} {2}&quot;,
                                                   SqlSyntax.GetQuotedColumnName(item.Key),
                                                   item.Value == null ? &quot;IS&quot; : &quot;=&quot;,
                                                   GetQuotedValue(item.Value)));
                }
            }
            return string.Format(SqlSyntax.UpdateData,
                                 SqlSyntax.GetQuotedTableName(TableName),
                                 string.Join(&quot;, &quot;, updateItems.ToArray()), 
                                 string.Join(&quot; AND &quot;, whereClauses.ToArray()));
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,15,9,58,0],[10,9,10,10,0],[11,9,11,10,0],[13,36,13,40,0],[13,41,13,45,0],[14,35,14,39,0],[14,40,14,44,0],[16,57,16,61,0],[16,62,16,66,0],[17,59,17,63,0],[17,64,17,68,0],[18,33,18,37,0],[18,38,18,42,0],[21,9,21,10,0],[22,13,22,50,0],[23,17,23,37,0],[25,13,25,50,0],[26,13,26,51,0],[28,13,28,20,0],[28,22,28,30,0],[28,31,28,33,0],[28,34,28,37,0],[29,13,29,14,0],[30,17,32,76,0],[33,13,33,14,0],[35,13,35,27,0],[36,13,36,14,0],[37,17,37,43,0],[38,13,38,14,0],[40,13,40,14,0],[41,17,41,24,0],[41,26,41,34,0],[41,35,41,37,0],[41,38,41,43,0],[42,17,42,18,0],[43,21,46,81,0],[47,17,47,18,0],[48,13,48,14,0],[49,13,52,80,0],[53,9,53,10,0]]);
    </script>
  </body>
</html>