<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\TestHelpers\Entities\MockedUser.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using Umbraco.Core.Models;
using Umbraco.Core.Models.Membership;

namespace Umbraco.Tests.TestHelpers.Entities
{
    public class MockedUser
    {
        internal static User CreateUser(IUserType userType = null, string suffix = &quot;&quot;, params string[] allowedSections)
        {
            if (userType == null)
            {
                userType = MockedUserType.CreateUserType();
            }

            var user = new User(userType)
                {
                    Language = &quot;en&quot;,
                    IsApproved = true,
                    Name = &quot;TestUser&quot; + suffix,
                    RawPasswordValue = &quot;testing&quot;,
                    IsLockedOut = false,
                    DefaultPermissions = new[]{&quot;A&quot;, &quot;B&quot;, &quot;C&quot;},
                    StartContentId = -1,
                    StartMediaId = -1,
                    Email = &quot;test&quot; + suffix + &quot;@test.com&quot;,
                    Username = &quot;TestUser&quot; + suffix
                };

            if (allowedSections.Any())
            {
                foreach (var s in allowedSections)
                {
                    user.AddAllowedSection(s);
                }
            }
            else
            {
                user.AddAllowedSection(&quot;content&quot;);
                user.AddAllowedSection(&quot;media&quot;);    
            }

            return user;
        }

        internal static IEnumerable&lt;IUser&gt; CreateUser(IUserType userType, int amount, Action&lt;int, IUser&gt; onCreating = null)
        {
            var list = new List&lt;IUser&gt;();

            for (int i = 0; i &lt; amount; i++)
            {
                var name = &quot;Member No-&quot; + i;
                var user = new User(name, &quot;test&quot; + i + &quot;@test.com&quot;, &quot;test&quot; + i, &quot;test&quot; + i, userType);
                
                if (onCreating != null)
                {
                    onCreating(i, user);
                }

                user.ResetDirtyProperties(false);

                list.Add(user);
            }

            return list;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,9,12,10,1],[13,13,13,34,1],[14,13,14,14,0],[15,17,15,60,0],[16,13,16,14,0],[18,13,30,19,1],[32,13,32,39,1],[33,13,33,14,1],[34,17,34,24,1],[34,26,34,31,1],[34,32,34,34,1],[34,35,34,50,1],[35,17,35,18,1],[36,21,36,47,1],[37,17,37,18,1],[38,13,38,14,1],[40,13,40,14,1],[41,17,41,51,1],[42,17,42,49,1],[43,13,43,14,1],[45,13,45,25,1],[46,9,46,10,1],[49,9,49,10,1],[50,13,50,42,1],[52,18,52,27,1],[52,29,52,39,1],[52,41,52,44,1],[53,13,53,14,1],[54,17,54,45,1],[55,17,55,103,1],[57,17,57,40,1],[58,17,58,18,1],[59,21,59,41,1],[60,17,60,18,1],[62,17,62,50,1],[64,17,64,32,1],[65,13,65,14,1],[67,13,67,25,1],[68,9,68,10,1]]);
    </script>
  </body>
</html>