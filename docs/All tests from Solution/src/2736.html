<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\imagecropper\SaveData.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Xml;

namespace umbraco.editorControls.imagecropper
{
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class SaveData
    {
        public ArrayList data { get; set; }

        public string Xml(Config config, ImageInfo imageInfo)
        {
            XmlDocument doc = createBaseXmlDocument();
            XmlNode root = doc.DocumentElement;

            if (root == null) return null;

            XmlNode dateStampNode = doc.CreateNode(XmlNodeType.Attribute, &quot;date&quot;, null);
            dateStampNode.Value = imageInfo.DateStamp.ToString(&quot;s&quot;);
            root.Attributes.SetNamedItem(dateStampNode);

            for (int i = 0; i &lt; data.Count; i++)
            {
                Crop crop = (Crop) data[i];
                Preset preset = (Preset) config.presets[i];

                XmlNode newNode = doc.CreateElement(&quot;crop&quot;);

                XmlNode nameNode = doc.CreateNode(XmlNodeType.Attribute, &quot;name&quot;, null);
                nameNode.Value = preset.Name;
                newNode.Attributes.SetNamedItem(nameNode);

                XmlNode xNode = doc.CreateNode(XmlNodeType.Attribute, &quot;x&quot;, null);
                xNode.Value = crop.X.ToString();
                newNode.Attributes.SetNamedItem(xNode);

                XmlNode yNode = doc.CreateNode(XmlNodeType.Attribute, &quot;y&quot;, null);
                yNode.Value = crop.Y.ToString();
                newNode.Attributes.SetNamedItem(yNode);

                XmlNode x2Node = doc.CreateNode(XmlNodeType.Attribute, &quot;x2&quot;, null);
                x2Node.Value = crop.X2.ToString();
                newNode.Attributes.SetNamedItem(x2Node);

                XmlNode y2Node = doc.CreateNode(XmlNodeType.Attribute, &quot;y2&quot;, null);
                y2Node.Value = crop.Y2.ToString();
                newNode.Attributes.SetNamedItem(y2Node);

                if (config.GenerateImages)
                {
                    XmlNode urlNode = doc.CreateNode(XmlNodeType.Attribute, &quot;url&quot;, null);
                    urlNode.Value = String.Format(&quot;{0}/{1}_{2}.jpg&quot;,
                                                  imageInfo.RelativePath.Substring(0,
                                                                                   imageInfo.RelativePath.LastIndexOf(
                                                                                       &#39;/&#39;)),
                                                  imageInfo.Name,
                                                  preset.Name);
                    newNode.Attributes.SetNamedItem(urlNode);
                }

                root.AppendChild(newNode);
            }

            return doc.InnerXml;
        }

        public SaveData()
        {
            data = new ArrayList();
        }

        public SaveData(string raw)
        {
            data = new ArrayList();

            string[] crops = raw.Split(&#39;;&#39;);

            foreach (string crop in crops)
            {
                var val = crop.Split(&#39;,&#39;);

                data.Add(
                    new Crop(
                        Convert.ToInt32(val[0]),
                        Convert.ToInt32(val[1]),
                        Convert.ToInt32(val[2]),
                        Convert.ToInt32(val[3])
                        )
                    );
            }

        }

        private static XmlDocument createBaseXmlDocument()
        {
            XmlDocument doc = new XmlDocument();
            XmlNode root = doc.CreateElement(&quot;crops&quot;);
            doc.AppendChild(root);
            return doc;
        }


    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[10,33,10,37,0],[10,38,10,42,0],[13,9,13,10,0],[14,13,14,55,0],[15,13,15,48,0],[17,13,17,30,0],[17,31,17,43,0],[19,13,19,89,0],[20,13,20,69,0],[21,13,21,57,0],[23,18,23,27,0],[23,29,23,43,0],[23,45,23,48,0],[24,13,24,14,0],[25,17,25,44,0],[26,17,26,60,0],[28,17,28,61,0],[30,17,30,88,0],[31,17,31,46,0],[32,17,32,59,0],[34,17,34,82,0],[35,17,35,49,0],[36,17,36,56,0],[38,17,38,82,0],[39,17,39,49,0],[40,17,40,56,0],[42,17,42,84,0],[43,17,43,51,0],[44,17,44,57,0],[46,17,46,84,0],[47,17,47,51,0],[48,17,48,57,0],[50,17,50,43,0],[51,17,51,18,0],[52,21,52,90,0],[53,21,58,64,0],[59,21,59,62,0],[60,17,60,18,0],[62,17,62,43,0],[63,13,63,14,0],[65,13,65,33,0],[66,9,66,10,0],[68,9,68,26,0],[69,9,69,10,0],[70,13,70,36,0],[71,9,71,10,0],[73,9,73,36,0],[74,9,74,10,0],[75,13,75,36,0],[77,13,77,45,0],[79,13,79,20,0],[79,22,79,33,0],[79,34,79,36,0],[79,37,79,42,0],[80,13,80,14,0],[81,17,81,43,0],[83,17,90,23,0],[91,13,91,14,0],[93,9,93,10,0],[96,9,96,10,0],[97,13,97,49,0],[98,13,98,55,0],[99,13,99,35,0],[100,13,100,24,0],[101,9,101,10,0]]);
    </script>
  </body>
</html>