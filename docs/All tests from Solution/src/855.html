<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\PublishedCache\MemberPublishedContent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Web.Security;
using Umbraco.Core;
using Umbraco.Core.Dynamics;
using Umbraco.Core.Models;
using Umbraco.Core.Models.Membership;
using Umbraco.Core.Models.PublishedContent;
using Umbraco.Core.PropertyEditors;
using Umbraco.Core.Services;
using Umbraco.Web.Models;

namespace Umbraco.Web.PublishedCache
{
    /// &lt;summary&gt;
    /// Exposes a member object as IPublishedContent
    /// &lt;/summary&gt;
    public sealed class MemberPublishedContent : PublishedContentWithKeyBase
    {

        private readonly IMember _member;
        private readonly IMembershipUser _membershipUser;
        private readonly IPublishedProperty[] _properties;
        private readonly PublishedContentType _publishedMemberType;

        public MemberPublishedContent(IMember member)
        {
            if (member == null) throw new ArgumentNullException(&quot;member&quot;);            

            _member = member;
            _membershipUser = member;
            _publishedMemberType = PublishedContentType.Get(PublishedItemType.Member, _member.ContentTypeAlias);
            if (_publishedMemberType == null)
            {
                throw new InvalidOperationException(&quot;Could not get member type with alias &quot; + _member.ContentTypeAlias);
            }

            _properties = PublishedProperty.MapProperties(_publishedMemberType.PropertyTypes, _member.Properties,
                (t, v) =&gt; new RawValueProperty(t, v ?? string.Empty))
                .ToArray();
        }


        #region Membership provider member properties
        public string Email
        {
            get { return _membershipUser.Email; }
        }
        public string UserName
        {
            get { return _membershipUser.Username; }
        }
        public string PasswordQuestion
        {
            get { return _membershipUser.PasswordQuestion; }
        }
        public string Comments
        {
            get { return _membershipUser.Comments; }
        }
        public bool IsApproved
        {
            get { return _membershipUser.IsApproved; }
        }
        public bool IsLockedOut
        {
            get { return _membershipUser.IsLockedOut; }
        }
        public DateTime LastLockoutDate
        {
            get { return _membershipUser.LastLockoutDate; }
        }
        public DateTime CreationDate
        {
            get { return _membershipUser.CreateDate; }
        }
        public DateTime LastLoginDate
        {
            get { return _membershipUser.LastLoginDate; }
        }
        public DateTime LastActivityDate
        {
            get { return _membershipUser.LastLoginDate; }
        }
        public DateTime LastPasswordChangedDate
        {
            get { return _membershipUser.LastPasswordChangeDate; }
        } 
        #endregion

        #region IPublishedContent
        public override PublishedItemType ItemType
        {
            get { return PublishedItemType.Member; }
        }

        public override bool IsDraft
        {
            get { return false; }
        }

        public override IPublishedContent Parent
        {
            get { return null; }
        }

        public override IEnumerable&lt;IPublishedContent&gt; Children
        {
            get { return Enumerable.Empty&lt;IPublishedContent&gt;(); }
        }

        public override ICollection&lt;IPublishedProperty&gt; Properties
        {
            get { return _properties; }
        }

        public override IPublishedProperty GetProperty(string alias, bool recurse)
        {
            if (recurse)
            {
                throw new NotSupportedException();
            }
            return GetProperty(alias);
        }

        public override IPublishedProperty GetProperty(string alias)
        {
            switch (alias)
            {
                case &quot;Email&quot;:
                    return new PropertyResult(&quot;Email&quot;, Email, PropertyResultType.CustomProperty);
                case &quot;UserName&quot;:
                    return new PropertyResult(&quot;UserName&quot;, UserName, PropertyResultType.CustomProperty);
            }

            return _properties.FirstOrDefault(x =&gt; x.PropertyTypeAlias.InvariantEquals(alias));
        }

        public override PublishedContentType ContentType
        {
            get { return _publishedMemberType; }
        }

        public override int Id
        {
            get { return _member.Id; }
        }

        public override Guid Key
        {
            get { return _member.Key; }
        }

        public override int TemplateId
        {
            get { throw new NotSupportedException(); }
        }

        public override int SortOrder
        {
            get { return 0; }
        }

        public override string Name
        {
            get { return _member.Name; }
        }

        public override string UrlName
        {
            get { throw new NotSupportedException(); }
        }

        public override string DocumentTypeAlias
        {
            get { return _member.ContentTypeAlias; }
        }

        public override int DocumentTypeId
        {
            get { return _member.ContentType.Id; }
        }

        public override string WriterName
        {
            get { return _member.GetCreatorProfile().Name; }
        }

        public override string CreatorName
        {
            get { return _member.GetCreatorProfile().Name; }
        }

        public override int WriterId
        {
            get { return _member.CreatorId; }
        }

        public override int CreatorId
        {
            get { return _member.CreatorId; }
        }

        public override string Path
        {
            get { return _member.Path; }
        }

        public override DateTime CreateDate
        {
            get { return _member.CreateDate; }
        }

        public override DateTime UpdateDate
        {
            get { return _member.UpdateDate; }
        }

        public override Guid Version
        {
            get { return _member.Version; }
        }

        public override int Level
        {
            get { return _member.Level; }
        } 
        #endregion
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[30,9,30,54,1],[31,9,31,10,1],[32,13,32,32,1],[32,33,32,75,0],[34,13,34,30,1],[35,13,35,38,1],[36,13,36,113,1],[37,13,37,46,1],[38,13,38,14,0],[39,17,39,121,0],[42,13,43,27,1],[43,27,43,69,1],[43,69,44,28,1],[42,13,44,28,1],[45,9,45,10,1],[51,17,51,18,1],[51,19,51,48,1],[51,49,51,50,1],[55,17,55,18,1],[55,19,55,51,1],[55,52,55,53,1],[59,17,59,18,1],[59,19,59,59,1],[59,60,59,61,1],[63,17,63,18,1],[63,19,63,51,1],[63,52,63,53,1],[67,17,67,18,1],[67,19,67,53,1],[67,54,67,55,1],[71,17,71,18,1],[71,19,71,54,1],[71,55,71,56,1],[75,17,75,18,1],[75,19,75,58,1],[75,59,75,60,1],[79,17,79,18,1],[79,19,79,53,1],[79,54,79,55,1],[83,17,83,18,1],[83,19,83,56,1],[83,57,83,58,1],[87,17,87,18,1],[87,19,87,56,1],[87,57,87,58,1],[91,17,91,18,1],[91,19,91,65,1],[91,66,91,67,1],[98,17,98,18,0],[98,19,98,51,0],[98,52,98,53,0],[103,17,103,18,0],[103,19,103,32,0],[103,33,103,34,0],[108,17,108,18,0],[108,19,108,31,0],[108,32,108,33,0],[113,17,113,18,1],[113,19,113,64,1],[113,65,113,66,1],[118,17,118,18,0],[118,19,118,38,0],[118,39,118,40,0],[122,9,122,10,1],[123,13,123,25,1],[124,13,124,14,0],[125,17,125,51,0],[127,13,127,39,1],[128,9,128,10,1],[131,9,131,10,1],[132,13,132,27,1],[135,21,135,98,1],[137,21,137,104,1],[140,13,140,52,1],[140,52,140,94,1],[140,94,140,96,1],[140,13,140,96,1],[141,9,141,10,1],[145,17,145,18,0],[145,19,145,47,0],[145,48,145,49,0],[150,17,150,18,0],[150,19,150,37,0],[150,38,150,39,0],[155,17,155,18,0],[155,19,155,38,0],[155,39,155,40,0],[160,17,160,18,0],[160,19,160,53,0],[165,17,165,18,0],[165,19,165,28,0],[165,29,165,30,0],[170,17,170,18,1],[170,19,170,39,1],[170,40,170,41,1],[175,17,175,18,0],[175,19,175,53,0],[180,17,180,18,0],[180,19,180,51,0],[180,52,180,53,0],[185,17,185,18,0],[185,19,185,49,0],[185,50,185,51,0],[190,17,190,18,0],[190,19,190,59,0],[190,60,190,61,0],[195,17,195,18,0],[195,19,195,59,0],[195,60,195,61,0],[200,17,200,18,0],[200,19,200,44,0],[200,45,200,46,0],[205,17,205,18,0],[205,19,205,44,0],[205,45,205,46,0],[210,17,210,18,0],[210,19,210,39,0],[210,40,210,41,0],[215,17,215,18,0],[215,19,215,45,0],[215,46,215,47,0],[220,17,220,18,0],[220,19,220,45,0],[220,46,220,47,0],[225,17,225,18,0],[225,19,225,42,0],[225,43,225,44,0],[230,17,230,18,0],[230,19,230,40,0],[230,41,230,42,0]]);
    </script>
  </body>
</html>