<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Services\MemberGroupService.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using Umbraco.Core.Events;
using Umbraco.Core.Logging;
using Umbraco.Core.Models;
using Umbraco.Core.Persistence;
using Umbraco.Core.Persistence.Querying;
using Umbraco.Core.Persistence.Repositories;
using Umbraco.Core.Persistence.UnitOfWork;

namespace Umbraco.Core.Services
{
    public class MemberGroupService : RepositoryService, IMemberGroupService
    {

        public MemberGroupService(IDatabaseUnitOfWorkProvider provider, RepositoryFactory repositoryFactory, ILogger logger, IEventMessagesFactory eventMessagesFactory)
            : base(provider, repositoryFactory, logger, eventMessagesFactory)
        {
            //Proxy events!
            MemberGroupRepository.SavedMemberGroup += MemberGroupRepository_SavedMemberGroup;
            MemberGroupRepository.SavingMemberGroup += MemberGroupRepository_SavingMemberGroup;
        }

        #region Proxied event handlers
        void MemberGroupRepository_SavingMemberGroup(IMemberGroupRepository sender, SaveEventArgs&lt;IMemberGroup&gt; e)
        {
            if (Saving.IsRaisedEventCancelled(new SaveEventArgs&lt;IMemberGroup&gt;(e.SavedEntities), this))
            {
                e.Cancel = true;
            }
        }

        void MemberGroupRepository_SavedMemberGroup(IMemberGroupRepository sender, SaveEventArgs&lt;IMemberGroup&gt; e)
        {
            Saved.RaiseEvent(new SaveEventArgs&lt;IMemberGroup&gt;(e.SavedEntities, false), this);
        } 
        #endregion

        public IEnumerable&lt;IMemberGroup&gt; GetAll()
        {
            using (var repository = RepositoryFactory.CreateMemberGroupRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetAll();
            }
        }

        public IMemberGroup GetById(int id)
        {
            using (var repository = RepositoryFactory.CreateMemberGroupRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.Get(id);
            }
        }

        public IMemberGroup GetByName(string name)
        {
            using (var repository = RepositoryFactory.CreateMemberGroupRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetByName(name);
            }
        }

        public void Save(IMemberGroup memberGroup, bool raiseEvents = true)
        {
            if (raiseEvents)
            {
                if (Saving.IsRaisedEventCancelled(new SaveEventArgs&lt;IMemberGroup&gt;(memberGroup), this))
                {
                    return;
                }
            }

            var uow = UowProvider.GetUnitOfWork();
            using (var repository = RepositoryFactory.CreateMemberGroupRepository(uow))
            {
                repository.AddOrUpdate(memberGroup);
                uow.Commit();
            }

            if (raiseEvents)
                Saved.RaiseEvent(new SaveEventArgs&lt;IMemberGroup&gt;(memberGroup, false), this);
        }

        public void Delete(IMemberGroup memberGroup)
        {
            if (Deleting.IsRaisedEventCancelled(new DeleteEventArgs&lt;IMemberGroup&gt;(memberGroup), this))
                return;

            var uow = UowProvider.GetUnitOfWork();
            using (var repository = RepositoryFactory.CreateMemberGroupRepository(uow))
            {
                repository.Delete(memberGroup);
                uow.Commit();
            }

            Deleted.RaiseEvent(new DeleteEventArgs&lt;IMemberGroup&gt;(memberGroup, false), this);
        }

        /// &lt;summary&gt;
        /// Occurs before Delete of a member group
        /// &lt;/summary&gt;
        public static event TypedEventHandler&lt;IMemberGroupService, DeleteEventArgs&lt;IMemberGroup&gt;&gt; Deleting;

        /// &lt;summary&gt;
        /// Occurs after Delete of a member group
        /// &lt;/summary&gt;
        public static event TypedEventHandler&lt;IMemberGroupService, DeleteEventArgs&lt;IMemberGroup&gt;&gt; Deleted;

        /// &lt;summary&gt;
        /// Occurs before Save of a member group
        /// &lt;/summary&gt;     
        /// &lt;remarks&gt;
        /// We need to proxy these events because the events need to take place at the repo level
        /// &lt;/remarks&gt;
        public static event TypedEventHandler&lt;IMemberGroupService, SaveEventArgs&lt;IMemberGroup&gt;&gt; Saving;

        /// &lt;summary&gt;
        /// Occurs after Save of a member group
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// We need to proxy these events because the events need to take place at the repo level
        /// &lt;/remarks&gt;
        public static event TypedEventHandler&lt;IMemberGroupService, SaveEventArgs&lt;IMemberGroup&gt;&gt; Saved;
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,15,18,78,1],[19,9,19,10,1],[21,13,21,94,1],[22,13,22,96,1],[23,9,23,10,1],[27,9,27,10,1],[28,13,28,103,1],[29,13,29,14,0],[30,17,30,33,0],[31,13,31,14,0],[32,9,32,10,1],[35,9,35,10,1],[36,13,36,93,1],[37,9,37,10,1],[41,9,41,10,0],[42,20,42,111,0],[43,13,43,14,0],[44,17,44,44,0],[46,9,46,10,0],[49,9,49,10,0],[50,20,50,111,0],[51,13,51,14,0],[52,17,52,43,0],[54,9,54,10,0],[57,9,57,10,0],[58,20,58,111,0],[59,13,59,14,0],[60,17,60,51,0],[62,9,62,10,0],[65,9,65,10,0],[66,13,66,29,0],[67,13,67,14,0],[68,17,68,103,0],[69,17,69,18,0],[70,21,70,28,0],[72,13,72,14,0],[74,13,74,51,0],[75,20,75,87,0],[76,13,76,14,0],[77,17,77,53,0],[78,17,78,30,0],[79,13,79,14,0],[81,13,81,29,0],[82,17,82,93,0],[83,9,83,10,0],[86,9,86,10,1],[87,13,87,103,1],[88,17,88,24,0],[90,13,90,51,1],[91,20,91,87,1],[92,13,92,14,1],[93,17,93,48,1],[94,17,94,30,1],[95,13,95,14,1],[97,13,97,93,1],[98,9,98,10,1]]);
    </script>
  </body>
</html>