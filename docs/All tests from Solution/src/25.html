<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\TreesAndSections\ApplicationTreeTest.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.IO;
using NUnit.Framework;
using Umbraco.Core.Services;
using Umbraco.Tests.TestHelpers;
using System;
using System.Linq;
using ApplicationTree = umbraco.BusinessLogic.ApplicationTree;

namespace Umbraco.Tests.TreesAndSections
{
    
    
    /// &lt;summary&gt;
    ///This is a test class for ApplicationTreeTest and is intended
    ///to contain all ApplicationTreeTest Unit Tests
    ///&lt;/summary&gt;
    [DatabaseTestBehavior(DatabaseBehavior.NewDbFileAndSchemaPerFixture)]
    [TestFixture, RequiresSTA]
    public class ApplicationTreeTest : BaseDatabaseFactoryTest
    {
        [SetUp]
        public override void Initialize()
        {
            base.Initialize();

            var treesConfig = TestHelper.MapPathForTest(&quot;~/TEMP/TreesAndSections/trees.config&quot;);
            var appConfig = TestHelper.MapPathForTest(&quot;~/TEMP/TreesAndSections/applications.config&quot;);
            Directory.CreateDirectory(TestHelper.MapPathForTest(&quot;~/TEMP/TreesAndSections&quot;));
            using (var writer = File.CreateText(treesConfig))
            {
                writer.Write(ResourceFiles.trees);
            }
            using (var writer = File.CreateText(appConfig))
            {
                writer.Write(ResourceFiles.applications);
            }

            ApplicationTreeService.TreeConfigFilePath = treesConfig;
            SectionService.AppConfigFilePath = appConfig;
        }

        [TearDown]
        public override void TearDown()
        {
            base.TearDown();
            if (Directory.Exists(TestHelper.MapPathForTest(&quot;~/TEMP/TreesAndSections&quot;)))
            {
                Directory.Delete(TestHelper.MapPathForTest(&quot;~/TEMP/TreesAndSections&quot;), true);    
            }
            ApplicationTreeService.TreeConfigFilePath = null;
            SectionService.AppConfigFilePath = null;
        }

        /// &lt;summary&gt;
        /// Creates a new app tree linked to an application, then delete the application and make sure the tree is gone as well
        ///&lt;/summary&gt;
        [Test()]
        public void ApplicationTree_Make_New_Then_Delete_App()
        {
            //create new app
            var appName = Guid.NewGuid().ToString(&quot;N&quot;);
            var treeName = Guid.NewGuid().ToString(&quot;N&quot;);
            ApplicationContext.Services.SectionService.MakeNew(appName, appName, &quot;icon.jpg&quot;);

            //check if it exists
            var app = ApplicationContext.Services.SectionService.GetByAlias(appName);
            Assert.IsNotNull(app);

            //create the new app tree assigned to the new app
            ApplicationContext.Services.ApplicationTreeService.MakeNew(false, 0, app.Alias, treeName, treeName, &quot;icon.jpg&quot;, &quot;icon.jpg&quot;, &quot;Umbraco.Web.Trees.ContentTreeController, umbraco&quot;);
            var tree = ApplicationContext.Services.ApplicationTreeService.GetByAlias(treeName);
            Assert.IsNotNull(tree);

            //now delete the app
            ApplicationContext.Services.SectionService.DeleteSection(app);

            //check that the tree is gone
            Assert.AreEqual(0, ApplicationContext.Services.ApplicationTreeService.GetApplicationTrees(treeName).Count());
        }


        #region Tests to write
        ///// &lt;summary&gt;
        /////A test for ApplicationTree Constructor
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void ApplicationTreeConstructorTest()
        //{
        //    bool silent = false; // TODO: Initialize to an appropriate value
        //    bool initialize = false; // TODO: Initialize to an appropriate value
        //    byte sortOrder = 0; // TODO: Initialize to an appropriate value
        //    string applicationAlias = string.Empty; // TODO: Initialize to an appropriate value
        //    string alias = string.Empty; // TODO: Initialize to an appropriate value
        //    string title = string.Empty; // TODO: Initialize to an appropriate value
        //    string iconClosed = string.Empty; // TODO: Initialize to an appropriate value
        //    string iconOpened = string.Empty; // TODO: Initialize to an appropriate value
        //    string assemblyName = string.Empty; // TODO: Initialize to an appropriate value
        //    string type = string.Empty; // TODO: Initialize to an appropriate value
        //    string action = string.Empty; // TODO: Initialize to an appropriate value
        //    ApplicationTree target = new ApplicationTree(silent, initialize, sortOrder, applicationAlias, alias, title, iconClosed, iconOpened, assemblyName, type, action);
        //    Assert.Inconclusive(&quot;TODO: Implement code to verify target&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for ApplicationTree Constructor
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void ApplicationTreeConstructorTest1()
        //{
        //    ApplicationTree target = new ApplicationTree();
        //    Assert.Inconclusive(&quot;TODO: Implement code to verify target&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Delete
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void DeleteTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    target.Delete();
        //    Assert.Inconclusive(&quot;A method that does not return a value cannot be verified.&quot;);
        //}


        ///// &lt;summary&gt;
        /////A test for Save
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void SaveTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    target.Save();
        //    Assert.Inconclusive(&quot;A method that does not return a value cannot be verified.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for getAll
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void getAllTest()
        //{
        //    ApplicationTree[] expected = null; // TODO: Initialize to an appropriate value
        //    ApplicationTree[] actual;
        //    actual = ApplicationTree.getAll();
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for getApplicationTree
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void getApplicationTreeTest()
        //{
        //    string applicationAlias = string.Empty; // TODO: Initialize to an appropriate value
        //    ApplicationTree[] expected = null; // TODO: Initialize to an appropriate value
        //    ApplicationTree[] actual;
        //    actual = ApplicationTree.getApplicationTree(applicationAlias);
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for getApplicationTree
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void getApplicationTreeTest1()
        //{
        //    string applicationAlias = string.Empty; // TODO: Initialize to an appropriate value
        //    bool onlyInitializedApplications = false; // TODO: Initialize to an appropriate value
        //    ApplicationTree[] expected = null; // TODO: Initialize to an appropriate value
        //    ApplicationTree[] actual;
        //    actual = ApplicationTree.getApplicationTree(applicationAlias, onlyInitializedApplications);
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for getByAlias
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void getByAliasTest()
        //{
        //    string treeAlias = string.Empty; // TODO: Initialize to an appropriate value
        //    ApplicationTree expected = null; // TODO: Initialize to an appropriate value
        //    ApplicationTree actual;
        //    actual = ApplicationTree.getByAlias(treeAlias);
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Action
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void ActionTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string expected = string.Empty; // TODO: Initialize to an appropriate value
        //    string actual;
        //    target.Action = expected;
        //    actual = target.Action;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Alias
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void AliasTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string actual;
        //    actual = target.Alias;
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for ApplicationAlias
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void ApplicationAliasTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string actual;
        //    actual = target.ApplicationAlias;
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for AssemblyName
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void AssemblyNameTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string expected = string.Empty; // TODO: Initialize to an appropriate value
        //    string actual;
        //    target.AssemblyName = expected;
        //    actual = target.AssemblyName;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for IconClosed
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void IconClosedTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string expected = string.Empty; // TODO: Initialize to an appropriate value
        //    string actual;
        //    target.IconClosed = expected;
        //    actual = target.IconClosed;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for IconOpened
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void IconOpenedTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string expected = string.Empty; // TODO: Initialize to an appropriate value
        //    string actual;
        //    target.IconOpened = expected;
        //    actual = target.IconOpened;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Initialize
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void InitializeTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    bool expected = false; // TODO: Initialize to an appropriate value
        //    bool actual;
        //    target.Initialize = expected;
        //    actual = target.Initialize;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Silent
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void SilentTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    bool expected = false; // TODO: Initialize to an appropriate value
        //    bool actual;
        //    target.Silent = expected;
        //    actual = target.Silent;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for SortOrder
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void SortOrderTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    byte expected = 0; // TODO: Initialize to an appropriate value
        //    byte actual;
        //    target.SortOrder = expected;
        //    actual = target.SortOrder;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for SqlHelper
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void SqlHelperTest()
        //{
        //    ISqlHelper actual;
        //    actual = ApplicationTree.SqlHelper;
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Title
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void TitleTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string expected = string.Empty; // TODO: Initialize to an appropriate value
        //    string actual;
        //    target.Title = expected;
        //    actual = target.Title;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //}

        ///// &lt;summary&gt;
        /////A test for Type
        /////&lt;/summary&gt;
        //[TestMethod()]
        //public void TypeTest()
        //{
        //    ApplicationTree target = new ApplicationTree(); // TODO: Initialize to an appropriate value
        //    string expected = string.Empty; // TODO: Initialize to an appropriate value
        //    string actual;
        //    target.Type = expected;
        //    actual = target.Type;
        //    Assert.AreEqual(expected, actual);
        //    Assert.Inconclusive(&quot;Verify the correctness of this test method.&quot;);
        //} 
        #endregion

        #region Additional test attributes
        // 
        //You can use the following additional attributes as you write your tests:
        //
        //Use ClassInitialize to run code before running the first test in the class
        //[ClassInitialize()]
        //public static void MyClassInitialize(TestContext testContext)
        //{
        //}
        //
        //Use ClassCleanup to run code after all tests in a class have run
        //[ClassCleanup()]
        //public static void MyClassCleanup()
        //{
        //}
        //
        //Use TestInitialize to run code before running each test
        //[TestInitialize()]
        //public void MyTestInitialize()
        //{
        //}
        //
        //Use TestCleanup to run code after each test has run
        //[TestCleanup()]
        //public void MyTestCleanup()
        //{
        //}
        //
        #endregion
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[23,9,23,10,1],[24,13,24,31,1],[26,13,26,97,1],[27,13,27,102,1],[28,13,28,93,1],[29,20,29,61,1],[30,13,30,14,1],[31,17,31,51,1],[32,13,32,14,1],[33,20,33,59,1],[34,13,34,14,1],[35,17,35,58,1],[36,13,36,14,1],[38,13,38,69,1],[39,13,39,58,1],[40,9,40,10,1],[44,9,44,10,1],[45,13,45,29,1],[46,13,46,88,1],[47,13,47,14,1],[48,17,48,94,1],[49,13,49,14,1],[50,13,50,62,1],[51,13,51,53,1],[52,9,52,10,1],[59,9,59,10,1],[61,13,61,56,1],[62,13,62,57,1],[63,13,63,94,1],[66,13,66,86,1],[67,13,67,35,1],[70,13,70,189,1],[71,13,71,96,1],[72,13,72,36,1],[75,13,75,75,1],[78,13,78,122,1],[79,9,79,10,1]]);
    </script>
  </body>
</html>