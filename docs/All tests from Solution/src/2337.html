<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.MacroEngines\RazorCore\UmbracoParameterDictionary.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Dynamic;
using umbraco.cms.businesslogic.macro;
using System.Linq;

namespace umbraco.MacroEngines
{

    public class UmbracoParameterDictionary : DynamicObject, IParameterDictionary
    {

        private readonly IEnumerable&lt;MacroPropertyModel&gt; _paramsKeyValue;

        public UmbracoParameterDictionary(IEnumerable&lt;MacroPropertyModel&gt; paramsKeyValue)
        {
            _paramsKeyValue = paramsKeyValue;
            if (_paramsKeyValue == null)
                _paramsKeyValue = new List&lt;MacroPropertyModel&gt;();
        }

        public IEnumerator&lt;KeyValuePair&lt;string, string&gt;&gt; GetEnumerator()
        {
            return _paramsKeyValue.Select(p =&gt; new KeyValuePair&lt;string, string&gt;(p.Key, p.Value)).GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return GetEnumerator();
        }

        public string this[string alias]
        {
            get
            {
                return _paramsKeyValue.Where(p =&gt; p.Key.ToLower() == alias.ToLower()).Select(p =&gt; p.Value).FirstOrDefault();
            }
        }

        public override bool TryGetMember(GetMemberBinder binder, out object result)
        {
            result = this[binder.Name];

            return true;
        }

    }

}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,90,0],[17,9,17,10,0],[18,13,18,46,0],[19,13,19,41,0],[20,17,20,66,0],[21,9,21,10,0],[24,9,24,10,0],[25,13,25,48,0],[25,48,25,96,0],[25,96,25,114,0],[25,13,25,114,0],[26,9,26,10,0],[29,9,29,10,0],[30,13,30,36,0],[31,9,31,10,0],[36,13,36,14,0],[37,17,37,51,0],[37,51,37,85,0],[37,85,37,99,0],[37,99,37,106,0],[37,106,37,125,0],[37,17,37,125,0],[38,13,38,14,0],[42,9,42,10,0],[43,13,43,40,0],[45,13,45,25,0],[46,9,46,10,0]]);
    </script>
  </body>
</html>