<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Persistence\Migrations\Syntax\Delete\Expressions\DeleteDataExpression.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using Umbraco.Core.Persistence.DatabaseModelDefinitions;
using Umbraco.Core.Persistence.SqlSyntax;

namespace Umbraco.Core.Persistence.Migrations.Syntax.Delete.Expressions
{
    public class DeleteDataExpression : MigrationExpressionBase
    {
        private readonly List&lt;DeletionDataDefinition&gt; _rows = new List&lt;DeletionDataDefinition&gt;();
        
        public DeleteDataExpression(DatabaseProviders current, DatabaseProviders[] databaseProviders, ISqlSyntaxProvider sqlSyntax) 
            : base(current, databaseProviders, sqlSyntax)
        {
        }

        public virtual string SchemaName { get; set; }
        public string TableName { get; set; }
        public virtual bool IsAllRows { get; set; }

        public List&lt;DeletionDataDefinition&gt; Rows
        {
            get { return _rows; }
        }

        public override string ToString()
        {
            var deleteItems = new List&lt;string&gt;();

            if (IsAllRows)
            {
                deleteItems.Add(string.Format(SqlSyntax.DeleteData, SqlSyntax.GetQuotedTableName(TableName), &quot;1 = 1&quot;));
            }
            else
            {
                foreach (var row in Rows)
                {
                    var whereClauses = new List&lt;string&gt;();
                    foreach (KeyValuePair&lt;string, object&gt; item in row)
                    {
                        whereClauses.Add(string.Format(&quot;{0} {1} {2}&quot;,
                                                       SqlSyntax.GetQuotedColumnName(item.Key),
                                                       item.Value == null ? &quot;IS&quot; : &quot;=&quot;,
                                                       GetQuotedValue(item.Value)));
                    }

                    deleteItems.Add(string.Format(SqlSyntax.DeleteData,
                                                  SqlSyntax.GetQuotedTableName(TableName),
                                                  String.Join(&quot; AND &quot;, whereClauses.ToArray())));
                }
            }

            return String.Join(&quot;; &quot;, deleteItems.ToArray());
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[10,9,10,98,0],[13,15,13,58,0],[14,9,14,10,0],[15,9,15,10,0],[17,44,17,48,0],[17,49,17,53,0],[18,35,18,39,0],[18,40,18,44,0],[19,41,19,45,0],[19,46,19,50,0],[23,17,23,18,0],[23,19,23,32,0],[23,33,23,34,0],[27,9,27,10,0],[28,13,28,50,0],[30,13,30,27,0],[31,13,31,14,0],[32,17,32,120,0],[33,13,33,14,0],[35,13,35,14,0],[36,17,36,24,0],[36,26,36,33,0],[36,34,36,36,0],[36,37,36,41,0],[37,17,37,18,0],[38,21,38,59,0],[39,21,39,28,0],[39,30,39,63,0],[39,64,39,66,0],[39,67,39,70,0],[40,21,40,22,0],[41,25,44,85,0],[45,21,45,22,0],[47,21,49,98,0],[50,17,50,18,0],[51,13,51,14,0],[53,13,53,61,0],[54,9,54,10,0]]);
    </script>
  </body>
</html>