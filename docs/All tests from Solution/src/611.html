<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\developer\Packages\installedPackage.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using Umbraco.Core.IO;
using Umbraco.Core;
using Umbraco.Core.Logging;
using Umbraco.Core.Models;
using umbraco.BusinessLogic;
using umbraco.cms.businesslogic.web;
using runtimeMacro = umbraco.macro;
using System.Xml;
using umbraco.cms.presentation.Trees;
using BizLogicAction = umbraco.BusinessLogic.Actions.Action;
using Macro = umbraco.cms.businesslogic.macro.Macro;
using Template = umbraco.cms.businesslogic.template.Template;

namespace umbraco.presentation.developer.packages
{
    public partial class installedPackage : BasePages.UmbracoEnsuredPage
    {
        public installedPackage()
        {
            CurrentApp = DefaultApps.developer.ToString();
        }

        private cms.businesslogic.packager.InstalledPackage _pack;
        private cms.businesslogic.packager.repositories.Repository _repo = new cms.businesslogic.packager.repositories.Repository();

        protected void Page_Load(object sender, EventArgs e)
        {

            if (Request.QueryString[&quot;id&quot;] != null)
            {
                _pack = cms.businesslogic.packager.InstalledPackage.GetById(int.Parse(Request.QueryString[&quot;id&quot;]));

                lt_packagename.Text = _pack.Data.Name;
                lt_packageVersion.Text = _pack.Data.Version;
                lt_packageAuthor.Text = _pack.Data.Author;
                lt_readme.Text = library.ReplaceLineBreaks( _pack.Data.Readme );

                bt_confirmUninstall.Attributes.Add(&quot;onClick&quot;, &quot;jQuery(&#39;#buttons&#39;).hide(); jQuery(&#39;#loadingbar&#39;).show();; return true;&quot;);


                if (!Page.IsPostBack)
                {
                    //temp list to contain failing items... 
                    var tempList = new List&lt;string&gt;();

                    foreach (var str in _pack.Data.Documenttypes)
                    {
                        var tId = 0;
                        if (int.TryParse(str, out tId))
                        {
                            try
                            {
                                var dc = new DocumentType(tId);
                                var li = new ListItem(dc.Text, dc.Id.ToString());
                                li.Selected = true;
                                documentTypes.Items.Add(li);
                            }
                            catch
                            {
                                tempList.Add(str);
                            }
                        }
                    }
                    //removing failing documentTypes items from the uninstall manifest
                    SyncLists(_pack.Data.Documenttypes, tempList);


                    foreach (var str in _pack.Data.Templates)
                    {
                        var tId = 0;
                        if (int.TryParse(str, out tId))
                        {
                            try
                            {
                                var t = new Template(tId);
                                var li = new ListItem(t.Text, t.Id.ToString());
                                li.Selected = true;
                                templates.Items.Add(li);
                            }
                            catch
                            {
                                tempList.Add(str);
                            }
                        }
                    }
                    //removing failing template items from the uninstall manifest
                    SyncLists(_pack.Data.Templates, tempList);

                    foreach (string str in _pack.Data.Stylesheets)
                    {
                        int tId = 0;
                        if (int.TryParse(str, out tId))
                        {
                            try
                            {
                                var s = new StyleSheet(tId);
                                ListItem li = new ListItem(s.Text, s.Id.ToString());
                                li.Selected = true;
                                stylesheets.Items.Add(li);
                            }
                            catch
                            {
                                tempList.Add(str);
                            }
                        }
                    }
                    //removing failing stylesheet items from the uninstall manifest
                    SyncLists(_pack.Data.Stylesheets, tempList);

                    foreach (var str in _pack.Data.Macros)
                    {
                        var tId = 0;
                        if (int.TryParse(str, out tId))
                        {
                            try
                            {
                                var m = new Macro(tId);
                                if (!string.IsNullOrEmpty(m.Name))
                                { 
                                    //Macros need an extra check to see if they actually exists. For some reason the macro does not return null, if the id is not found... 
                                    var li = new ListItem(m.Name, m.Id.ToString());
                                    li.Selected = true;
                                    macros.Items.Add(li);
                                }
                                else
                                {
                                    tempList.Add(str);
                                }
                            }
                            catch
                            {
                                tempList.Add(str);
                            }
                        }
                    }
                    //removing failing macros items from the uninstall manifest
                    SyncLists(_pack.Data.Macros, tempList);

                    foreach (var str in _pack.Data.Files)
                    {
                        try
                        {                            
                            if (!string.IsNullOrEmpty(str) &amp;&amp; System.IO.File.Exists(IOHelper.MapPath(str) ))
                            {
                                var li = new ListItem(str, str);
                                li.Selected = true;
                                files.Items.Add(li);
                            }
                            else
                            {
                                tempList.Add(str);
                            }

                        }
                        catch
                        {
                            tempList.Add(str);
                        }
                    }

                    //removing failing files from the uninstall manifest
                    SyncLists(_pack.Data.Files, tempList);

                    foreach (string str in _pack.Data.DictionaryItems)
                    {
                        var tId = 0;

                        if (int.TryParse(str, out tId))
                        {
                            try
                            {
                                var di = new cms.businesslogic.Dictionary.DictionaryItem(tId);

                                var li = new ListItem(di.key, di.id.ToString());
                                li.Selected = true;

                                dictionaryItems.Items.Add(li);
                            }
                            catch
                            {
                                tempList.Add(str);
                            }
                        }
                    }

                    //removing failing files from the uninstall manifest
                    SyncLists(_pack.Data.DictionaryItems, tempList);


                    foreach (var str in _pack.Data.DataTypes)
                    {
                        var tId = 0;

                        if (int.TryParse(str, out tId))
                        {
                            try
                            {
                                var dtd = new cms.businesslogic.datatype.DataTypeDefinition(tId);

                                if (dtd != null)
                                {
                                    var li = new ListItem(dtd.Text, dtd.Id.ToString());
                                    li.Selected = true;

                                    dataTypes.Items.Add(li);
                                }
                                else
                                {
                                    tempList.Add(str);
                                }
                            }
                            catch
                            {
                                tempList.Add(str);
                            }
                        }
                    }

                    //removing failing files from the uninstall manifest
                    SyncLists(_pack.Data.DataTypes, tempList);

                    //save the install manifest, so even tho the user doesn&#39;t uninstall, it stays uptodate.
                    _pack.Save();


                    //Look for updates on packages.
                    if (!string.IsNullOrEmpty(_pack.Data.RepositoryGuid) &amp;&amp; !string.IsNullOrEmpty(_pack.Data.PackageGuid))
                    {
                        try
                        {
                            
                            _repo = cms.businesslogic.packager.repositories.Repository.getByGuid(_pack.Data.RepositoryGuid);

                            if (_repo != null)
                            {
                                hl_packageRepo.Text = _repo.Name;
                                hl_packageRepo.NavigateUrl = &quot;BrowseRepository.aspx?repoGuid=&quot; + _repo.Guid;
                                pp_repository.Visible = true;
                            }

                            var repoPackage = _repo.Webservice.PackageByGuid(_pack.Data.PackageGuid);

                            if (repoPackage != null)
                            {
                                if (repoPackage.HasUpgrade &amp;&amp; repoPackage.UpgradeVersion != _pack.Data.Version)
                                {
                                    pane_upgrade.Visible = true;
                                    lt_upgradeReadme.Text = repoPackage.UpgradeReadMe;
                                    bt_gotoUpgrade.OnClientClick = &quot;window.location.href = &#39;browseRepository.aspx?url=&quot; + repoPackage.Url + &quot;&#39;; return true;&quot;;
                                }
                                
                                if (!string.IsNullOrEmpty(repoPackage.Demo))
                                {
                                    lb_demoLink.OnClientClick = &quot;openDemo(this, &#39;&quot; + _pack.Data.PackageGuid + &quot;&#39;); return false;&quot;;
                                    pp_documentation.Visible = true;
                                }

                                if (!string.IsNullOrEmpty(repoPackage.Documentation))
                                {
                                    hl_docLink.NavigateUrl = repoPackage.Documentation;
                                    hl_docLink.Target = &quot;_blank&quot;;
                                    pp_documentation.Visible = true;
                                }
                            }
                        }
                        catch
                        {
                            pane_upgrade.Visible = false;
                        }
                    }


                    var deletePackage = true;
                    //sync the UI to match what is in the package
                    if (macros.Items.Count == 0)
                        pp_macros.Visible = false;
                    else
                        deletePackage = false;

                    if (documentTypes.Items.Count == 0)
                        pp_docTypes.Visible = false;
                    else
                        deletePackage = false;

                    if (files.Items.Count == 0)
                        pp_files.Visible = false;
                    else
                        deletePackage = false;

                    if (templates.Items.Count == 0)
                        pp_templates.Visible = false;
                    else
                        deletePackage = false;

                    if (stylesheets.Items.Count == 0)
                        pp_css.Visible = false;
                    else
                        deletePackage = false;

                    if (dictionaryItems.Items.Count == 0)
                        pp_di.Visible = false;
                    else
                        deletePackage = false;

                    if (dataTypes.Items.Count == 0)
                        pp_dt.Visible = false;
                    else
                        deletePackage = false;


                    if (deletePackage)
                    {
                        pane_noItems.Visible = true;
                        pane_uninstall.Visible = false;
                    }

                    // List the package version history [LK 2013-067-10]
                    Version v;
                    var packageVersionHistory = cms.businesslogic.packager.InstalledPackage.GetAllInstalledPackages()
                        .Where(x =&gt; x.Data.Id != _pack.Data.Id &amp;&amp;  string.Equals(x.Data.Name, _pack.Data.Name, StringComparison.OrdinalIgnoreCase))
                        .OrderBy(x =&gt; Version.TryParse(x.Data.Version, out v) ? v : new Version());

                    if (packageVersionHistory != null &amp;&amp; packageVersionHistory.Count() &gt; 0)
                    {
                        rptr_versions.DataSource = packageVersionHistory;
                        rptr_versions.DataBind();

                        pane_versions.Visible = true;
                    }
                }
            }
        }

        private static void SyncLists(List&lt;string&gt; list, List&lt;string&gt; removed)
        {
            foreach (var str in removed)
            {
                list.Remove(str);
            }

            for (var i = 0; i &lt; list.Count; i++)
            {
                if (String.IsNullOrEmpty(list[i].Trim()))
                    list.RemoveAt(i);
            }

            removed.Clear();
        }

        protected void delPack(object sender, EventArgs e)
        {
            _pack.Delete(UmbracoUser.Id);
            pane_uninstalled.Visible = true;
            pane_uninstall.Visible = false;
        }


        protected void confirmUnInstall(object sender, EventArgs e)
        {
            var refreshCache = false;

            //Uninstall Stylesheets
            foreach (ListItem li in stylesheets.Items)
            {
                if (li.Selected)
                {
                    int nId;

                    if (int.TryParse(li.Value, out nId))
                    {
                        var s = new StyleSheet(nId);
                        s.delete();
                        _pack.Data.Stylesheets.Remove(nId.ToString());
                    }
                }
            }

            //Uninstall templates
            foreach (ListItem li in templates.Items)
            {
                if (li.Selected)
                {
                    int nId;

                    if (int.TryParse(li.Value, out nId))
                    {
                        var found = ApplicationContext.Services.FileService.GetTemplate(nId);
                        if (found != null)
                        {
                            ApplicationContext.Services.FileService.DeleteTemplate(found.Alias, UmbracoUser.Id);
                        }
                        _pack.Data.Templates.Remove(nId.ToString());
                    }
                }
            }

            //Uninstall macros
            foreach (ListItem li in macros.Items)
            {
                if (li.Selected)
                {
                    int nId;

                    if (int.TryParse(li.Value, out nId))
                    {
                        var s = new Macro(nId);
                        if (!string.IsNullOrEmpty(s.Name))
                        {                            
                            s.Delete();
                        }

                        _pack.Data.Macros.Remove(nId.ToString());
                    }
                }
            }
            
            //Remove Document Types
            var contentTypes = new List&lt;IContentType&gt;();
            var contentTypeService = ApplicationContext.Current.Services.ContentTypeService;
            foreach (ListItem li in documentTypes.Items)
            {
                if (li.Selected)
                {
                    int nId;

                    if (int.TryParse(li.Value, out nId))
                    {
                        var contentType = contentTypeService.GetContentType(nId);
                        if (contentType != null)
                        {
                            contentTypes.Add(contentType);
                            _pack.Data.Documenttypes.Remove(nId.ToString(CultureInfo.InvariantCulture));
                            // refresh content cache when document types are removed
                            refreshCache = true;
                        }
                    }
                }
            }
            //Order the DocumentTypes before removing them
            if (contentTypes.Any())
            {
                var orderedTypes = (from contentType in contentTypes
                                    orderby contentType.ParentId descending, contentType.Id descending 
                                    select contentType);

                foreach (var contentType in orderedTypes)
                {
                    contentTypeService.Delete(contentType);
                }
            }

            //Remove Dictionary items
            foreach (ListItem li in dictionaryItems.Items)
            {
                if (li.Selected)
                {
                    int nId;

                    if (int.TryParse(li.Value, out nId))
                    {
                        var di = new cms.businesslogic.Dictionary.DictionaryItem(nId);
                        di.delete();
                        _pack.Data.DictionaryItems.Remove(nId.ToString());
                    }
                }
            }

            //Remove Data types
            foreach (ListItem li in dataTypes.Items)
            {
                if (li.Selected)
                {
                    int nId;

                    if (int.TryParse(li.Value, out nId))
                    {
                        var dtd = new cms.businesslogic.datatype.DataTypeDefinition(nId);
                        dtd.delete();
                        _pack.Data.DataTypes.Remove(nId.ToString());
                    }
                }
            }

            _pack.Save();

            if (!IsManifestEmpty())
            {
                Response.Redirect(Request.RawUrl);
            }
            else
            {
                
                // uninstall actions
                try
                {
                    var actionsXml = new XmlDocument();
                    actionsXml.LoadXml(&quot;&lt;Actions&gt;&quot; + _pack.Data.Actions + &quot;&lt;/Actions&gt;&quot;);

                    LogHelper.Debug&lt;installedPackage&gt;(&quot;executing undo actions: {0}&quot;, () =&gt; actionsXml.OuterXml);

                    foreach (XmlNode n in actionsXml.DocumentElement.SelectNodes(&quot;//Action&quot;))
                    {
                        try
                        {
                            cms.businesslogic.packager.PackageAction.UndoPackageAction(_pack.Data.Name, n.Attributes[&quot;alias&quot;].Value, n);
                        }
                        catch (Exception ex)
                        {
                            LogHelper.Error&lt;installedPackage&gt;(&quot;An error occurred running undo actions&quot;, ex);
						}
					}
                }
                catch (Exception ex)
                {
                    LogHelper.Error&lt;installedPackage&gt;(&quot;An error occurred running undo actions&quot;, ex);
				}

	            //moved remove of files here so custom package actions can still undo
                //Remove files
                foreach (ListItem li in files.Items)
                {
                    if (li.Selected)
                    {
                        //here we need to try to find the file in question as most packages does not support the tilde char

                        var file = IOHelper.FindFile(li.Value);

                        var filePath = IOHelper.MapPath(file);
                        if (System.IO.File.Exists(filePath))
                        {
                            System.IO.File.Delete(filePath);
                            _pack.Data.Files.Remove(li.Value);
                        }
                    }
                }
                _pack.Save();
                _pack.Delete(UmbracoUser.Id);

                pane_uninstalled.Visible = true;
                pane_uninstall.Visible = false;

            }

            // refresh cache
            if (refreshCache)
            {
                library.RefreshContent();
            }

            //ensure that all tree&#39;s are refreshed after uninstall
            ClientTools.ClearClientTreeCache()
                .RefreshTree();

            TreeDefinitionCollection.Instance.ReRegisterTrees();

            BizLogicAction.ReRegisterActionsAndHandlers();
            
        }

        private bool IsManifestEmpty()
        {

            _pack.Data.Documenttypes.TrimExcess();
            _pack.Data.Files.TrimExcess();
            _pack.Data.Macros.TrimExcess();
            _pack.Data.Stylesheets.TrimExcess();
            _pack.Data.Templates.TrimExcess();
            _pack.Data.DataTypes.TrimExcess();
            _pack.Data.DictionaryItems.TrimExcess();

            var lists = new List&lt;List&lt;string&gt;&gt;
                {
                    _pack.Data.Documenttypes,
                    _pack.Data.Macros,
                    _pack.Data.Stylesheets,
                    _pack.Data.Templates,
                    _pack.Data.DictionaryItems, 
                    _pack.Data.DataTypes
                };

            //Not including files, since there might be assemblies that contain package actions
            //lists.Add(pack.Data.Files);

            return lists.SelectMany(list =&gt; list).All(str =&gt; string.IsNullOrEmpty(str.Trim()));
        }

        protected override void OnInit(EventArgs e)
        {
            base.OnInit(e);

            Panel1.Text = ui.Text(&quot;treeHeaders&quot;, &quot;installedPackages&quot;);
            pane_meta.Text = ui.Text(&quot;packager&quot;, &quot;packageMetaData&quot;);
            pp_name.Text = ui.Text(&quot;packager&quot;, &quot;packageName&quot;);
            pp_version.Text = ui.Text(&quot;packager&quot;, &quot;packageVersion&quot;);
            pp_author.Text = ui.Text(&quot;packager&quot;, &quot;packageAuthor&quot;);
            pp_repository.Text = ui.Text(&quot;packager&quot;, &quot;packageRepository&quot;);
            pp_documentation.Text = ui.Text(&quot;packager&quot;, &quot;packageDocumentation&quot;);
            pp_readme.Text = ui.Text(&quot;packager&quot;, &quot;packageReadme&quot;);
            hl_docLink.Text = ui.Text(&quot;packager&quot;, &quot;packageDocumentation&quot;);
            lb_demoLink.Text = ui.Text(&quot;packager&quot;, &quot;packageDemonstration&quot;);

            pane_versions.Text = ui.Text(&quot;packager&quot;, &quot;packageVersionHistory&quot;);
            pane_noItems.Text = ui.Text(&quot;packager&quot;, &quot;packageNoItemsHeader&quot;);

            pane_uninstall.Text = ui.Text(&quot;packager&quot;, &quot;packageUninstallHeader&quot;);
            bt_deletePackage.Text = ui.Text(&quot;packager&quot;, &quot;packageUninstallHeader&quot;);
            bt_confirmUninstall.Text = ui.Text(&quot;packager&quot;, &quot;packageUninstallConfirm&quot;);

            pane_uninstalled.Text = ui.Text(&quot;packager&quot;, &quot;packageUninstalledHeader&quot;);

            var general = Panel1.NewTabPage(ui.Text(&quot;packager&quot;, &quot;packageName&quot;));
            general.Controls.Add(pane_meta);
            general.Controls.Add(pane_versions);


            var uninstall = Panel1.NewTabPage(ui.Text(&quot;packager&quot;, &quot;packageUninstallHeader&quot;));
            uninstall.Controls.Add(pane_noItems);
            uninstall.Controls.Add(pane_uninstall);
            uninstall.Controls.Add(pane_uninstalled);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[31,9,31,34,0],[32,9,32,10,0],[33,13,33,59,0],[34,9,34,10,0],[37,9,37,133,0],[40,9,40,10,0],[42,13,42,51,0],[43,13,43,14,0],[44,17,44,115,0],[46,17,46,55,0],[47,17,47,61,0],[48,17,48,59,0],[49,17,49,81,0],[51,17,51,137,0],[54,17,54,38,0],[55,17,55,18,0],[57,21,57,55,0],[59,21,59,28,0],[59,30,59,37,0],[59,38,59,40,0],[59,41,59,65,0],[60,21,60,22,0],[61,25,61,37,0],[62,25,62,56,0],[63,25,63,26,0],[65,29,65,30,0],[66,33,66,64,0],[67,33,67,82,0],[68,33,68,52,0],[69,33,69,61,0],[70,29,70,30,0],[71,29,71,34,0],[72,29,72,30,0],[73,33,73,51,0],[74,29,74,30,0],[75,25,75,26,0],[76,21,76,22,0],[78,21,78,67,0],[81,21,81,28,0],[81,30,81,37,0],[81,38,81,40,0],[81,41,81,61,0],[82,21,82,22,0],[83,25,83,37,0],[84,25,84,56,0],[85,25,85,26,0],[87,29,87,30,0],[88,33,88,59,0],[89,33,89,80,0],[90,33,90,52,0],[91,33,91,57,0],[92,29,92,30,0],[93,29,93,34,0],[94,29,94,30,0],[95,33,95,51,0],[96,29,96,30,0],[97,25,97,26,0],[98,21,98,22,0],[100,21,100,63,0],[102,21,102,28,0],[102,30,102,40,0],[102,41,102,43,0],[102,44,102,66,0],[103,21,103,22,0],[104,25,104,37,0],[105,25,105,56,0],[106,25,106,26,0],[108,29,108,30,0],[109,33,109,61,0],[110,33,110,85,0],[111,33,111,52,0],[112,33,112,59,0],[113,29,113,30,0],[114,29,114,34,0],[115,29,115,30,0],[116,33,116,51,0],[117,29,117,30,0],[118,25,118,26,0],[119,21,119,22,0],[121,21,121,65,0],[123,21,123,28,0],[123,30,123,37,0],[123,38,123,40,0],[123,41,123,58,0],[124,21,124,22,0],[125,25,125,37,0],[126,25,126,56,0],[127,25,127,26,0],[129,29,129,30,0],[130,33,130,56,0],[131,33,131,67,0],[132,33,132,34,0],[134,37,134,84,0],[135,37,135,56,0],[136,37,136,58,0],[137,33,137,34,0],[139,33,139,34,0],[140,37,140,55,0],[141,33,141,34,0],[142,29,142,30,0],[143,29,143,34,0],[144,29,144,30,0],[145,33,145,51,0],[146,29,146,30,0],[147,25,147,26,0],[148,21,148,22,0],[150,21,150,60,0],[152,21,152,28,0],[152,30,152,37,0],[152,38,152,40,0],[152,41,152,57,0],[153,21,153,22,0],[155,25,155,26,0],[156,29,156,109,0],[157,29,157,30,0],[158,33,158,65,0],[159,33,159,52,0],[160,33,160,53,0],[161,29,161,30,0],[163,29,163,30,0],[164,33,164,51,0],[165,29,165,30,0],[167,25,167,26,0],[168,25,168,30,0],[169,25,169,26,0],[170,29,170,47,0],[171,25,171,26,0],[172,21,172,22,0],[175,21,175,59,0],[177,21,177,28,0],[177,30,177,40,0],[177,41,177,43,0],[177,44,177,70,0],[178,21,178,22,0],[179,25,179,37,0],[181,25,181,56,0],[182,25,182,26,0],[184,29,184,30,0],[185,33,185,95,0],[187,33,187,81,0],[188,33,188,52,0],[190,33,190,63,0],[191,29,191,30,0],[192,29,192,34,0],[193,29,193,30,0],[194,33,194,51,0],[195,29,195,30,0],[196,25,196,26,0],[197,21,197,22,0],[200,21,200,69,0],[203,21,203,28,0],[203,30,203,37,0],[203,38,203,40,0],[203,41,203,61,0],[204,21,204,22,0],[205,25,205,37,0],[207,25,207,56,0],[208,25,208,26,0],[210,29,210,30,0],[211,33,211,98,0],[213,33,213,49,0],[214,33,214,34,0],[215,37,215,88,0],[216,37,216,56,0],[218,37,218,61,0],[219,33,219,34,0],[221,33,221,34,0],[222,37,222,55,0],[223,33,223,34,0],[224,29,224,30,0],[225,29,225,34,0],[226,29,226,30,0],[227,33,227,51,0],[228,29,228,30,0],[229,25,229,26,0],[230,21,230,22,0],[233,21,233,63,0],[236,21,236,34,0],[240,21,240,123,0],[241,21,241,22,0],[243,25,243,26,0],[245,29,245,125,0],[247,29,247,47,0],[248,29,248,30,0],[249,33,249,66,0],[250,33,250,109,0],[251,33,251,62,0],[252,29,252,30,0],[254,29,254,102,0],[256,29,256,53,0],[257,29,257,30,0],[258,33,258,112,0],[259,33,259,34,0],[260,37,260,65,0],[261,37,261,87,0],[262,37,262,159,0],[263,33,263,34,0],[265,33,265,77,0],[266,33,266,34,0],[267,37,267,131,0],[268,37,268,69,0],[269,33,269,34,0],[271,33,271,86,0],[272,33,272,34,0],[273,37,273,88,0],[274,37,274,66,0],[275,37,275,69,0],[276,33,276,34,0],[277,29,277,30,0],[278,25,278,26,0],[279,25,279,30,0],[280,25,280,26,0],[281,29,281,58,0],[282,25,282,26,0],[283,21,283,22,0],[286,21,286,46,0],[288,21,288,49,0],[289,25,289,51,0],[291,25,291,47,0],[293,21,293,56,0],[294,25,294,53,0],[296,25,296,47,0],[298,21,298,48,0],[299,25,299,50,0],[301,25,301,47,0],[303,21,303,52,0],[304,25,304,54,0],[306,25,306,47,0],[308,21,308,54,0],[309,25,309,48,0],[311,25,311,47,0],[313,21,313,58,0],[314,25,314,47,0],[316,25,316,47,0],[318,21,318,52,0],[319,25,319,47,0],[321,25,321,47,0],[324,21,324,39,0],[325,21,325,22,0],[326,25,326,53,0],[327,25,327,56,0],[328,21,328,22,0],[332,21,333,37,0],[333,37,333,147,0],[333,147,334,39,0],[334,39,334,98,0],[334,98,334,100,0],[332,21,334,100,0],[336,21,336,92,0],[337,21,337,22,0],[338,25,338,74,0],[339,25,339,50,0],[341,25,341,54,0],[342,21,342,22,0],[343,17,343,18,0],[344,13,344,14,0],[345,9,345,10,0],[348,9,348,10,0],[349,13,349,20,0],[349,22,349,29,0],[349,30,349,32,0],[349,33,349,40,0],[350,13,350,14,0],[351,17,351,34,0],[352,13,352,14,0],[354,18,354,27,0],[354,29,354,43,0],[354,45,354,48,0],[355,13,355,14,0],[356,17,356,58,0],[357,21,357,38,0],[358,13,358,14,0],[360,13,360,29,0],[361,9,361,10,0],[364,9,364,10,0],[365,13,365,42,0],[366,13,366,45,0],[367,13,367,44,0],[368,9,368,10,0],[372,9,372,10,0],[373,13,373,38,0],[376,13,376,20,0],[376,22,376,33,0],[376,34,376,36,0],[376,37,376,54,0],[377,13,377,14,0],[378,17,378,33,0],[379,17,379,18,0],[382,21,382,57,0],[383,21,383,22,0],[384,25,384,53,0],[385,25,385,36,0],[386,25,386,71,0],[387,21,387,22,0],[388,17,388,18,0],[389,13,389,14,0],[392,13,392,20,0],[392,22,392,33,0],[392,34,392,36,0],[392,37,392,52,0],[393,13,393,14,0],[394,17,394,33,0],[395,17,395,18,0],[398,21,398,57,0],[399,21,399,22,0],[400,25,400,94,0],[401,25,401,43,0],[402,25,402,26,0],[403,29,403,113,0],[404,25,404,26,0],[405,25,405,69,0],[406,21,406,22,0],[407,17,407,18,0],[408,13,408,14,0],[411,13,411,20,0],[411,22,411,33,0],[411,34,411,36,0],[411,37,411,49,0],[412,13,412,14,0],[413,17,413,33,0],[414,17,414,18,0],[417,21,417,57,0],[418,21,418,22,0],[419,25,419,48,0],[420,25,420,59,0],[421,25,421,26,0],[422,29,422,40,0],[423,25,423,26,0],[425,25,425,66,0],[426,21,426,22,0],[427,17,427,18,0],[428,13,428,14,0],[431,13,431,57,0],[432,13,432,93,0],[433,13,433,20,0],[433,22,433,33,0],[433,34,433,36,0],[433,37,433,56,0],[434,13,434,14,0],[435,17,435,33,0],[436,17,436,18,0],[439,21,439,57,0],[440,21,440,22,0],[441,25,441,82,0],[442,25,442,49,0],[443,25,443,26,0],[444,29,444,59,0],[445,29,445,105,0],[447,29,447,49,0],[448,25,448,26,0],[449,21,449,22,0],[450,17,450,18,0],[451,13,451,14,0],[453,13,453,36,0],[454,13,454,14,0],[455,17,456,45,0],[456,45,456,65,0],[456,65,456,78,0],[456,78,456,92,0],[456,92,457,57,0],[455,17,457,57,0],[459,17,459,24,0],[459,26,459,41,0],[459,42,459,44,0],[459,45,459,57,0],[460,17,460,18,0],[461,21,461,60,0],[462,17,462,18,0],[463,13,463,14,0],[466,13,466,20,0],[466,22,466,33,0],[466,34,466,36,0],[466,37,466,58,0],[467,13,467,14,0],[468,17,468,33,0],[469,17,469,18,0],[472,21,472,57,0],[473,21,473,22,0],[474,25,474,87,0],[475,25,475,37,0],[476,25,476,75,0],[477,21,477,22,0],[478,17,478,18,0],[479,13,479,14,0],[482,13,482,20,0],[482,22,482,33,0],[482,34,482,36,0],[482,37,482,52,0],[483,13,483,14,0],[484,17,484,33,0],[485,17,485,18,0],[488,21,488,57,0],[489,21,489,22,0],[490,25,490,90,0],[491,25,491,38,0],[492,25,492,69,0],[493,21,493,22,0],[494,17,494,18,0],[495,13,495,14,0],[497,13,497,26,0],[499,13,499,36,0],[500,13,500,14,0],[501,17,501,51,0],[502,13,502,14,0],[504,13,504,14,0],[508,17,508,18,0],[509,21,509,56,0],[510,21,510,89,0],[512,21,512,92,0],[512,92,512,111,0],[512,111,512,113,0],[512,21,512,113,0],[514,21,514,28,0],[514,30,514,39,0],[514,40,514,42,0],[514,43,514,93,0],[515,21,515,22,0],[517,25,517,26,0],[518,29,518,137,0],[519,25,519,26,0],[520,25,520,45,0],[521,25,521,26,0],[522,29,522,109,0],[523,7,523,8,0],[524,6,524,7,0],[525,17,525,18,0],[526,17,526,37,0],[527,17,527,18,0],[528,21,528,101,0],[529,5,529,6,0],[533,17,533,24,0],[533,26,533,37,0],[533,38,533,40,0],[533,41,533,52,0],[534,17,534,18,0],[535,21,535,37,0],[536,21,536,22,0],[539,25,539,64,0],[541,25,541,63,0],[542,25,542,61,0],[543,25,543,26,0],[544,29,544,61,0],[545,29,545,63,0],[546,25,546,26,0],[547,21,547,22,0],[548,17,548,18,0],[549,17,549,30,0],[550,17,550,46,0],[552,17,552,49,0],[553,17,553,48,0],[555,13,555,14,0],[558,13,558,30,0],[559,13,559,14,0],[560,17,560,42,0],[561,13,561,14,0],[564,13,565,32,0],[567,13,567,65,0],[569,13,569,59,0],[571,9,571,10,0],[574,9,574,10,0],[576,13,576,51,0],[577,13,577,43,0],[578,13,578,44,0],[579,13,579,49,0],[580,13,580,47,0],[581,13,581,47,0],[582,13,582,53,0],[584,13,592,19,0],[597,13,597,45,0],[597,45,597,49,0],[597,49,597,62,0],[597,62,597,94,0],[597,94,597,96,0],[597,13,597,96,0],[598,9,598,10,0],[601,9,601,10,0],[602,13,602,28,0],[604,13,604,71,0],[605,13,605,69,0],[606,13,606,63,0],[607,13,607,69,0],[608,13,608,67,0],[609,13,609,75,0],[610,13,610,81,0],[611,13,611,67,0],[612,13,612,75,0],[613,13,613,76,0],[615,13,615,79,0],[616,13,616,77,0],[618,13,618,81,0],[619,13,619,83,0],[620,13,620,87,0],[622,13,622,85,0],[624,13,624,81,0],[625,13,625,45,0],[626,13,626,49,0],[629,13,629,94,0],[630,13,630,50,0],[631,13,631,52,0],[632,13,632,54,0],[633,9,633,10,0]]);
    </script>
  </body>
</html>