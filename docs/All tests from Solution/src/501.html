<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\controls\dualSelectBox.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web.Razor;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using ClientDependency.Core;

namespace umbraco.controls
{
	/// &lt;summary&gt;
	/// Summary description for dualSelectbox.
	/// &lt;/summary&gt;
	[ClientDependency(ClientDependencyType.Javascript, &quot;js/dualSelectBox.js&quot;, &quot;UmbracoRoot&quot;)]
	public class DualSelectbox : System.Web.UI.WebControls.WebControl, System.Web.UI.INamingContainer
	{
		private ListItemCollection _items = new ListItemCollection();

		private ListBox _possibleValues = new ListBox();
		private ListBox _selectedValues = new ListBox();
		private HtmlInputHidden _value = new HtmlInputHidden();
        private HtmlInputButton _add = new HtmlInputButton();
        private HtmlInputButton _remove = new HtmlInputButton();
		private int _rows = 8;


		public ListItemCollection Items 
		{
			get 
			{
				EnsureChildControls();
				return _items;
			}
		}

		public new int Width 
		{
			set 
			{
				_possibleValues.Width = new Unit(value);
				_selectedValues.Width = new Unit(value);
			}
		}

        protected override void CreateChildControls()
        {
            _possibleValues.ID = &quot;posVals&quot;;
            _selectedValues.ID = &quot;selVals&quot;;
            _possibleValues.SelectionMode = ListSelectionMode.Multiple;
            _selectedValues.SelectionMode = ListSelectionMode.Multiple;
            _possibleValues.CssClass = &quot;guiInputTextStandard&quot;;
            _selectedValues.CssClass = &quot;guiInputTextStandard&quot;;
            _possibleValues.Rows = _rows;
            _selectedValues.Rows = _rows;

            _value.ID = &quot;theValue&quot;;

            HtmlTable table = new HtmlTable();
            table.CellPadding = 5;
            table.CellSpacing = 0;
            table.Border = 0;

            HtmlTableRow header = new HtmlTableRow();
            header.Controls.Add(new HtmlTableCell { InnerHtml = ui.Text(&quot;content&quot;, &quot;notmemberof&quot;) });
            header.Controls.Add(new HtmlTableCell { InnerHtml= &quot;&amp;nbsp;&quot; });
            header.Controls.Add(new HtmlTableCell { InnerHtml = ui.Text(&quot;content&quot;, &quot;memberof&quot;) });
            table.Controls.Add(header);

            HtmlTableRow row = new HtmlTableRow();
            table.Controls.Add(row);
            HtmlTableCell cFirst = new HtmlTableCell();
            cFirst.Controls.Add(_possibleValues);
            row.Controls.Add(cFirst);
            HtmlTableCell cButtons = new HtmlTableCell();
            _add.Value = &quot;&gt;&gt;&quot;;
            _add.Attributes.Add(&quot;class&quot;, &quot;guiInputButton&quot;);
            _remove.Value = &quot;&lt;&lt;&quot;;
            _remove.Attributes.Add(&quot;class&quot;, &quot;guiInputButton&quot;);
            cButtons.Controls.Add(_add);
            cButtons.Controls.Add(new LiteralControl(&quot;&lt;br/&gt;&lt;br/&gt;&quot;));
            cButtons.Controls.Add(_remove);
            row.Controls.Add(cButtons);
            HtmlTableCell cSecond = new HtmlTableCell();
            cSecond.Controls.Add(_selectedValues);
            row.Controls.Add(cSecond);

            this.Controls.Add(table);
            this.Controls.Add(_value);
        }

		public string Value 
		{
			get 
			{
                return _value.Value;
			}
			
			set 
			{
                _value.Value = value;
            }
		}

		public int Rows 
		{
			set 
			{
				_rows = value;
			}
		}

		public DualSelectbox()
		{
		}


		protected override void OnPreRender(EventArgs e)
		{
			base.OnPreRender (e);

			_selectedValues.Items.Clear();
			_possibleValues.Items.Clear();

			foreach(ListItem li in _items) 
			{
				if (((string) (&quot;,&quot;+ this.Value +&quot;,&quot;)).IndexOf(&quot;,&quot;+li.Value+&quot;,&quot;) &gt; -1) 
					_selectedValues.Items.Add(li);
				else
					_possibleValues.Items.Add(li);											
			}

            // add js to buttons here to ensure full clientids
            _add.Attributes.Add(&quot;onClick&quot;, &quot;dualSelectBoxShift(&#39;&quot; + this.ClientID + &quot;&#39;);&quot;);
            _remove.Attributes.Add(&quot;onClick&quot;, &quot;dualSelectBoxShift(&#39;&quot; + this.ClientID + &quot;&#39;);&quot;);
        }

		


	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[16,3,16,64,0],[18,3,18,51,0],[19,3,19,51,0],[20,3,20,58,0],[21,9,21,62,0],[22,9,22,65,0],[23,3,23,25,0],[29,4,29,5,0],[30,5,30,27,0],[31,5,31,19,0],[32,4,32,5,0],[38,4,38,5,0],[39,5,39,45,0],[40,5,40,45,0],[41,4,41,5,0],[45,9,45,10,0],[46,13,46,44,0],[47,13,47,44,0],[48,13,48,72,0],[49,13,49,72,0],[50,13,50,63,0],[51,13,51,63,0],[52,13,52,42,0],[53,13,53,42,0],[55,13,55,36,0],[57,13,57,47,0],[58,13,58,35,0],[59,13,59,35,0],[60,13,60,30,0],[62,13,62,54,0],[63,13,63,102,0],[64,13,64,76,0],[65,13,65,99,0],[66,13,66,40,0],[68,13,68,51,0],[69,13,69,37,0],[70,13,70,56,0],[71,13,71,50,0],[72,13,72,38,0],[73,13,73,58,0],[74,13,74,31,0],[75,13,75,60,0],[76,13,76,34,0],[77,13,77,63,0],[78,13,78,41,0],[79,13,79,69,0],[80,13,80,44,0],[81,13,81,40,0],[82,13,82,57,0],[83,13,83,51,0],[84,13,84,39,0],[86,13,86,38,0],[87,13,87,39,0],[88,9,88,10,0],[93,4,93,5,0],[94,17,94,37,0],[95,4,95,5,0],[98,4,98,5,0],[99,17,99,38,0],[100,13,100,14,0],[106,4,106,5,0],[107,5,107,19,0],[108,4,108,5,0],[111,3,111,25,0],[112,3,112,4,0],[113,3,113,4,0],[117,3,117,4,0],[118,4,118,25,0],[120,4,120,34,0],[121,4,121,34,0],[123,4,123,11,0],[123,12,123,23,0],[123,24,123,26,0],[123,27,123,33,0],[124,4,124,5,0],[125,5,125,74,0],[126,6,126,36,0],[128,6,128,36,0],[129,4,129,5,0],[132,13,132,92,0],[133,13,133,95,0],[134,9,134,10,0]]);
    </script>
  </body>
</html>