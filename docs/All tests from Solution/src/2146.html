<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Events\CancellableEventArgs.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Security.Permissions;
using Umbraco.Core.Models.PublishedContent;

namespace Umbraco.Core.Events
{
    /// &lt;summary&gt;
	/// Event args for that can support cancellation
	/// &lt;/summary&gt;
	[HostProtection(SecurityAction.LinkDemand, SharedState = true)]
	public class CancellableEventArgs : EventArgs
	{
		private bool _cancel;

        public CancellableEventArgs(bool canCancel, EventMessages messages, IDictionary&lt;string, object&gt; additionalData)
        {
            CanCancel = canCancel;
            Messages = messages;
            AdditionalData = new ReadOnlyDictionary&lt;string, object&gt;(additionalData);
        }

        public CancellableEventArgs(bool canCancel, EventMessages eventMessages)
        {
            if (eventMessages == null) throw new ArgumentNullException(&quot;eventMessages&quot;);
            CanCancel = canCancel;
            Messages = eventMessages;
            AdditionalData = new ReadOnlyDictionary&lt;string, object&gt;(new Dictionary&lt;string, object&gt;());
        }

        public CancellableEventArgs(bool canCancel)
		{
			CanCancel = canCancel;
            //create a standalone messages
            Messages = new EventMessages();
            AdditionalData = new ReadOnlyDictionary&lt;string, object&gt;(new Dictionary&lt;string, object&gt;());
        }

        public CancellableEventArgs(EventMessages eventMessages)
            : this(true, eventMessages)
        {
        }

        public CancellableEventArgs()
			: this(true)
		{
		}

		/// &lt;summary&gt;
		/// Flag to determine if this instance will support being cancellable
		/// &lt;/summary&gt;
		public bool CanCancel { get; set; }

		/// &lt;summary&gt;
		/// If this instance supports cancellation, this gets/sets the cancel value
		/// &lt;/summary&gt;
		public bool Cancel
		{
			get
			{
				if (CanCancel == false)
				{
					throw new InvalidOperationException(&quot;This event argument class does not support cancelling.&quot;);
				}
				return _cancel;
			}
			set
			{
				if (CanCancel == false)
				{
					throw new InvalidOperationException(&quot;This event argument class does not support cancelling.&quot;);
				}
				_cancel = value;
			}
		}

        /// &lt;summary&gt;
        /// if this instance supports cancellation, this will set Cancel to true with an affiliated cancellation message
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;cancelationMessage&quot;&gt;&lt;/param&gt;
        public void CancelOperation(EventMessage cancelationMessage)
        {
            Cancel = true;
            cancelationMessage.IsDefaultEventMessage = true;
            Messages.Add(cancelationMessage);
        }

        /// &lt;summary&gt;
        /// Returns the EventMessages object which is used to add messages to the message collection for this event
        /// &lt;/summary&gt;
        public EventMessages Messages { get; private set; }

        /// &lt;summary&gt;
        /// In some cases raised evens might need to contain additional arbitrary readonly data which can be read by event subscribers
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// This allows for a bit of flexibility in our event raising - it&#39;s not pretty but we need to maintain backwards compatibility 
        /// so we cannot change the strongly typed nature for some events.
        /// &lt;/remarks&gt;
        public ReadOnlyDictionary&lt;string, object&gt; AdditionalData { get; private set; } 
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[17,9,17,120,0],[18,9,18,10,0],[19,13,19,35,0],[20,13,20,33,0],[21,13,21,85,0],[22,9,22,10,0],[24,9,24,81,1],[25,9,25,10,1],[26,13,26,39,1],[26,40,26,89,0],[27,13,27,35,1],[28,13,28,38,1],[29,13,29,103,1],[30,9,30,10,1],[32,9,32,52,1],[33,3,33,4,1],[34,4,34,26,1],[36,13,36,44,1],[37,13,37,103,1],[38,9,38,10,1],[41,15,41,40,0],[42,9,42,10,0],[43,9,43,10,0],[46,6,46,16,1],[47,3,47,4,1],[48,3,48,4,1],[53,27,53,31,1],[53,32,53,36,1],[61,4,61,5,1],[62,5,62,28,1],[63,5,63,6,0],[64,6,64,100,0],[66,5,66,20,1],[67,4,67,5,1],[69,4,69,5,1],[70,5,70,28,1],[71,5,71,6,0],[72,6,72,100,0],[74,5,74,21,1],[75,4,75,5,1],[83,9,83,10,0],[84,13,84,27,0],[85,13,85,61,0],[86,13,86,46,0],[87,9,87,10,0],[92,41,92,45,0],[92,46,92,58,1],[101,68,101,72,0],[101,73,101,85,1]]);
    </script>
  </body>
</html>