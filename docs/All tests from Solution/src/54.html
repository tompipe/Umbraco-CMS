<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\PublishedContent\DynamicNodeTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.IO;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Core.Configuration;
using Umbraco.Core.IO;
using Umbraco.Tests.TestHelpers;
using Umbraco.Web;
using Umbraco.Web.PublishedCache;
using Umbraco.Web.PublishedCache.XmlPublishedCache;
using umbraco.MacroEngines;
using umbraco.NodeFactory;
using System.Linq;

namespace Umbraco.Tests.PublishedContent
{
    [DatabaseTestBehavior(DatabaseBehavior.NewDbFileAndSchemaPerFixture)]
    [TestFixture]
    public class DynamicNodeTests : DynamicDocumentTestsBase&lt;DynamicNode, DynamicNodeList&gt;
    {

        public override void Initialize()
        {
            base.Initialize();
           
            //need to specify a custom callback for unit tests
            DynamicNode.GetDataTypeCallback = (docTypeAlias, propertyAlias) =&gt;
            {
                if (propertyAlias == &quot;content&quot;)
                {
                    //return the rte type id
                    return Guid.Parse(Constants.PropertyEditors.TinyMCEv3);
                }
                return Guid.Empty;
            };

        }

        [Test]
        [Ignore(&quot;This test will never work unless DynamicNode is refactored a lot in order to get a list of root nodes since root nodes don&#39;t have a parent to look up&quot;)]
        public override void Is_First_Root_Nodes()
        {
            base.Is_First_Root_Nodes();
        }

        [Test]
        [Ignore(&quot;This test will never work unless DynamicNode is refactored a lot in order to get a list of root nodes since root nodes don&#39;t have a parent to look up&quot;)]
        public override void Is_Not_First_Root_Nodes()
        {
            base.Is_Not_First_Root_Nodes();
        }

        [Test]
        [Ignore(&quot;This test will never work unless DynamicNode is refactored a lot in order to get a list of root nodes since root nodes don&#39;t have a parent to look up&quot;)]
        public override void Is_Position_Root_Nodes()
        {
            base.Is_Position_Root_Nodes();
        }

        protected override dynamic GetDynamicNode(int id)
        {
            //var template = Template.MakeNew(&quot;test&quot;, new User(0));
            //var ctx = GetUmbracoContext(&quot;/test&quot;, template.Id);
            var ctx = GetUmbracoContext(&quot;/test&quot;, 1234);

            var cache = ctx.ContentCache.InnerCache as PublishedContentCache;
            if (cache == null) throw new Exception(&quot;Unsupported IPublishedContentCache, only the Xml one is supported.&quot;);

            var node = new DynamicNode(
                new DynamicBackingItem(
                    new Node(cache.GetXml(ctx, ctx.InPreviewMode).SelectSingleNode(&quot;//*[@id=&#39;&quot; + id + &quot;&#39; and @isDoc]&quot;))));
            Assert.IsNotNull(node);
            return (dynamic)node;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[23,9,23,10,1],[24,13,24,31,1],[27,13,28,13,1],[28,13,28,14,1],[28,14,29,17,1],[29,17,29,48,1],[29,48,30,17,1],[30,17,30,18,1],[30,18,32,21,1],[32,21,32,76,1],[32,76,34,17,1],[34,17,34,35,1],[34,35,35,13,1],[35,13,35,14,1],[35,14,35,15,1],[27,13,35,15,1],[37,9,37,10,1],[42,9,42,10,0],[43,13,43,40,0],[44,9,44,10,0],[49,9,49,10,0],[50,13,50,44,0],[51,9,51,10,0],[56,9,56,10,0],[57,13,57,43,0],[58,9,58,10,0],[61,9,61,10,1],[64,13,64,56,1],[66,13,66,78,1],[67,13,67,31,1],[67,32,67,122,0],[69,13,71,123,1],[72,13,72,36,1],[73,13,73,34,1],[74,9,74,10,1]]);
    </script>
  </body>
</html>