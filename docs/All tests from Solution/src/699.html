<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\CacheHelperExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web;
using System.Web.Caching;
using System.Web.Mvc;
using System.Web.Mvc.Html;
using Umbraco.Core;
using umbraco.cms.businesslogic.web;
using Umbraco.Core.Cache;

namespace Umbraco.Web
{

	/// &lt;summary&gt;
	/// Extension methods for the cache helper
	/// &lt;/summary&gt;
	public static class CacheHelperExtensions
	{

		public const string PartialViewCacheKey = &quot;Umbraco.Web.PartialViewCacheKey&quot;;
       
		/// &lt;summary&gt;
		/// Outputs and caches a partial view in MVC
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;cacheHelper&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;htmlHelper&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;partialViewName&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;model&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;cachedSeconds&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;cacheKey&quot;&gt;used to cache the partial view, this key could change if it is cached by page or by member&lt;/param&gt;
		/// &lt;param name=&quot;viewData&quot;&gt;&lt;/param&gt;
		/// &lt;returns&gt;&lt;/returns&gt;
		public static IHtmlString CachedPartialView(
			this CacheHelper cacheHelper,
			HtmlHelper htmlHelper,
			string partialViewName,
			object model,
			int cachedSeconds,
			string cacheKey,
			ViewDataDictionary viewData = null)
		{
            //disable cached partials in debug mode: http://issues.umbraco.org/issue/U4-5940
            if (htmlHelper.ViewContext.HttpContext.IsDebuggingEnabled)
            {
                // just return a normal partial view instead
                return htmlHelper.Partial(partialViewName, model, viewData);
            }

            return cacheHelper.RuntimeCache.GetCacheItem&lt;IHtmlString&gt;(
				PartialViewCacheKey + cacheKey,
                () =&gt; htmlHelper.Partial(partialViewName, model, viewData),
				priority: CacheItemPriority.NotRemovable, //not removable, the same as macros (apparently issue #27610)
				timeout: new TimeSpan(0, 0, 0, cachedSeconds));
		}

		/// &lt;summary&gt;
		/// Clears the cache for partial views
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;cacheHelper&quot;&gt;&lt;/param&gt;
		public static void ClearPartialViewCache(this CacheHelper cacheHelper)
		{
			cacheHelper.RuntimeCache.ClearCacheByKeySearch(PartialViewCacheKey);
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[40,3,40,4,0],[42,13,42,71,0],[43,13,43,14,0],[45,17,45,77,0],[48,13,50,23,0],[50,23,50,75,0],[50,75,52,52,0],[48,13,52,52,0],[53,3,53,4,0],[60,3,60,4,0],[61,4,61,72,0],[62,3,62,4,0]]);
    </script>
  </body>
</html>