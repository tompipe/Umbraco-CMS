<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Mvc\QueryStringFilterAttribute.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web.Mvc;
using Umbraco.Core;

namespace Umbraco.Web.Mvc
{

    /// &lt;summary&gt;
    /// Allows an Action to execute with an arbitrary number of QueryStrings
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// Just like you can POST an arbitrary number of parameters to an Action, you can&#39;t GET an arbitrary number
    /// but this will allow you to do it
    /// 
    /// http://stackoverflow.com/questions/488061/passing-multiple-parameters-to-controller-in-asp-net-mvc-also-generating-on-the
    /// &lt;/remarks&gt;
    public class QueryStringFilterAttribute : ActionFilterAttribute
    {
        public string ParameterName { get; private set; }

        public QueryStringFilterAttribute(string parameterName)
        {
            if (string.IsNullOrEmpty(parameterName))
                throw new ArgumentException(&quot;ParameterName is required.&quot;);
            ParameterName = parameterName;
        }

        public override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            var nonNullKeys = filterContext.HttpContext.Request.QueryString.AllKeys.Where(x =&gt; !string.IsNullOrEmpty(x));
            var vals = nonNullKeys.ToDictionary(q =&gt; q, q =&gt; (object)filterContext.HttpContext.Request.QueryString[q]);
            var qs = ToFormCollection(vals);

            filterContext.ActionParameters[ParameterName] = qs;

            base.OnActionExecuting(filterContext);
        }

        /// &lt;summary&gt;
        /// Converts a dictionary to a FormCollection
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;d&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static FormCollection ToFormCollection(IDictionary&lt;string, object&gt; d)
        {
            var n = new FormCollection();
            foreach (var i in d)
            {
                n.Add(i.Key, Convert.ToString(i.Value));
            }
            return n;
        }

    }

}

    </pre>
    <script type="text/javascript">
      highlightRanges([[21,39,21,43,0],[21,44,21,56,0],[23,9,23,64,0],[24,9,24,10,0],[25,13,25,53,0],[26,17,26,75,0],[27,13,27,43,0],[28,9,28,10,0],[31,9,31,10,0],[32,13,32,96,0],[32,96,32,120,0],[32,120,32,122,0],[32,13,32,122,0],[33,13,33,54,0],[33,54,33,55,0],[33,55,33,62,0],[33,62,33,118,0],[33,118,33,120,0],[33,13,33,120,0],[34,13,34,45,0],[36,13,36,64,0],[38,13,38,51,0],[39,9,39,10,0],[47,9,47,10,0],[48,13,48,42,0],[49,13,49,20,0],[49,22,49,27,0],[49,28,49,30,0],[49,31,49,32,0],[50,13,50,14,0],[51,17,51,57,0],[52,13,52,14,0],[53,13,53,22,0],[54,9,54,10,0]]);
    </script>
  </body>
</html>