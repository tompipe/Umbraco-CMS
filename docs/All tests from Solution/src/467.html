<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\Trees\loadMemberTypes.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Text;
using System.Web;
using System.Web.Security;
using System.Xml;
using System.Configuration;
using Umbraco.Core.Security;
using umbraco.BasePages;
using umbraco.BusinessLogic;
using umbraco.businesslogic;
using umbraco.cms.businesslogic;
using umbraco.cms.businesslogic.cache;
using umbraco.cms.businesslogic.contentitem;
using umbraco.cms.businesslogic.datatype;
using umbraco.cms.businesslogic.language;
using umbraco.cms.businesslogic.media;
using umbraco.cms.businesslogic.member;
using umbraco.cms.businesslogic.property;
using umbraco.cms.businesslogic.web;
using umbraco.interfaces;
using umbraco.DataLayer;
using umbraco.BusinessLogic.Utils;
using umbraco.cms.presentation.Trees;
using Umbraco.Core;


namespace umbraco
{
    /// &lt;summary&gt;
    /// Handles loading of the member types into the application tree
    /// &lt;/summary&gt;
    [Obsolete(&quot;This class is no longer used and will be removed from the codebase in future versions&quot;)]
    public class loadMemberTypes : BaseTree
	{
        public loadMemberTypes(string application) : base(application) { }

        protected override void CreateRootNode(ref XmlTreeNode rootNode)
        {
            var provider = MembershipProviderExtensions.GetMembersMembershipProvider();
 
            // only show member types if we&#39;re using umbraco members on the website
            if (provider.IsUmbracoMembershipProvider())
            {
				rootNode.NodeType = &quot;init&quot; + TreeAlias;
				rootNode.NodeID = &quot;init&quot;;
            }
            else
            {
                rootNode = null;
            }
        }

		/// &lt;summary&gt;
		/// Renders the Javascript.
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;Javascript&quot;&gt;The javascript.&lt;/param&gt;
		public override void RenderJS(ref StringBuilder Javascript)
        {
            Javascript.Append(
                @&quot;
function openMemberType(id) {
	UmbClientMgr.contentFrame(&#39;members/editMemberType.aspx?id=&#39; + id);
}
&quot;);
        }

        /// &lt;summary&gt;
        /// This will call the normal Render method by passing the converted XmlTree to an XmlDocument.
        /// TODO: need to update this render method to do everything that the obsolete render method does and remove the obsolete method
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;tree&quot;&gt;&lt;/param&gt;
        public override void Render(ref XmlTree tree)
        {
            XmlDocument xDoc = new XmlDocument();
            xDoc.LoadXml(tree.ToString(SerializedTreeType.XmlTree));
            Render(ref xDoc);
            tree = SerializableData.Deserialize(xDoc.OuterXml, typeof(XmlTree)) as XmlTree;
			//ensure that the tree type is set! this wouldn&#39;t need to be done if BaseTree was implemented properly
			foreach (XmlTreeNode node in tree)
				node.TreeType = this.TreeAlias;
        }

		/// &lt;summary&gt;
		/// Renders the specified tree item.
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;Tree&quot;&gt;The tree.&lt;/param&gt;
		public override void Render(ref XmlDocument Tree)
        {
            MemberType[] MemberTypes = MemberType.GetAll;
            XmlNode root = Tree.DocumentElement;
            for (int i = 0; i &lt; MemberTypes.Length; i++)
            {
                XmlElement treeElement = Tree.CreateElement(&quot;tree&quot;);
                treeElement.SetAttribute(&quot;menu&quot;, &quot;D&quot;);
                treeElement.SetAttribute(&quot;nodeID&quot;, MemberTypes[i].Id.ToString());
                treeElement.SetAttribute(&quot;text&quot;, MemberTypes[i].Text);
                treeElement.SetAttribute(&quot;action&quot;, &quot;javascript:openMemberType(&quot; + MemberTypes[i].Id + &quot;);&quot;);
                treeElement.SetAttribute(&quot;src&quot;, &quot;&quot;);
                treeElement.SetAttribute(&quot;icon&quot;, &quot;icon-users&quot;);
                treeElement.SetAttribute(&quot;openIcon&quot;, &quot;icon-users&quot;);
                treeElement.SetAttribute(&quot;nodeType&quot;, &quot;memberTypes&quot;);
                root.AppendChild(treeElement);
            }
        }
	}
    
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[39,54,39,71,0],[39,72,39,73,0],[39,74,39,75,0],[42,9,42,10,0],[43,13,43,88,0],[46,13,46,56,0],[47,13,47,14,0],[48,5,48,44,0],[49,5,49,30,0],[50,13,50,14,0],[52,13,52,14,0],[53,17,53,33,0],[54,13,54,14,0],[55,9,55,10,0],[62,9,62,10,0],[63,13,68,4,0],[69,9,69,10,0],[77,9,77,10,0],[78,13,78,50,0],[79,13,79,69,0],[80,13,80,30,0],[81,13,81,92,0],[83,4,83,11,0],[83,13,83,29,0],[83,30,83,32,0],[83,33,83,37,0],[84,5,84,36,0],[85,9,85,10,0],[92,9,92,10,0],[93,13,93,58,0],[94,13,94,49,0],[95,18,95,27,0],[95,29,95,51,0],[95,53,95,56,0],[96,13,96,14,0],[97,17,97,69,0],[98,17,98,55,0],[99,17,99,82,0],[100,17,100,71,0],[101,17,101,109,0],[102,17,102,53,0],[103,17,103,64,0],[104,17,104,68,0],[105,17,105,69,0],[106,17,106,47,0],[107,13,107,14,0],[108,9,108,10,0]]);
    </script>
  </body>
</html>