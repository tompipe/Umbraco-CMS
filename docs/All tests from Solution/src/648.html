<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\Trees\TreeRequestParams.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Text;
using System.Web;
using System.Xml;
using System.Configuration;
using umbraco.BasePages;
using umbraco.BusinessLogic;
using umbraco.cms.businesslogic;
using umbraco.cms.businesslogic.cache;
using umbraco.cms.businesslogic.contentitem;
using umbraco.cms.businesslogic.datatype;
using umbraco.cms.businesslogic.language;
using umbraco.cms.businesslogic.media;
using umbraco.cms.businesslogic.member;
using umbraco.cms.businesslogic.property;
using umbraco.cms.businesslogic.web;
using umbraco.interfaces;
using umbraco.DataLayer;
using System.Collections.Specialized;

namespace umbraco.cms.presentation.Trees
{
	/// &lt;summary&gt;
	/// An ITreeService class that returns the values found in the Query String or any dictionary
	/// &lt;/summary&gt;
	internal class TreeRequestParams : ITreeService
	{
		private TreeRequestParams() { }

		private Dictionary&lt;string, string&gt; m_params;

		public static TreeRequestParams FromQueryStrings()
		{
			Dictionary&lt;string, string&gt; p = new Dictionary&lt;string, string&gt;();
			foreach (string key in HttpContext.Current.Request.QueryString.Keys)
			{
                p.Add(key, HttpUtility.HtmlEncode(HttpContext.Current.Request.QueryString[key]));
				//p.Add(item.Key.ToString(), item.Value.ToString());
			}
			return FromDictionary(p);
		}

		public static TreeRequestParams FromDictionary(Dictionary&lt;string, string&gt; items)
		{
			TreeRequestParams treeParams = new TreeRequestParams();
			treeParams.m_params = items;
			return treeParams;
		}

		/// &lt;summary&gt;
		/// Converts the tree parameters to a tree service object
		/// &lt;/summary&gt;
		/// &lt;returns&gt;&lt;/returns&gt;
		public TreeService CreateTreeService()
		{
			return new TreeService()
			{
				ShowContextMenu = this.ShowContextMenu,
				IsDialog = this.IsDialog,
				DialogMode = this.DialogMode,
				App = this.Application,
				TreeType = this.TreeType,
				NodeKey = this.NodeKey,
				StartNodeID = this.StartNodeID,
				FunctionToCall = this.FunctionToCall				
			};
		}

		public string NodeKey
		{
			get
			{
				return (m_params.ContainsKey(&quot;nodeKey&quot;) ? m_params[&quot;nodeKey&quot;] : &quot;&quot;);
			}
		}
		public string Application
		{
			get
			{
				return (m_params.ContainsKey(&quot;app&quot;) ? m_params[&quot;app&quot;] : m_params.ContainsKey(&quot;appAlias&quot;) ? m_params[&quot;appAlias&quot;] : &quot;&quot;);
			}
		}
		public int StartNodeID
		{
			get
			{
				if(m_params.ContainsKey(&quot;id&quot;))
                {
				    int sNodeID;
				    if (int.TryParse(m_params[&quot;id&quot;], out sNodeID))
					    return sNodeID;
                }
				return -1;
			}
		}
		public string FunctionToCall
		{
			get
			{
				return (m_params.ContainsKey(&quot;functionToCall&quot;) ? m_params[&quot;functionToCall&quot;] : &quot;&quot;);
			}
		}
		public bool IsDialog
		{
			get
			{
				bool value;
				if (m_params.ContainsKey(&quot;isDialog&quot;))
					if (bool.TryParse(m_params[&quot;isDialog&quot;], out value))
						return value;
				return false;
			}
		}
		public TreeDialogModes DialogMode
		{
			get
			{
				if (m_params.ContainsKey(&quot;dialogMode&quot;) &amp;&amp; IsDialog)
				{
					try
					{
						return (TreeDialogModes)Enum.Parse(typeof(TreeDialogModes), m_params[&quot;dialogMode&quot;]);
					}
					catch
					{
						return TreeDialogModes.none;
					}
				}
				return TreeDialogModes.none;
			}
		}
		public bool ShowContextMenu
		{
			get
			{
				bool value;
				if (m_params.ContainsKey(&quot;contextMenu&quot;))
					if (bool.TryParse(m_params[&quot;contextMenu&quot;], out value))
						return value;
				return true;
			}
		}
		public string TreeType
		{
			get
			{
				return (m_params.ContainsKey(&quot;treeType&quot;) ? m_params[&quot;treeType&quot;] : &quot;&quot;);
			}
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[32,3,32,30,0],[32,31,32,32,0],[32,33,32,34,0],[37,3,37,4,0],[38,4,38,68,0],[39,4,39,11,0],[39,13,39,23,0],[39,24,39,26,0],[39,27,39,71,0],[40,4,40,5,0],[41,17,41,98,0],[43,4,43,5,0],[44,4,44,29,0],[45,3,45,4,0],[48,3,48,4,0],[49,4,49,59,0],[50,4,50,32,0],[51,4,51,22,0],[52,3,52,4,0],[59,3,59,4,0],[60,4,70,6,0],[71,3,71,4,0],[76,4,76,5,0],[77,5,77,73,0],[78,4,78,5,0],[83,4,83,5,0],[84,5,84,123,0],[85,4,85,5,0],[90,4,90,5,0],[91,5,91,35,0],[92,17,92,18,0],[94,9,94,55,0],[95,10,95,25,0],[96,17,96,18,0],[97,5,97,15,0],[98,4,98,5,0],[103,4,103,5,0],[104,5,104,87,0],[105,4,105,5,0],[110,4,110,5,0],[112,5,112,42,0],[113,6,113,57,0],[114,7,114,20,0],[115,5,115,18,0],[116,4,116,5,0],[121,4,121,5,0],[122,5,122,56,0],[123,5,123,6,0],[125,6,125,7,0],[126,7,126,91,0],[128,6,128,11,0],[129,6,129,7,0],[130,7,130,35,0],[133,5,133,33,0],[134,4,134,5,0],[139,4,139,5,0],[141,5,141,45,0],[142,6,142,60,0],[143,7,143,20,0],[144,5,144,17,0],[145,4,145,5,0],[150,4,150,5,0],[151,5,151,75,0],[152,4,152,5,0]]);
    </script>
  </body>
</html>