<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\Trees\TreeService.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Text;
using System.Web;
using System.Xml;
using System.Configuration;
using umbraco.BasePages;
using umbraco.BusinessLogic;
using umbraco.cms.businesslogic;
using umbraco.cms.businesslogic.cache;
using umbraco.cms.businesslogic.contentitem;
using umbraco.cms.businesslogic.datatype;
using umbraco.cms.businesslogic.language;
using umbraco.cms.businesslogic.media;
using umbraco.cms.businesslogic.member;
using umbraco.cms.businesslogic.property;
using umbraco.cms.businesslogic.web;
using umbraco.interfaces;
using umbraco.DataLayer;
using System.Collections.Specialized;
using Umbraco.Core.IO;
using umbraco.uicontrols;

namespace umbraco.cms.presentation.Trees
{

	/// &lt;summary&gt;
	/// A utility class to aid in creating the URL for returning XML for a tree structure and
	/// for reading the parameters from the URL when a request is made.
	/// &lt;/summary&gt;
	public class TreeService : TreeUrlGenerator, ITreeService
	{

		/// &lt;summary&gt;
		/// Default empty constructor
		/// &lt;/summary&gt;
        public TreeService() : base() { }

		/// &lt;summary&gt;
		/// Constructor to assign all TreeService properties except nodeKey in one call
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;startNodeID&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;treeType&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;showContextMenu&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;isDialog&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;dialogMode&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;app&quot;&gt;&lt;/param&gt;
		public TreeService(int? startNodeID, string treeType, bool? showContextMenu,
			bool? isDialog, TreeDialogModes dialogMode, string app)
		{
            StartNodeID = startNodeID ?? -1;
			TreeType = treeType;
            ShowContextMenu = showContextMenu ?? true;
            IsDialog = isDialog ?? false;
			m_dialogMode = dialogMode;
			App = app;
		}

		/// &lt;summary&gt;
		/// Constructor to assign all TreeService properties in one call
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;startNodeID&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;treeType&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;showContextMenu&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;isDialog&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;dialogMode&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;app&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;nodeKey&quot;&gt;&lt;/param&gt;
		public TreeService(int? startNodeID, string treeType, bool? showContextMenu,
			bool? isDialog, TreeDialogModes dialogMode, string app, string nodeKey)
		{
            StartNodeID = startNodeID ?? -1;
			TreeType = treeType;
            ShowContextMenu = showContextMenu ?? true;
            IsDialog = isDialog ?? false;
			m_dialogMode = dialogMode;
			App = app;
			NodeKey = nodeKey;
		}

		public TreeService(int? startNodeID, string treeType, bool? showContextMenu,
			bool? isDialog, TreeDialogModes dialogMode, string app, string nodeKey, string functionToCall)
		{
			StartNodeID = startNodeID ?? -1;
			TreeType = treeType;
			ShowContextMenu = showContextMenu ?? true;
			IsDialog = isDialog ?? false;
			m_dialogMode = dialogMode;
			App = app;
			NodeKey = nodeKey;
			FunctionToCall = functionToCall;
		}

        private TreeDialogModes m_dialogMode;

		#region Public Properties


		public TreeDialogModes DialogMode
		{
			get { return m_dialogMode; }
			set { m_dialogMode = value; }
		}

		#endregion

		/// &lt;summary&gt;
		/// Static method to return the tree service url with the specified parameters
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;startNodeID&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;treeType&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;showContextMenu&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;isDialog&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;dialogMode&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;app&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;nodeKey&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;functionToCall&quot;&gt;&lt;/param&gt;
		/// &lt;returns&gt;&lt;/returns&gt;
		public static string GetServiceUrl(int? startNodeID, string treeType, bool? showContextMenu,
			bool? isDialog, TreeDialogModes dialogMode, string app, string nodeKey, string functionToCall)
		{
			TreeService treeSvc = new TreeService(startNodeID, treeType, showContextMenu, isDialog, dialogMode, app, nodeKey, functionToCall);
			return treeSvc.GetServiceUrl();
		}

		/// &lt;summary&gt;
		/// static method to return the tree init url with the specified parameters
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;startNodeID&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;treeType&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;showContextMenu&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;isDialog&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;dialogMode&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;app&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;nodeKey&quot;&gt;&lt;/param&gt;
		/// &lt;param name=&quot;functionToCall&quot;&gt;&lt;/param&gt;
		/// &lt;returns&gt;&lt;/returns&gt;
		public static string GetInitUrl(int? startNodeID, string treeType, bool? showContextMenu,
		   bool? isDialog, TreeDialogModes dialogMode, string app, string nodeKey, string functionToCall)
		{
			TreeService treeSvc = new TreeService(startNodeID, treeType, showContextMenu, isDialog, dialogMode, app, nodeKey, functionToCall);
			return treeSvc.GetInitUrl();
		}

        protected override string GetUrl(string pageUrl)
        {
            StringBuilder sb = new StringBuilder(base.GetUrl(pageUrl));
            if (this.DialogMode != TreeDialogModes.none) sb.Append(string.Format(&quot;&amp;dialogMode={0}&quot;, this.DialogMode.ToString()));
            return sb.ToString();
        }

	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[40,32,40,38,0],[40,39,40,40,0],[40,41,40,42,0],[51,3,52,59,0],[53,3,53,4,0],[54,13,54,45,0],[55,4,55,24,0],[56,13,56,55,0],[57,13,57,42,0],[58,4,58,30,0],[59,4,59,14,0],[60,3,60,4,0],[72,3,73,75,0],[74,3,74,4,0],[75,13,75,45,0],[76,4,76,24,0],[77,13,77,55,0],[78,13,78,42,0],[79,4,79,30,0],[80,4,80,14,0],[81,4,81,22,0],[82,3,82,4,0],[84,3,85,98,0],[86,3,86,4,0],[87,4,87,36,0],[88,4,88,24,0],[89,4,89,46,0],[90,4,90,33,0],[91,4,91,30,0],[92,4,92,14,0],[93,4,93,22,0],[94,4,94,36,0],[95,3,95,4,0],[104,8,104,9,0],[104,10,104,30,0],[104,31,104,32,0],[105,8,105,9,0],[105,10,105,31,0],[105,32,105,33,0],[124,3,124,4,0],[125,4,125,134,0],[126,4,126,35,0],[127,3,127,4,0],[143,3,143,4,0],[144,4,144,134,0],[145,4,145,32,0],[146,3,146,4,0],[149,9,149,10,0],[150,13,150,72,0],[151,13,151,57,0],[151,58,151,130,0],[152,13,152,34,0],[153,9,153,10,0]]);
    </script>
  </body>
</html>