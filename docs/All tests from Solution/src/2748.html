<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\checkboxlist\checkboxList.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.ComponentModel;
using System.Collections;
using System.Collections.Generic;

namespace umbraco.editorControls.checkboxlist
{
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
	public class checkboxlistEditor : System.Web.UI.WebControls.CheckBoxList, interfaces.IDataEditor	
	{
		private String _text;

		interfaces.IData _data;
		SortedList _prevalues;
		public checkboxlistEditor(interfaces.IData Data,SortedList Prevalues)
		{
			_data = Data;
			_prevalues = Prevalues;
		}

        List&lt;KeyValuePair&lt;int, String&gt;&gt; Prevalues;
        public checkboxlistEditor(interfaces.IData Data, List&lt;KeyValuePair&lt;int, String&gt;&gt; Prevalues)
        {
            _data = Data;
            this.Prevalues = Prevalues;
        }

		public Control Editor { get {return this;}}

		public virtual bool TreatAsRichTextEditor 
		{
			get {return false;}
		}
		public virtual bool ShowLabel 
		{
			get {return true;}
		}

		public void Save() 
		{
			_text = &quot;&quot;;
			foreach(ListItem li in base.Items) 
			{
				if (li.Selected) 
				{
					_text += li.Value + &quot;,&quot;;
				}
			}

			if (_text.Length &gt; 0)
				_text = _text.Substring(0, _text.Length-1);
			_data.Value = _text;
			
			
		}

		protected override void OnInit(EventArgs e)
		{
			base.OnInit (e);

			if (_data != null &amp;&amp; _data.Value != null &amp;&amp; _data.Value.ToString() != &quot;&quot;)
				_text = _data.Value.ToString();

            if (_prevalues != null)
            {
                foreach (object key in _prevalues.Keys)
                {
                    ListItem li = new ListItem(_prevalues[key].ToString(), key.ToString());

                    if ((&quot;,&quot; + _text + &quot;,&quot;).IndexOf(&quot;,&quot; + li.Value.ToString() + &quot;,&quot;) &gt; -1)
                        li.Selected = true;

                    Items.Add(li);
                }
            }
            else if (Prevalues != null)
            {
                foreach (KeyValuePair&lt;int, String&gt; item in Prevalues)
                {
                    ListItem li = new ListItem(item.Value, item.Key.ToString());

                    if ((&quot;,&quot; + _text + &quot;,&quot;).IndexOf(&quot;,&quot; + li.Value.ToString() + &quot;,&quot;) &gt; -1)
                        li.Selected = true;

                    Items.Add(li);
                }
            }

		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[17,3,17,72,0],[18,3,18,4,0],[19,4,19,17,0],[20,4,20,27,0],[21,3,21,4,0],[24,9,24,100,0],[25,9,25,10,0],[26,13,26,26,0],[27,13,27,40,0],[28,9,28,10,0],[30,31,30,32,0],[30,32,30,44,0],[30,44,30,45,0],[34,8,34,9,0],[34,9,34,22,0],[34,22,34,23,0],[38,8,38,9,0],[38,9,38,21,0],[38,21,38,22,0],[42,3,42,4,0],[43,4,43,15,0],[44,4,44,11,0],[44,12,44,23,0],[44,24,44,26,0],[44,27,44,37,0],[45,4,45,5,0],[46,5,46,21,0],[47,5,47,6,0],[48,6,48,30,0],[49,5,49,6,0],[50,4,50,5,0],[52,4,52,25,0],[53,5,53,48,0],[54,4,54,24,0],[57,3,57,4,0],[60,3,60,4,0],[61,4,61,20,0],[63,4,63,77,0],[64,5,64,36,0],[66,13,66,36,0],[67,13,67,14,0],[68,17,68,24,0],[68,26,68,36,0],[68,37,68,39,0],[68,40,68,55,0],[69,17,69,18,0],[70,21,70,92,0],[72,21,72,91,0],[73,25,73,44,0],[75,21,75,35,0],[76,17,76,18,0],[77,13,77,14,0],[78,18,78,40,0],[79,13,79,14,0],[80,17,80,24,0],[80,26,80,56,0],[80,57,80,59,0],[80,60,80,69,0],[81,17,81,18,0],[82,21,82,81,0],[84,21,84,91,0],[85,25,85,44,0],[87,21,87,35,0],[88,17,88,18,0],[89,13,89,14,0],[91,3,91,4,0]]);
    </script>
  </body>
</html>