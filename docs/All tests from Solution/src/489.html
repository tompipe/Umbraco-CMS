<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\developer\Xslt\xsltInsertValueOf.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Web;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using Umbraco.Core.Configuration;
using umbraco.cms.businesslogic.propertytype;
using Umbraco.Core;

namespace umbraco.developer
{
	/// &lt;summary&gt;
	/// Summary description for xsltInsertValueOf.
	/// &lt;/summary&gt;
    [WebformsPageTreeAuthorize(Constants.Trees.Xslt)]
	public partial class xsltInsertValueOf : BasePages.UmbracoEnsuredPage
	{
		protected void Page_Load(object sender, System.EventArgs e)
		{
		    ArrayList preValuesSource = new ArrayList();

            // Attributes
            string[] attributes = {&quot;@id&quot;, &quot;@parentID&quot;, &quot;@level&quot;, &quot;@writerID&quot;, &quot;@nodeType&quot;, &quot;@template&quot;, &quot;@sortOrder&quot;, &quot;@createDate&quot;, &quot;@creatorName&quot;, &quot;@updateDate&quot;, &quot;@nodeName&quot;, &quot;@urlName&quot;, &quot;@writerName&quot;, &quot;@nodeTypeAlias&quot;, &quot;@path&quot;};
            foreach (string att in attributes)
                preValuesSource.Add(att);

            // generic properties
            string existingGenProps = &quot;,&quot;;
		    var exclude = Constants.Conventions.Member.GetStandardPropertyTypeStubs().Select(x =&gt; x.Key).ToArray();
            foreach (PropertyType pt in PropertyType.GetAll().Where(x =&gt; exclude.Contains(x.Alias) == false))
		    {
                if (!existingGenProps.Contains(&quot;,&quot; + pt.Alias + &quot;,&quot;))
                {
                    if(UmbracoConfig.For.UmbracoSettings().Content.UseLegacyXmlSchema)
                        preValuesSource.Add(string.Format(&quot;data [@alias = &#39;{0}&#39;]&quot;, pt.Alias));
                    else
                        preValuesSource.Add(pt.Alias);

                    existingGenProps += pt.Alias + &quot;,&quot;;
                }
		    }
                

            preValuesSource.Sort();
		    preValues.DataSource = preValuesSource;
			preValues.DataBind();
			preValues.Items.Insert(0, new ListItem(&quot;Prevalues...&quot;, &quot;&quot;));

			preValues.Attributes.Add(&quot;onChange&quot;, &quot;if (this.value != &#39;&#39;) document.getElementById(&#39;&quot; + valueOf.ClientID + &quot;&#39;).value = this.value&quot;);

            if(!String.IsNullOrEmpty(Request.QueryString[&quot;value&quot;]))
                valueOf.Text = Request.QueryString[&quot;value&quot;];
		}

	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[25,3,25,4,0],[26,7,26,51,0],[29,13,29,232,0],[30,13,30,20,0],[30,22,30,32,0],[30,33,30,35,0],[30,36,30,46,0],[31,17,31,42,0],[34,13,34,43,0],[35,7,35,93,0],[35,93,35,98,0],[35,98,35,110,0],[35,7,35,110,0],[36,13,36,20,0],[36,22,36,37,0],[36,38,36,40,0],[36,41,36,74,0],[36,74,36,108,0],[36,108,36,109,0],[36,41,36,109,0],[37,7,37,8,0],[38,17,38,70,0],[39,17,39,18,0],[40,21,40,87,0],[41,25,41,95,0],[43,25,43,55,0],[45,21,45,56,0],[46,17,46,18,0],[47,7,47,8,0],[50,13,50,36,0],[51,7,51,46,0],[52,4,52,25,0],[53,4,53,64,0],[55,4,55,137,0],[57,13,57,68,0],[58,17,58,61,0],[59,3,59,4,0]]);
    </script>
  </body>
</html>