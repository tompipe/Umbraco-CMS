<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\members\ViewMembers.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using Umbraco.Core.Security;

namespace umbraco.presentation.members
{
    public partial class ViewMembers : BasePages.UmbracoEnsuredPage
    {

        public ViewMembers()
        {
            CurrentApp = BusinessLogic.DefaultApps.member.ToString();
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            panel1.Text = ui.Text(&quot;member&quot;);
            BindRp();
        }

        private void BindRp()
        {
            var provider = MembershipProviderExtensions.GetMembersMembershipProvider();
            string letter = Request.QueryString[&quot;letter&quot;];
            if (string.IsNullOrEmpty(letter) == false)
            {
                if (provider.IsUmbracoMembershipProvider())
                {
                    if (letter == &quot;#&quot;)
                    {
                        rp_members.DataSource = cms.businesslogic.member.Member.getAllOtherMembers();
                    }
                    else
                    {
                        rp_members.DataSource = cms.businesslogic.member.Member.getMemberFromFirstLetter(letter.ToCharArray()[0]);
                    }
                }
                else
                {
                    rp_members.DataSource = provider.FindUsersByName(letter + &quot;%&quot;);
                }
                rp_members.DataBind();
            }
        }

        public void bindMember(object sender, RepeaterItemEventArgs e)
        {
            var provider = MembershipProviderExtensions.GetMembersMembershipProvider();
            if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
            {
                if (provider.IsUmbracoMembershipProvider())
                {
                    cms.businesslogic.member.Member mem = (cms.businesslogic.member.Member)e.Item.DataItem;
                    Literal _name = (Literal)e.Item.FindControl(&quot;lt_name&quot;);
                    Literal _email = (Literal)e.Item.FindControl(&quot;lt_email&quot;);
                    Literal _login = (Literal)e.Item.FindControl(&quot;lt_login&quot;);
                    Button _button = (Button)e.Item.FindControl(&quot;bt_delete&quot;);

                    _name.Text = &quot;&lt;a href=&#39;editMember.aspx?id=&quot; + mem.Id.ToString() + &quot;&#39;&gt;&quot; + mem.Text + &quot;&lt;/a&gt;&quot;;
                    _login.Text = mem.LoginName;
                    _email.Text = mem.Email;

                    _button.CommandArgument = mem.Id.ToString();
                    _button.OnClientClick = &quot;return confirm(\&quot;&quot; + ui.Text(&quot;confirmdelete&quot;) + &quot;&#39;&quot; + mem.Text + &quot;&#39; ?\&quot;)&quot;;
                    _button.Text = ui.Text(&quot;delete&quot;);
                }
                else
                {
                    var mem = (MembershipUser)e.Item.DataItem;
                    Literal _name = (Literal)e.Item.FindControl(&quot;lt_name&quot;);
                    Literal _email = (Literal)e.Item.FindControl(&quot;lt_email&quot;);
                    Literal _login = (Literal)e.Item.FindControl(&quot;lt_login&quot;);
                    Button _button = (Button)e.Item.FindControl(&quot;bt_delete&quot;);

                    _name.Text = &quot;&lt;a href=&#39;editMember.aspx?id=&quot; + mem.UserName + &quot;&#39;&gt;&quot; + mem.UserName + &quot;&lt;/a&gt;&quot;;
                    _login.Text = mem.UserName;
                    _email.Text = mem.Email;
                    _button.Visible = false;

                }
            }
        }

        public void deleteMember(object sender, CommandEventArgs e)
        {
            int memid = 0;

            if (int.TryParse(e.CommandArgument.ToString(), out memid))
            {
                cms.businesslogic.member.Member mem = new global::umbraco.cms.businesslogic.member.Member(memid);

                if (mem != null)
                    mem.delete();


                BindRp();
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,29,0],[15,9,15,10,0],[16,13,16,70,0],[17,9,17,10,0],[20,9,20,10,0],[21,13,21,45,0],[22,13,22,22,0],[23,9,23,10,0],[26,9,26,10,0],[27,13,27,88,0],[28,13,28,59,0],[29,13,29,55,0],[30,13,30,14,0],[31,17,31,60,0],[32,17,32,18,0],[33,21,33,39,0],[34,21,34,22,0],[35,25,35,102,0],[36,21,36,22,0],[38,21,38,22,0],[39,25,39,131,0],[40,21,40,22,0],[41,17,41,18,0],[43,17,43,18,0],[44,21,44,84,0],[45,17,45,18,0],[46,17,46,39,0],[47,13,47,14,0],[48,9,48,10,0],[51,9,51,10,0],[52,13,52,88,0],[53,13,53,105,0],[54,13,54,14,0],[55,17,55,60,0],[56,17,56,18,0],[57,21,57,108,0],[58,21,58,76,0],[59,21,59,78,0],[60,21,60,78,0],[61,21,61,78,0],[63,21,63,112,0],[64,21,64,49,0],[65,21,65,45,0],[67,21,67,65,0],[68,21,68,120,0],[69,21,69,54,0],[70,17,70,18,0],[72,17,72,18,0],[73,21,73,63,0],[74,21,74,76,0],[75,21,75,78,0],[76,21,76,78,0],[77,21,77,78,0],[79,21,79,111,0],[80,21,80,48,0],[81,21,81,45,0],[82,21,82,45,0],[84,17,84,18,0],[85,13,85,14,0],[86,9,86,10,0],[89,9,89,10,0],[90,13,90,27,0],[92,13,92,71,0],[93,13,93,14,0],[94,17,94,114,0],[96,17,96,33,0],[97,21,97,34,0],[100,17,100,26,0],[101,13,101,14,0],[102,9,102,10,0]]);
    </script>
  </body>
</html>