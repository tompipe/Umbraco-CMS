<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\PropertyTypePicker.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Linq;

namespace umbraco.editorControls
{
	/// &lt;summary&gt;
	/// Summary description for propertyTypePicker.
	/// &lt;/summary&gt;
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class PropertyTypePicker : System.Web.UI.WebControls.ListBox, interfaces.IMacroGuiRendering
	{
		string _value = &quot;&quot;;
		bool _multiple = false;

		public bool ShowCaption 
		{
			get {return true;}
		}

		public virtual bool Multiple 
		{
			set {_multiple = value;}
			get {return _multiple;}
		}

		public string Value 
		{
			get 
			{
				string retVal = &quot;&quot;;
				foreach(System.Web.UI.WebControls.ListItem i in base.Items) 
					if (i.Selected)
						retVal += i.Value + &quot;,&quot;;

				if (retVal != &quot;&quot;)
					retVal = retVal.Substring(0, retVal.Length-1);

				return retVal;
			}
			set 
			{
				_value = value;
			}
		}
        
		protected override void OnInit(EventArgs e)
		{
			base.OnInit (e);
			
			this.CssClass = &quot;guiInputTextStandard&quot;;

			// Check for multiple choises
			if (_multiple) 
			{
				this.SelectionMode = System.Web.UI.WebControls.ListSelectionMode.Multiple;
				this.Rows = 5;
				this.Multiple =true;
			} 
			else 
			{
				this.Rows = 1;
				this.Items.Add(new System.Web.UI.WebControls.ListItem(&quot;&quot;, &quot;&quot;));
				this.SelectionMode = System.Web.UI.WebControls.ListSelectionMode.Single;
			}

			Hashtable ht = new Hashtable();
			foreach(cms.businesslogic.propertytype.PropertyType pt in cms.businesslogic.propertytype.PropertyType.GetAll().OrderBy(x =&gt; x.Name))
			{
				if (!ht.ContainsKey(pt.Alias)) 
				{
					System.Web.UI.WebControls.ListItem li = new System.Web.UI.WebControls.ListItem(pt.Alias);
					if (((string) (&quot;, &quot;+_value+&quot;,&quot;)).IndexOf(&quot;, &quot;+pt.Alias+&quot;,&quot;) &gt; -1)
						li.Selected = true;
					ht.Add(pt.Alias, &quot;&quot;);

					this.Items.Add(li);
				}
			}

		}

	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[13,3,13,22,0],[14,3,14,26,0],[18,8,18,9,0],[18,9,18,21,0],[18,21,18,22,0],[23,8,23,9,0],[23,9,23,27,0],[23,27,23,28,0],[24,8,24,9,0],[24,9,24,26,0],[24,26,24,27,0],[30,4,30,5,0],[31,5,31,24,0],[32,5,32,12,0],[32,13,32,49,0],[32,50,32,52,0],[32,53,32,63,0],[33,6,33,21,0],[34,7,34,31,0],[36,5,36,22,0],[37,6,37,52,0],[39,5,39,19,0],[40,4,40,5,0],[42,4,42,5,0],[43,5,43,20,0],[44,4,44,5,0],[48,3,48,4,0],[49,4,49,20,0],[51,4,51,43,0],[54,4,54,18,0],[55,4,55,5,0],[56,5,56,79,0],[57,5,57,19,0],[58,5,58,25,0],[59,4,59,5,0],[61,4,61,5,0],[62,5,62,19,0],[63,5,63,68,0],[64,5,64,77,0],[65,4,65,5,0],[67,4,67,35,0],[68,4,68,11,0],[68,12,68,58,0],[68,59,68,61,0],[68,62,68,128,0],[68,128,68,134,0],[68,134,68,135,0],[68,62,68,135,0],[69,4,69,5,0],[70,5,70,35,0],[71,5,71,6,0],[72,6,72,95,0],[73,6,73,71,0],[74,7,74,26,0],[75,6,75,27,0],[77,6,77,25,0],[78,5,78,6,0],[79,4,79,5,0],[81,3,81,4,0]]);
    </script>
  </body>
</html>