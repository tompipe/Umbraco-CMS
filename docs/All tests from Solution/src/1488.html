<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Macros\XsltExtensionsResolver.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using Umbraco.Core.Logging;
using Umbraco.Core.ObjectResolution;

namespace Umbraco.Core.Macros
{
    /// &lt;summary&gt;
    /// Used to resolve all xslt extension plugins
    /// &lt;/summary&gt;
    internal sealed class XsltExtensionsResolver : LazyManyObjectsResolverBase&lt;XsltExtensionsResolver, XsltExtension&gt;
    {
        /// &lt;summary&gt;
        /// Constructor
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;serviceProvider&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;logger&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;packageActions&quot;&gt;&lt;/param&gt;		
        internal XsltExtensionsResolver(IServiceProvider serviceProvider, ILogger logger, Func&lt;IEnumerable&lt;Type&gt;&gt; packageActions)
            : base(serviceProvider, logger, packageActions, ObjectLifetimeScope.Application)
		{

		}

        /// &lt;summary&gt;
        /// Returns the list of all xslt extensions
        /// &lt;/summary&gt;
        public IEnumerable&lt;XsltExtension&gt; XsltExtensions
		{
			get { return Values; }
		}

        protected override IEnumerable&lt;XsltExtension&gt; CreateInstances()
        {
            var result = new HashSet&lt;XsltExtension&gt;();
            foreach (var xsltType in InstanceTypes)
            {
                var tpAttributes = xsltType.GetCustomAttributes(typeof(XsltExtensionAttribute), true);
                foreach (XsltExtensionAttribute tpAttribute in tpAttributes)
                {
                    var ns = string.IsNullOrEmpty(tpAttribute.Namespace) == false
                        ? tpAttribute.Namespace
                        : xsltType.FullName;

                    result.Add(new XsltExtension(ns, Activator.CreateInstance(xsltType)));
                }
            }
            return result;
        }

        /// &lt;summary&gt;
        /// We override this because really there&#39;s no limit to the type that can be used here
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        protected override void EnsureCorrectType(Type value)
        {
            //do nothing.
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[20,15,20,93,1],[21,3,21,4,1],[23,3,23,4,1],[30,8,30,9,1],[30,10,30,24,1],[30,25,30,26,1],[34,9,34,10,1],[35,13,35,55,1],[36,13,36,20,1],[36,22,36,34,1],[36,35,36,37,1],[36,38,36,51,1],[37,13,37,14,1],[38,17,38,103,1],[39,17,39,24,1],[39,26,39,60,1],[39,61,39,63,1],[39,64,39,76,1],[40,17,40,18,1],[41,21,43,45,1],[45,21,45,91,1],[46,17,46,18,1],[47,13,47,14,1],[48,13,48,27,1],[49,9,49,10,1],[56,9,56,10,1],[58,9,58,10,1]]);
    </script>
  </body>
</html>