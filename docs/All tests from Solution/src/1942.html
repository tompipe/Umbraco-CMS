<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Media\Exif\ExifFileTypeDescriptor.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.ComponentModel;

namespace Umbraco.Core.Media.Exif
{
    /// &lt;summary&gt;
    /// Provides a custom type descriptor for an ExifFile instance.
    /// &lt;/summary&gt;
    internal sealed class ExifFileTypeDescriptionProvider : TypeDescriptionProvider
    {
        public ExifFileTypeDescriptionProvider()
            : this(TypeDescriptor.GetProvider(typeof(ImageFile)))
        {
        }

        public ExifFileTypeDescriptionProvider(TypeDescriptionProvider parent)
            : base(parent)
        {
        }

        /// &lt;summary&gt;
        /// Gets a custom type descriptor for the given type and object.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;objectType&quot;&gt;The type of object for which to retrieve the type descriptor.&lt;/param&gt;
        /// &lt;param name=&quot;instance&quot;&gt;An instance of the type. Can be null if no instance was passed to the &lt;see cref=&quot;T:System.ComponentModel.TypeDescriptor&quot;/&gt;.&lt;/param&gt;
        /// &lt;returns&gt;
        /// An &lt;see cref=&quot;T:System.ComponentModel.ICustomTypeDescriptor&quot;/&gt; that can provide metadata for the type.
        /// &lt;/returns&gt;
        public override ICustomTypeDescriptor GetTypeDescriptor(Type objectType, object instance)
        {
            return new ExifFileTypeDescriptor(base.GetTypeDescriptor(objectType, instance), instance);
        }
    }

    /// &lt;summary&gt;
    /// Expands ExifProperty objects contained in an ExifFile as separate properties.
    /// &lt;/summary&gt;
    internal sealed class ExifFileTypeDescriptor : CustomTypeDescriptor
    {
        ImageFile owner;

        public ExifFileTypeDescriptor(ICustomTypeDescriptor parent, object instance)
            : base(parent)
        {
            owner = (ImageFile)instance;
        }
        public override PropertyDescriptorCollection GetProperties(Attribute[] attributes)
        {
            return GetProperties();
        }
        /// &lt;summary&gt;
        /// Returns a collection of property descriptors for the object represented by this type descriptor.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;
        /// A &lt;see cref=&quot;T:System.ComponentModel.PropertyDescriptorCollection&quot;/&gt; containing the property descriptions for the object represented by this type descriptor. The default is &lt;see cref=&quot;F:System.ComponentModel.PropertyDescriptorCollection.Empty&quot;/&gt;.
        /// &lt;/returns&gt;
        public override PropertyDescriptorCollection GetProperties()
        {
            // Enumerate the original set of properties and create our new set with it
            List&lt;PropertyDescriptor&gt; properties = new List&lt;PropertyDescriptor&gt;();

            foreach (ExifProperty prop in owner.Properties)
            {
                ExifPropertyDescriptor pd = new ExifPropertyDescriptor(prop);
                properties.Add(pd);
            }

            // Finally return the list
            return new PropertyDescriptorCollection(properties.ToArray(), true);
        }
    }
    internal sealed class ExifPropertyDescriptor : PropertyDescriptor
    {
        object originalValue;
        ExifProperty linkedProperty;

        public ExifPropertyDescriptor(ExifProperty property)
            : base(property.Name, new Attribute[] { new BrowsableAttribute(true) })
        {
            linkedProperty = property;
            originalValue = property.Value;
        }

        public override bool CanResetValue(object component)
        {
            return true;
        }

        public override Type ComponentType
        {
            get { return typeof(JPEGFile); }
        }

        public override object GetValue(object component)
        {
            return linkedProperty.Value;
        }

        public override bool IsReadOnly
        {
            get { return false; }
        }

        public override Type PropertyType
        {
            get { return linkedProperty.Value.GetType(); }
        }

        public override void ResetValue(object component)
        {
            linkedProperty.Value = originalValue;
        }

        public override void SetValue(object component, object value)
        {
            linkedProperty.Value = value;
        }

        public override bool ShouldSerializeValue(object component)
        {
            return false;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[13,15,13,66,0],[14,9,14,10,0],[15,9,15,10,0],[18,15,18,27,0],[19,9,19,10,0],[20,9,20,10,0],[31,9,31,10,0],[32,13,32,103,0],[33,9,33,10,0],[44,15,44,27,0],[45,9,45,10,0],[46,13,46,41,0],[47,9,47,10,0],[49,9,49,10,0],[50,13,50,36,0],[51,9,51,10,0],[59,9,59,10,0],[61,13,61,82,0],[63,13,63,20,0],[63,22,63,39,0],[63,40,63,42,0],[63,43,63,59,0],[64,13,64,14,0],[65,17,65,78,0],[66,17,66,36,0],[67,13,67,14,0],[70,13,70,81,0],[71,9,71,10,0],[79,15,79,84,0],[80,9,80,10,0],[81,13,81,39,0],[82,13,82,44,0],[83,9,83,10,0],[86,9,86,10,0],[87,13,87,25,0],[88,9,88,10,0],[92,17,92,18,0],[92,19,92,43,0],[92,44,92,45,0],[96,9,96,10,0],[97,13,97,41,0],[98,9,98,10,0],[102,17,102,18,0],[102,19,102,32,0],[102,33,102,34,0],[107,17,107,18,0],[107,19,107,57,0],[107,58,107,59,0],[111,9,111,10,0],[112,13,112,50,0],[113,9,113,10,0],[116,9,116,10,0],[117,13,117,42,0],[118,9,118,10,0],[121,9,121,10,0],[122,13,122,26,0],[123,9,123,10,0]]);
    </script>
  </body>
</html>