<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\MultiNodeTreePicker\HttpCookieExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using System.Web;

namespace umbraco.editorControls.MultiNodeTreePicker
{

    /// &lt;summary&gt;
    ///  A helper class to store and retrieve cookie values for the MNTP cookie.
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// The cookie is used to persist values from the client to the server since 
    /// it is much more complicated to try to persist these values between ajax request, 
    /// given the tree&#39;s current architecture.
    /// &lt;/remarks&gt;
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public static class HttpCookieExtensions
    {

        private enum CookieVals
        {
            /// &lt;summary&gt;
            /// XPath filter
            /// &lt;/summary&gt;
            Xpf,
            /// &lt;summary&gt;
            /// XPath filter type
            /// &lt;/summary&gt;
            Xpft,
            /// &lt;summary&gt;
            /// Start node
            /// &lt;/summary&gt;
            Sn,
            /// &lt;summary&gt;
            /// Start node xpath expression type
            /// &lt;/summary&gt;
            Snxet,
            /// &lt;summary&gt;
            /// Start node select type
            /// &lt;/summary&gt;
            Snst,
            /// &lt;summary&gt;
            /// Start node xpath expression
            /// &lt;/summary&gt;
            Snxe,
            /// &lt;summary&gt;
            /// Current editing node id
            /// &lt;/summary&gt;
            Ceni
        }


        #region Setters

        internal static void MntpAddXPathFilter(this HttpCookie c, int id, string xpath)
        {
            c[string.Concat(CookieVals.Xpf, &quot;_&quot;, id)] = xpath;
        }

        internal static void MntpAddXPathFilterType(this HttpCookie c, int id, XPathFilterType type)
        {
            c[string.Concat(CookieVals.Xpft, &quot;_&quot;, id)] = ((int)type).ToString();
        }

        internal static void MntpAddStartNodeId(this HttpCookie c, int id, int startNodeId)
        {
            c[string.Concat(CookieVals.Sn, &quot;_&quot;, id)] = startNodeId.ToString();
        }

        internal static void MntpAddStartNodeXPathExpressionType(this HttpCookie c, int id, XPathExpressionType xPathExpressionType)
        {
            c[string.Concat(CookieVals.Snxet, &quot;_&quot;, id)] = ((int)xPathExpressionType).ToString();
        }

        internal static void MntpAddStartNodeSelectionType(this HttpCookie c, int id, NodeSelectionType startNodeSelectionType)
        {
            c[string.Concat(CookieVals.Snst, &quot;_&quot;, id)] = ((int)startNodeSelectionType).ToString();
        }

        internal static void MntpAddStartNodeXPathExpression(this HttpCookie c, int id, string xPathExpression)
        {
            c[string.Concat(CookieVals.Snxe, &quot;_&quot;, id)] = xPathExpression;
        }

        internal static void MntpAddCurrentEditingNode(this HttpCookie c, int id, int currEditingNodeId)
        {
            c[string.Concat(CookieVals.Ceni, &quot;_&quot;, id)] = currEditingNodeId.ToString();
        }

        #endregion

        #region Getters

        internal static string MntpGetXPathFilter(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Xpf, dataTypeId)
                       ? c.Values[string.Concat(CookieVals.Xpf, &quot;_&quot;, dataTypeId)]
                       : string.Empty;
        }

        internal static XPathFilterType MntpGetXPathFilterType(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Xpft, dataTypeId)
                       ? (XPathFilterType) Enum.ToObject(typeof (XPathFilterType),
                                                         int.Parse(
                                                             c.Values[string.Concat(CookieVals.Xpft, &quot;_&quot;, dataTypeId)]))
                       : XPathFilterType.Disable;
        }

        internal static int MntpGetStartNodeId(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Sn, dataTypeId)
                       ? int.Parse(c.Values[string.Concat(CookieVals.Sn, &quot;_&quot;, dataTypeId)])
                       : -1;
        }

        internal static XPathExpressionType MntpGetStartNodeXPathExpressionType(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Snxet, dataTypeId)
                       ? (XPathExpressionType)
                         Enum.ToObject(typeof(XPathExpressionType),
                                       int.Parse(c.Values[string.Concat(CookieVals.Snxet, &quot;_&quot;, dataTypeId)]))
                       : XPathExpressionType.Global;
        }

        internal static NodeSelectionType MntpGetStartNodeSelectionType(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Snst, dataTypeId)
                       ? (NodeSelectionType)
                         Enum.ToObject(typeof(NodeSelectionType),
                                       int.Parse(c.Values[string.Concat(CookieVals.Snst, &quot;_&quot;, dataTypeId)]))
                       : NodeSelectionType.Picker;
        }

        internal static string MntpGetStartNodeXPathExpression(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Snxe, dataTypeId)
                ? c.Values[string.Concat(CookieVals.Snxe, &quot;_&quot;, dataTypeId)]
                : string.Empty;
        }

        internal static int MntpGetCurrentEditingNode(this HttpCookie c, int dataTypeId)
        {
            return c.ValidateCookieVal(CookieVals.Ceni, dataTypeId)
                       ? int.Parse(c.Values[string.Concat(CookieVals.Ceni, &quot;_&quot;, dataTypeId)])
                       : -1;
        }

        private static bool ValidateCookieVal(this HttpCookie c, CookieVals val, int dataTypeId)
        {
            return dataTypeId == 0 ? false : (c.Values.Keys.Cast&lt;string&gt;().Where(x =&gt; x == string.Concat(val, &quot;_&quot;, dataTypeId)).Any());
        }

        #endregion
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[56,9,56,10,0],[57,13,57,63,0],[58,9,58,10,0],[61,9,61,10,0],[62,13,62,81,0],[63,9,63,10,0],[66,9,66,10,0],[67,13,67,79,0],[68,9,68,10,0],[71,9,71,10,0],[72,13,72,97,0],[73,9,73,10,0],[76,9,76,10,0],[77,13,77,99,0],[78,9,78,10,0],[81,9,81,10,0],[82,13,82,74,0],[83,9,83,10,0],[86,9,86,10,0],[87,13,87,87,0],[88,9,88,10,0],[95,9,95,10,0],[96,13,98,39,0],[99,9,99,10,0],[102,9,102,10,0],[103,13,107,50,0],[108,9,108,10,0],[111,9,111,10,0],[112,13,114,29,0],[115,9,115,10,0],[118,9,118,10,0],[119,13,123,53,0],[124,9,124,10,0],[127,9,127,10,0],[128,13,132,51,0],[133,9,133,10,0],[136,9,136,10,0],[137,13,139,32,0],[140,9,140,10,0],[143,9,143,10,0],[144,13,146,29,0],[147,9,147,10,0],[150,9,150,10,0],[151,13,151,87,0],[151,87,151,127,0],[151,127,151,136,0],[151,13,151,136,0],[152,9,152,10,0]]);
    </script>
  </body>
</html>