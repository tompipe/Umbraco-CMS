<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Cache\StaticCacheProvider.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;

namespace Umbraco.Core.Cache
{
    /// &lt;summary&gt;
    /// Represents a cache provider that statically caches item in a concurrent dictionary.
    /// &lt;/summary&gt;
    public class StaticCacheProvider : ICacheProvider
    {
        internal readonly ConcurrentDictionary&lt;string, object&gt; StaticCache = new ConcurrentDictionary&lt;string, object&gt;();

        public virtual void ClearAllCache()
        {
            StaticCache.Clear();
        }

        public virtual void ClearCacheItem(string key)
        {
            object val;
            StaticCache.TryRemove(key, out val);
        }

        public virtual void ClearCacheObjectTypes(string typeName)
        {
            StaticCache.RemoveAll(kvp =&gt; kvp.Value != null &amp;&amp; kvp.Value.GetType().ToString().InvariantEquals(typeName));
        }

        public virtual void ClearCacheObjectTypes&lt;T&gt;()
        {
            var typeOfT = typeof(T);
            StaticCache.RemoveAll(kvp =&gt; kvp.Value != null &amp;&amp; kvp.Value.GetType() == typeOfT);
        }

        public virtual void ClearCacheObjectTypes&lt;T&gt;(Func&lt;string, T, bool&gt; predicate)
        {
            var typeOfT = typeof(T);
            StaticCache.RemoveAll(kvp =&gt; kvp.Value != null &amp;&amp; kvp.Value.GetType() == typeOfT &amp;&amp; predicate(kvp.Key, (T)kvp.Value));
        }

        public virtual void ClearCacheByKeySearch(string keyStartsWith)
        {
            StaticCache.RemoveAll(kvp =&gt; kvp.Key.InvariantStartsWith(keyStartsWith));
        }

        public virtual void ClearCacheByKeyExpression(string regexString)
        {
            StaticCache.RemoveAll(kvp =&gt; Regex.IsMatch(kvp.Key, regexString)); 
        }

        public virtual IEnumerable&lt;object&gt; GetCacheItemsByKeySearch(string keyStartsWith)
        {
            return (from KeyValuePair&lt;string, object&gt; c in StaticCache
                    where c.Key.InvariantStartsWith(keyStartsWith)
                    select c.Value).ToList();
        }

        public IEnumerable&lt;object&gt; GetCacheItemsByKeyExpression(string regexString)
        {
            return (from KeyValuePair&lt;string, object&gt; c in StaticCache
                    where Regex.IsMatch(c.Key, regexString) 
                    select c.Value).ToList();
        }

        public virtual object GetCacheItem(string cacheKey)
        {
            var result = StaticCache[cacheKey];
            return result;
        }

        public virtual object GetCacheItem(string cacheKey, Func&lt;object&gt; getCacheItem)
        {
            return StaticCache.GetOrAdd(cacheKey, key =&gt; getCacheItem());
        }        
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,121,1],[17,9,17,10,1],[18,13,18,33,1],[19,9,19,10,1],[22,9,22,10,1],[24,13,24,49,1],[25,9,25,10,1],[28,9,28,10,1],[29,13,29,42,1],[29,42,29,119,1],[29,119,29,121,1],[29,13,29,121,1],[30,9,30,10,1],[33,9,33,10,1],[34,13,34,37,1],[35,13,35,42,1],[35,42,35,93,1],[35,93,35,95,1],[35,13,35,95,1],[36,9,36,10,1],[39,9,39,10,0],[40,13,40,37,0],[41,13,41,42,0],[41,42,41,129,0],[41,129,41,131,0],[41,13,41,131,0],[42,9,42,10,0],[45,9,45,10,1],[46,13,46,42,1],[46,42,46,84,1],[46,84,46,86,1],[46,13,46,86,1],[47,9,47,10,1],[50,9,50,10,1],[51,13,51,42,1],[51,42,51,77,1],[51,77,51,79,1],[51,13,51,79,1],[52,9,52,10,1],[55,9,55,10,1],[56,13,57,27,1],[57,27,57,67,1],[57,67,58,28,1],[58,28,58,35,1],[58,35,58,46,1],[56,13,58,46,1],[59,9,59,10,1],[62,9,62,10,0],[63,13,64,27,0],[64,27,64,60,0],[64,60,65,28,0],[65,28,65,35,0],[65,35,65,46,0],[63,13,65,46,0],[66,9,66,10,0],[69,9,69,10,0],[70,13,70,48,0],[71,13,71,27,0],[72,9,72,10,0],[75,9,75,10,1],[76,13,76,58,1],[76,58,76,72,1],[76,72,76,74,1],[76,13,76,74,1],[77,9,77,10,1]]);
    </script>
  </body>
</html>