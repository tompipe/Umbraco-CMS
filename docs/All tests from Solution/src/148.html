<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Integration\CreateContent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Runtime.InteropServices;
using System.Threading;
using NUnit.Framework;
using OpenQA.Selenium;
using OpenQA.Selenium.Interactions;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Integration
{
    [Ignore(&quot;We don&#39;t want to run Selenium tests on TeamCity&quot;)]
    [TestFixture]
    public class CreateContent : BaseSeleniumTest
    {
        [SetUp]
        public override void Initialize()
        {
            base.Initialize();
        }

        [TearDown]
        public void TearDown()
        {
            base.TearDown();
        }

        [Test]
        public void Install_StarterKit_And_Create_Textpage()
        {
            // Login to Umbraco
            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/login.aspx?redir=&quot;);
            Driver.FindElement(By.Id(&quot;lname&quot;)).Clear();
            Driver.FindElement(By.Id(&quot;lname&quot;)).SendKeys(&quot;admin&quot;);
            Driver.FindElement(By.Id(&quot;passw&quot;)).Clear();
            Driver.FindElement(By.Id(&quot;passw&quot;)).SendKeys(&quot;test&quot;);
            Driver.FindElement(By.Id(&quot;Button1&quot;)).Click();
            Thread.Sleep(500);

            // Install starter kit
            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/umbraco.aspx#developer&quot;);
            Thread.Sleep(2000);

            var builder = new Actions(Driver);
            var packagesNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;init&#39;][3]&quot;));
            builder.MoveToElement(packagesNode).DoubleClick().Build().Perform();
            Thread.Sleep(500);

            var installStarterKitNode = Driver.FindElement(By.XPath(&quot;(//li[@id=&#39;-1&#39;]/a/div)[4]&quot;));
            builder.MoveToElement(installStarterKitNode).Click().Build().Perform();
            Thread.Sleep(500);

            var rightFrame = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;right&#39;]&quot;));
            Driver.SwitchTo().Frame(rightFrame);
            Thread.Sleep(500);

            var simpleKit = Driver.FindElement(By.XPath(&quot;/html/body/form/div[2]/div[2]/div/div/div/div/div[4]/nav/ul/li[1]/a&quot;));
            builder.MoveToElement(simpleKit).Click().Build().Perform();
            Thread.Sleep(6000);

            // Create new content
            Driver.SwitchTo().DefaultContent();
            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/umbraco.aspx#content&quot;);
            Thread.Sleep(500);

            var contentNode = Driver.FindElement(By.XPath(&quot;//*[@id = &#39;JTree_TreeContainer&#39;]/div/ul/li/ul/li/a/div&quot;));
            builder.MoveToElement(contentNode).ContextClick().Build().Perform();
            Thread.Sleep(1000);

            var createButton = Driver.FindElement(By.XPath(&quot;//*[@id = &#39;jstree-contextmenu&#39;]/li[1]/a/span/div[2]&quot;));
            createButton.Click();
            Thread.Sleep(500);

            var umbracoModalBoxIframe = Driver.FindElement(By.CssSelector(&quot;.umbModalBoxIframe&quot;));
            Driver.SwitchTo().Frame(umbracoModalBoxIframe);

            var createTextBox = Driver.FindElement(By.XPath(&quot;//input[@type=&#39;text&#39;][1]&quot;));
            createTextBox.Clear();
            createTextBox.SendKeys(&quot;Test Page&quot;);

            var submitButton = Driver.FindElement(By.XPath(&quot;//input[@type=&#39;submit&#39;][1]&quot;));
            submitButton.Click();
            Thread.Sleep(2000);

            Driver.SwitchTo().Frame(rightFrame);
            var saveAndPublishButton = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;body_TabView1_tab01layer_publish&#39;]&quot;));
            saveAndPublishButton.Click();
            Thread.Sleep(2000);

            var contentArea = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;body_TabView1&#39;]&quot;));
            Assert.IsNotNull(contentArea);
            Thread.Sleep(500);

            // Perform delete
            Driver.SwitchTo().DefaultContent();
            var installingModulesNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;1052&#39;]/a/div&quot;));
            builder.MoveToElement(installingModulesNode).ContextClick().Build().Perform();
            Thread.Sleep(1000);

            var deleteButton = Driver.FindElement(By.CssSelector(&quot;.sprDelete&quot;));
            deleteButton.Click();
            var alert = Driver.SwitchTo().Alert();
            alert.Accept();
            Thread.Sleep(1000);

            // Perform move
            var goFurtherNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;1053&#39;]/a/div&quot;));
            builder.MoveToElement(goFurtherNode).ContextClick().Build().Perform();
            Thread.Sleep(1000);

            var moveButton = Driver.FindElement(By.CssSelector(&quot;.sprMove&quot;));
            moveButton.Click();
            Thread.Sleep(2000);

            umbracoModalBoxIframe = Driver.FindElement(By.CssSelector(&quot;.umbModalBoxIframe&quot;));
            Driver.SwitchTo().Frame(umbracoModalBoxIframe);

            var rootNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;1051&#39;]&quot;));
            builder.MoveToElement(rootNode).DoubleClick().Build().Perform();
            Thread.Sleep(500);
            var gettinStartedNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;1055&#39;]/a/div&quot;));
            builder.MoveToElement(gettinStartedNode).Click().Build().Perform();
            Thread.Sleep(500);
            submitButton = Driver.FindElement(By.XPath(&quot;//input[@type=&#39;submit&#39;][1]&quot;));
            builder.MoveToElement(submitButton).Click().Build().Perform();
            Thread.Sleep(2000);
            var closeLink = Driver.FindElement(By.XPath(&quot;/html/body/form/div[2]/p[2]/a&quot;));
            builder.MoveToElement(closeLink).Click().Build().Perform();
            
            Driver.SwitchTo().DefaultContent();
            Thread.Sleep(1000);

            // Perform copy
            var gettingStartedNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;1054&#39;]/a/div&quot;));
            builder.MoveToElement(gettingStartedNode).ContextClick().Build().Perform();
            Thread.Sleep(1000);

            var copyButton = Driver.FindElement(By.CssSelector(&quot;.sprCopy&quot;));
            copyButton.Click();
            Thread.Sleep(2000);

            umbracoModalBoxIframe = Driver.FindElement(By.CssSelector(&quot;.umbModalBoxIframe&quot;));
            Driver.SwitchTo().Frame(umbracoModalBoxIframe);

            rootNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;1051&#39;]&quot;));
            builder.MoveToElement(rootNode).DoubleClick().Build().Perform();
            Thread.Sleep(500);
            
            submitButton = Driver.FindElement(By.XPath(&quot;//input[@type=&#39;submit&#39;][1]&quot;));
            builder.MoveToElement(submitButton).Click().Build().Perform();
            Thread.Sleep(2000);
            closeLink = Driver.FindElement(By.XPath(&quot;/html/body/form/div[2]/p[2]/a&quot;));
            builder.MoveToElement(closeLink).Click().Build().Perform();
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[17,9,17,10,0],[18,13,18,31,0],[19,9,19,10,0],[23,9,23,10,0],[24,13,24,29,0],[25,9,25,10,0],[29,9,29,10,0],[31,13,31,79,0],[32,13,32,56,0],[33,13,33,66,0],[34,13,34,56,0],[35,13,35,65,0],[36,13,36,58,0],[37,13,37,31,0],[40,13,40,84,0],[41,13,41,32,0],[43,13,43,47,0],[44,13,44,83,0],[45,13,45,81,0],[46,13,46,31,0],[48,13,48,99,0],[49,13,49,84,0],[50,13,50,31,0],[52,13,52,79,0],[53,13,53,49,0],[54,13,54,31,0],[56,13,56,129,0],[57,13,57,72,0],[58,13,58,32,0],[61,13,61,48,0],[62,13,62,82,0],[63,13,63,31,0],[65,13,65,118,0],[66,13,66,81,0],[67,13,67,32,0],[69,13,69,116,0],[70,13,70,34,0],[71,13,71,31,0],[73,13,73,98,0],[74,13,74,60,0],[76,13,76,90,0],[77,13,77,35,0],[78,13,78,49,0],[80,13,80,91,0],[81,13,81,34,0],[82,13,82,32,0],[84,13,84,49,0],[85,13,85,116,0],[86,13,86,42,0],[87,13,87,32,0],[89,13,89,88,0],[90,13,90,43,0],[91,13,91,31,0],[94,13,94,48,0],[95,13,95,95,0],[96,13,96,91,0],[97,13,97,32,0],[99,13,99,81,0],[100,13,100,34,0],[101,13,101,51,0],[102,13,102,28,0],[103,13,103,32,0],[106,13,106,87,0],[107,13,107,83,0],[108,13,108,32,0],[110,13,110,77,0],[111,13,111,32,0],[112,13,112,32,0],[114,13,114,94,0],[115,13,115,60,0],[117,13,117,76,0],[118,13,118,77,0],[119,13,119,31,0],[120,13,120,91,0],[121,13,121,80,0],[122,13,122,31,0],[123,13,123,87,0],[124,13,124,75,0],[125,13,125,32,0],[126,13,126,91,0],[127,13,127,72,0],[129,13,129,48,0],[130,13,130,32,0],[133,13,133,92,0],[134,13,134,88,0],[135,13,135,32,0],[137,13,137,77,0],[138,13,138,32,0],[139,13,139,32,0],[141,13,141,94,0],[142,13,142,60,0],[144,13,144,72,0],[145,13,145,77,0],[146,13,146,31,0],[148,13,148,87,0],[149,13,149,75,0],[150,13,150,32,0],[151,13,151,87,0],[152,13,152,72,0],[153,9,153,10,0]]);
    </script>
  </body>
</html>