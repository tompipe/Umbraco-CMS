<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Mvc\PreRenderViewActionFilterAttribute.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web.Mvc;

namespace Umbraco.Web.Mvc
{
    public class PreRenderViewActionFilterAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuted(ActionExecutedContext filterContext)
        {
            var umbController = filterContext.Controller as Controller;
            if (umbController == null)
            {
                return;
            }

            var result = filterContext.Result as ViewResultBase;
            if (result == null)
            {             
                return;
            }

            var model = result.Model;
            if (model == null)
            {                
                return;
            }

            var args = new ActionExecutedEventArgs(umbController, model);
            OnActionExecuted(args);

            if (args.Model != model)
            {
                result.ViewData.Model = args.Model;
            }

            base.OnActionExecuted(filterContext);
        }


        public static event EventHandler&lt;ActionExecutedEventArgs&gt; ActionExecuted;

        private static void OnActionExecuted(ActionExecutedEventArgs e)
        {
            EventHandler&lt;ActionExecutedEventArgs&gt; handler = ActionExecuted;
            if (handler != null) handler(null, e);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,9,9,10,0],[10,13,10,72,0],[11,13,11,39,0],[12,13,12,14,0],[13,17,13,24,0],[16,13,16,65,0],[17,13,17,32,0],[18,13,18,14,0],[19,17,19,24,0],[22,13,22,38,0],[23,13,23,31,0],[24,13,24,14,0],[25,17,25,24,0],[28,13,28,74,0],[29,13,29,36,0],[31,13,31,37,0],[32,13,32,14,0],[33,17,33,52,0],[34,13,34,14,0],[36,13,36,50,0],[37,9,37,10,0],[43,9,43,10,0],[44,13,44,76,0],[45,13,45,33,0],[45,34,45,51,0],[46,9,46,10,0]]);
    </script>
  </body>
</html>