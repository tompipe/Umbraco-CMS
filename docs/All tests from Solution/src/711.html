<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\PublishedContentPropertyExtension.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Umbraco.Core;
using Umbraco.Core.Models;
using Umbraco.Web.PropertyEditors;

namespace Umbraco.Web
{
    /// &lt;summary&gt;
    /// Provides extension methods for &lt;c&gt;IPublishedProperty&lt;/c&gt;.
    /// &lt;/summary&gt;
    public static class PublishedPropertyExtension
    {
        #region GetValue&lt;T&gt;

        public static T GetValue&lt;T&gt;(this IPublishedProperty property)
        {
            return property.GetValue(false, default(T));
        }

        public static T GetValue&lt;T&gt;(this IPublishedProperty property, T defaultValue)
        {
            return property.GetValue(true, defaultValue);
        }

        internal static T GetValue&lt;T&gt;(this IPublishedProperty property, bool withDefaultValue, T defaultValue)
        {
            if (property.HasValue == false &amp;&amp; withDefaultValue) return defaultValue;

            // else we use .Value so we give the converter a chance to handle the default value differently
            // eg for IEnumerable&lt;T&gt; it may return Enumerable&lt;T&gt;.Empty instead of null

            var value = property.Value;

            // if value is null (strange but why not) it still is OK to call TryConvertTo
            // because it&#39;s an extension method (hence no NullRef) which will return a
            // failed attempt. So, no need to care for value being null here.

            // if already the requested type, return
            if (value is T) return (T)value;

            // if can convert to requested type, return
            var convert = value.TryConvertTo&lt;T&gt;();
            if (convert.Success) return convert.Result;

            // at that point, the code tried with the raw value
            // that makes no sense because it sort of is unpredictable,
            // you wouldn&#39;t know when the converters run or don&#39;t run.
            // so, it&#39;s commented out now.

            // try with the raw value
            //var source = property.ValueSource;
            //if (source is string) source = TextValueConverterHelper.ParseStringValueSource((string)source);
            //if (source is T) return (T)source;
            //convert = source.TryConvertTo&lt;T&gt;();
            //if (convert.Success) return convert.Result;

            return defaultValue;
        }

        #endregion
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[15,9,15,10,0],[16,13,16,57,0],[17,9,17,10,0],[20,9,20,10,0],[21,13,21,58,0],[22,9,22,10,0],[25,9,25,10,1],[26,13,26,64,1],[26,65,26,85,1],[31,13,31,40,1],[38,13,38,28,1],[38,29,38,45,1],[41,13,41,51,1],[42,13,42,33,1],[42,34,42,56,1],[56,13,56,33,1],[57,9,57,10,1]]);
    </script>
  </body>
</html>