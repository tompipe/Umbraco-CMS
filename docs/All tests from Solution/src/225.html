<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Models\StylesheetTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Diagnostics;
using System.Linq;
using NUnit.Framework;
using Umbraco.Core.Models;
using Umbraco.Core.Serialization;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Models
{
    [TestFixture]
    public class StylesheetTests
    {
        [SetUp]
        public virtual void Initialize()
        {
            SettingsForTests.Reset();
        }

        [Test]
        public void Can_Create_Stylesheet()
        {
            // Arrange
            var stylesheet = new Stylesheet(&quot;/css/styles.css&quot;);
            stylesheet.Content = @&quot;body { color:#000; } .bold {font-weight:bold;}&quot;;

            // Assert
            Assert.That(stylesheet.Name, Is.EqualTo(&quot;styles.css&quot;));
            Assert.That(stylesheet.Alias, Is.EqualTo(&quot;styles&quot;));
        }

        [Test]
        public void Can_Add_Property()
        {
            // Arrange
            var stylesheet = new Stylesheet(&quot;/css/styles.css&quot;) {Content = @&quot;body { color:#000; } .bold {font-weight:bold;}&quot;};

            stylesheet.AddProperty(new StylesheetProperty(&quot;Test&quot;, &quot;p&quot;, &quot;font-weight:bold; font-family:Arial;&quot;));

            // Assert
            Assert.AreEqual(1, stylesheet.Properties.Count());
            Assert.AreEqual(&quot;Test&quot;, stylesheet.Properties.Single().Name);
            Assert.AreEqual(&quot;p&quot;, stylesheet.Properties.Single().Alias);
            Assert.AreEqual(&quot;font-weight:bold; font-family:Arial;&quot;, stylesheet.Properties.Single().Value);
        }

        [Test]
        public void Can_Remove_Property()
        {
            // Arrange
            var stylesheet = new Stylesheet(&quot;/css/styles.css&quot;) { Content = @&quot;body { color:#000; } /**umb_name:Hello*/p{font-size:2em;} .bold {font-weight:bold;}&quot; };

            
            Assert.AreEqual(1, stylesheet.Properties.Count());

            stylesheet.RemoveProperty(&quot;Hello&quot;);

            Assert.AreEqual(0, stylesheet.Properties.Count());
            Assert.AreEqual(@&quot;body { color:#000; }  .bold {font-weight:bold;}&quot;, stylesheet.Content);
        }

        [Test]
        public void Can_Update_Property()
        {
            // Arrange
            var stylesheet = new Stylesheet(&quot;/css/styles.css&quot;)
            {
                Content = @&quot;body { color:#000; } /**umb_name:Hello*/p{font-size:2em;} .bold {font-weight:bold;}&quot;
            };

            var prop = stylesheet.Properties.Single();
            prop.Alias = &quot;li&quot;;
            prop.Value = &quot;font-size:5em;&quot;;

            //re-get
            prop = stylesheet.Properties.Single();
            Assert.AreEqual(&quot;li&quot;, prop.Alias);
            Assert.AreEqual(&quot;font-size:5em;&quot;, prop.Value);
            Assert.AreEqual(&quot;body { color:#000; } /**umb_name:Hello*/\r\nli{font-size:5em;} .bold {font-weight:bold;}&quot;, stylesheet.Content);
        }

        [Test]
        public void Can_Get_Properties_From_Css()
        {
            // Arrange
            var stylesheet = new Stylesheet(&quot;/css/styles.css&quot;);
            stylesheet.Content = @&quot;body { color:#000; } .bold {font-weight:bold;} /**umb_name:Hello */ p { font-size: 1em; } /**umb_name:testing123*/ li:first-child {padding:0px;}&quot;;

            // Act
            var properties = stylesheet.Properties;

            Assert.AreEqual(2, properties.Count());
            Assert.AreEqual(&quot;Hello&quot;, properties.First().Name);
            Assert.AreEqual(&quot;font-size: 1em;&quot;, properties.First().Value);
            Assert.AreEqual(&quot;p&quot;, properties.First().Alias);
            Assert.AreEqual(&quot;testing123&quot;, properties.Last().Name);
            Assert.AreEqual(&quot;padding:0px;&quot;, properties.Last().Value);
            Assert.AreEqual(&quot;li:first-child&quot;, properties.Last().Alias);
        }


        [Test]
        public void Can_Serialize_Without_Error()
        {
            var ss = new SerializationService(new JsonNetSerializer());

            var stylesheet = new Stylesheet(&quot;/css/styles.css&quot;);
            stylesheet.Content = @&quot;@media screen and (min-width: 600px) and (min-width: 900px) {
                                      .class {
                                        background: #666;
                                      }
                                    }&quot;;

            var result = ss.ToStream(stylesheet);
            var json = result.ResultStream.ToJsonString();
            Debug.Print(json);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,1],[17,13,17,38,1],[18,9,18,10,1],[22,9,22,10,1],[24,13,24,64,1],[25,13,25,84,1],[28,13,28,68,1],[29,13,29,65,1],[30,9,30,10,1],[34,9,34,10,1],[36,13,36,126,1],[38,13,38,113,1],[41,13,41,63,1],[42,13,42,74,1],[43,13,43,72,1],[44,13,44,107,1],[45,9,45,10,1],[49,9,49,10,1],[51,13,51,165,1],[54,13,54,63,1],[56,13,56,48,1],[58,13,58,63,1],[59,13,59,101,1],[60,9,60,10,1],[64,9,64,10,1],[66,13,69,15,1],[71,13,71,55,1],[72,13,72,31,1],[73,13,73,43,1],[76,13,76,51,1],[77,13,77,47,1],[78,13,78,59,1],[79,13,79,141,1],[80,9,80,10,1],[84,9,84,10,1],[86,13,86,64,1],[87,13,87,182,1],[90,13,90,52,1],[92,13,92,52,1],[93,13,93,63,1],[94,13,94,74,1],[95,13,95,60,1],[96,13,96,67,1],[97,13,97,70,1],[98,13,98,72,1],[99,9,99,10,1],[104,9,104,10,1],[105,13,105,72,1],[107,13,107,64,1],[108,13,112,40,1],[114,13,114,50,1],[115,13,115,59,1],[116,13,116,31,1],[117,9,117,10,1]]);
    </script>
  </body>
</html>