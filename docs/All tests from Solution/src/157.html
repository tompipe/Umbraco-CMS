<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Strings\LegacyStringExtensionsTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Core.ObjectResolution;
using Umbraco.Core.Strings;

namespace Umbraco.Tests.Strings
{
	[TestFixture]
    public class LegacyStringExtensionsTests
    {
        [SetUp]
        public void Setup()
        {
            ShortStringHelperResolver.Reset();
            ShortStringHelperResolver.Current = new ShortStringHelperResolver(new LegacyShortStringHelper());
            Resolution.Freeze();
        }

        [TearDown]
        public void TearDown()
        {
            ShortStringHelperResolver.Reset();
        }

		[TestCase(&quot;This is a string to encrypt&quot;)]
		[TestCase(&quot;This is a string to encrypt\nThis is a second line&quot;)]
		[TestCase(&quot;    White space is preserved    &quot;)]
		[TestCase(&quot;\nWhite space is preserved\n&quot;)]
		public void Encrypt_And_Decrypt(string input)
		{
			var encrypted = input.EncryptWithMachineKey();
			var decrypted = encrypted.DecryptWithMachineKey();
			Assert.AreNotEqual(input, encrypted);
			Assert.AreEqual(input, decrypted);
		}

		[Test()]
		public void Encrypt_And_Decrypt_Long_Value()
		{
			// Generate a really long string
			char[] chars = { &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;\n&#39; };

			string valueToTest = string.Empty;

			// Create a string 7035 chars long
			for (int i = 0; i &lt; 1005; i++)
				for (int j = 0; j &lt; chars.Length; j++)
					valueToTest += chars[j].ToString();

			var encrypted = valueToTest.ToString().EncryptWithMachineKey();
			var decrypted = encrypted.DecryptWithMachineKey();
			Assert.AreNotEqual(valueToTest, encrypted);
			Assert.AreEqual(valueToTest, decrypted);
		}

        [TestCase(&quot;Hello this is my string&quot;, &quot; string&quot;, &quot;Hello this is my&quot;)]
        [TestCase(&quot;Hello this is my string strung&quot;, &quot; string&quot;, &quot;Hello this is my string strung&quot;)]
        [TestCase(&quot;Hello this is my string string&quot;, &quot; string&quot;, &quot;Hello this is my&quot;)]
        [TestCase(&quot;Hello this is my string string&quot;, &quot;g&quot;, &quot;Hello this is my string strin&quot;)]
        [TestCase(&quot;Hello this is my string string&quot;, &quot;ello this is my string string&quot;, &quot;H&quot;)]
        [TestCase(&quot;Hello this is my string string&quot;, &quot;Hello this is my string string&quot;, &quot;&quot;)]
        public void TrimEnd(string input, string forTrimming, string shouldBe)
        {
            var trimmed = input.TrimEnd(forTrimming);
            Assert.AreEqual(shouldBe, trimmed);
        }

        [TestCase(&quot;Hello this is my string&quot;, &quot;hello&quot;, &quot; this is my string&quot;)]
        [TestCase(&quot;Hello this is my string&quot;, &quot;Hello this&quot;, &quot; is my string&quot;)]
        [TestCase(&quot;Hello this is my string&quot;, &quot;Hello this is my &quot;, &quot;string&quot;)]
        [TestCase(&quot;Hello this is my string&quot;, &quot;Hello this is my string&quot;, &quot;&quot;)]
        public void TrimStart(string input, string forTrimming, string shouldBe)
        {
            var trimmed = input.TrimStart(forTrimming);
            Assert.AreEqual(shouldBe, trimmed);
        }


        [TestCase]
        public void StringExtensions_To_Url_Alias()
        {
            var replacements = new Dictionary&lt;string, string&gt;
            {
                {&quot; &quot;, &quot;-&quot;},
                {&quot;\&quot;&quot;, &quot;&quot;},
                {&quot;&amp;quot;&quot;, &quot;&quot;},
                {&quot;@&quot;, &quot;&quot;},
                {&quot;%&quot;, &quot;&quot;},
                {&quot;.&quot;, &quot;&quot;},
                {&quot;;&quot;, &quot;&quot;},
                {&quot;/&quot;, &quot;&quot;},
                {&quot;:&quot;, &quot;&quot;},
                {&quot;#&quot;, &quot;&quot;},
                {&quot;+&quot;, &quot;&quot;},
                {&quot;*&quot;, &quot;&quot;},
                {&quot;&amp;amp;&quot;, &quot;&quot;},
                {&quot;?&quot;, &quot;&quot;}
            };

            var name1 = &quot;Home Page&quot;;
            var name2 = &quot;Shannon&#39;s Home Page!&quot;;
            var name3 = &quot;#Someones&#39;s Twitter $h1z%n&quot;;
            var name4 = &quot;R&#228;ksm&#246;rg&#229;s&quot;;
            var name5 = &quot;&#39;em guys-over there, are#goin&#39; a \&quot;little\&quot;bit crazy eh!! :)&quot;;
            var name6 = &quot;汉#字*/漢?字&quot;;

            var url1 = name1.ToUrlAlias(replacements, true, true, false);
            var url2 = name2.ToUrlAlias(replacements, true, true, false);
            var url3 = name3.ToUrlAlias(replacements, true, true, false);
            var url4 = name4.ToUrlAlias(replacements, true, true, false);
            var url5 = name5.ToUrlAlias(replacements, true, true, false);
            var url6 = name6.ToUrlAlias(replacements, true, true, false);
            var url7 = name6.ToUrlAlias(replacements, true, false, false);
            var url8 = name6.ToUrlAlias(replacements, true, false, true);

            Assert.AreEqual(&quot;home-page&quot;, url1);
            Assert.AreEqual(&quot;shannons-home-page&quot;, url2);
            Assert.AreEqual(&quot;someoness-twitter-h1zn&quot;, url3);
            Assert.AreEqual(&quot;rksmrgs&quot;, url4);
            Assert.AreEqual(&quot;em-guys-over-there-aregoin-a-littlebit-crazy-eh&quot;, url5);
            Assert.AreEqual(&quot;&quot;, url6);
            Assert.AreEqual(&quot;汉字漢字&quot;, url7);
            Assert.AreEqual(&quot;%e6%b1%89%e5%ad%97%e6%bc%a2%e5%ad%97&quot;, url8);

        }

        [TestCase]
        public void StringExtensions_To_Camel_Case()
        {
            //Arrange

            var name1 = &quot;Tab 1&quot;;
            var name2 = &quot;Home - Page&quot;;
            var name3 = &quot;Shannon&#39;s document type&quot;;

            //Act

            var camelCase1 = name1.ConvertCase(StringAliasCaseType.CamelCase);
            var camelCase2 = name2.ConvertCase(StringAliasCaseType.CamelCase);
            var camelCase3 = name3.ConvertCase(StringAliasCaseType.CamelCase);

            //Assert

            Assert.AreEqual(&quot;tab1&quot;, camelCase1);
            Assert.AreEqual(&quot;homePage&quot;, camelCase2);
            Assert.AreEqual(&quot;shannon&#39;sDocumentType&quot;, camelCase3);
        }

        [TestCase]
        public void StringExtensions_To_Entity_Alias()
        {
            //Arrange

            var name1 = &quot;Tab 1&quot;;
            var name2 = &quot;Home - Page&quot;;
            var name3 = &quot;Shannon&#39;s Document Type&quot;;
            var name4 = &quot;!BADDLY nam-ed Document Type&quot;;
            var name5 = &quot;i %Want!thisTo end up In Proper@case&quot;;

            //Act

            var alias1 = name1.ToUmbracoAlias();
            var alias2 = name2.ToUmbracoAlias();
            var alias3 = name3.ToUmbracoAlias();
            var alias4 = name4.ToUmbracoAlias();
            var alias5 = name5.ToUmbracoAlias(/*StringAliasCaseType.PascalCase*/);

            //Assert

            Assert.AreEqual(&quot;tab1&quot;, alias1);
            Assert.AreEqual(&quot;homePage&quot;, alias2);
            Assert.AreEqual(&quot;shannonsDocumentType&quot;, alias3);
            Assert.AreEqual(&quot;baddlyNamEdDocumentType&quot;, alias4);
            
            // disable: does not support PascalCase anymore
            //Assert.AreEqual(&quot;IWantThisToEndUpInProperCase&quot;, alias5);
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,10,1],[15,13,15,47,1],[16,13,16,110,1],[17,13,17,33,1],[18,9,18,10,1],[22,9,22,10,1],[23,13,23,47,1],[24,9,24,10,1],[31,3,31,4,1],[32,4,32,50,1],[33,4,33,54,1],[34,4,34,41,1],[35,4,35,38,1],[36,3,36,4,1],[40,3,40,4,1],[42,4,42,58,1],[44,4,44,38,1],[47,9,47,18,1],[47,20,47,28,1],[47,30,47,33,1],[48,10,48,19,1],[48,21,48,37,1],[48,39,48,42,1],[49,6,49,41,1],[51,4,51,67,1],[52,4,52,54,1],[53,4,53,47,1],[54,4,54,44,1],[55,3,55,4,1],[64,9,64,10,1],[65,13,65,54,1],[66,13,66,48,1],[67,9,67,10,1],[74,9,74,10,1],[75,13,75,56,1],[76,13,76,48,1],[77,9,77,10,1],[82,9,82,10,1],[83,13,99,15,1],[101,13,101,37,1],[102,13,102,48,1],[103,13,103,54,1],[104,13,104,38,1],[105,13,105,88,1],[106,13,106,36,1],[108,13,108,74,1],[109,13,109,74,1],[110,13,110,74,1],[111,13,111,74,1],[112,13,112,74,1],[113,13,113,74,1],[114,13,114,75,1],[115,13,115,74,1],[117,13,117,48,1],[118,13,118,57,1],[119,13,119,61,1],[120,13,120,46,1],[121,13,121,86,1],[122,13,122,39,1],[123,13,123,43,1],[124,13,124,75,1],[126,9,126,10,1],[130,9,130,10,1],[133,13,133,33,1],[134,13,134,39,1],[135,13,135,51,1],[139,13,139,79,1],[140,13,140,79,1],[141,13,141,79,1],[145,13,145,49,1],[146,13,146,53,1],[147,13,147,66,1],[148,9,148,10,1],[152,9,152,10,1],[155,13,155,33,1],[156,13,156,39,1],[157,13,157,51,1],[158,13,158,56,1],[159,13,159,64,1],[163,13,163,49,1],[164,13,164,49,1],[165,13,165,49,1],[166,13,166,49,1],[167,13,167,83,1],[171,13,171,45,1],[172,13,172,49,1],[173,13,173,61,1],[174,13,174,64,1],[178,9,178,10,1]]);
    </script>
  </body>
</html>