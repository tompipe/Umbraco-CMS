<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\WebApi\UmbracoApiControllerBase.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web;
using System.Web.Http;
using Microsoft.Owin;
using Umbraco.Core;
using Umbraco.Core.Logging;
using Umbraco.Core.Services;
using Umbraco.Web.Security;

namespace Umbraco.Web.WebApi
{
    /// &lt;summary&gt;
    /// The base class for API controllers that expose Umbraco services - THESE ARE NOT AUTO ROUTED
    /// &lt;/summary&gt;
    public abstract class UmbracoApiControllerBase : ApiController
    {
        protected UmbracoApiControllerBase()
            : this(UmbracoContext.Current)
        {

        }

        protected UmbracoApiControllerBase(UmbracoContext umbracoContext)
        {
            if (umbracoContext == null) throw new ArgumentNullException(&quot;umbracoContext&quot;);
            UmbracoContext = umbracoContext;
            InstanceId = Guid.NewGuid();            
        }

        protected UmbracoApiControllerBase(UmbracoContext umbracoContext, UmbracoHelper umbracoHelper)
        {
            if (umbracoContext == null) throw new ArgumentNullException(&quot;umbracoContext&quot;);
            if (umbracoHelper == null) throw new ArgumentNullException(&quot;umbracoHelper&quot;);
            UmbracoContext = umbracoContext;
            InstanceId = Guid.NewGuid();
            _umbraco = umbracoHelper;            
        }

        private UmbracoHelper _umbraco;

        /// &lt;summary&gt;
        /// Tries to retrieve the current HttpContext if one exists.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        protected Attempt&lt;HttpContextBase&gt; TryGetHttpContext()
        {
            return Request.TryGetHttpContext();
        }

        /// &lt;summary&gt;
        /// Tries to retrieve the current HttpContext if one exists.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        protected Attempt&lt;IOwinContext&gt; TryGetOwinContext()
        {
            return Request.TryGetOwinContext();
        }

        /// &lt;summary&gt;
        /// Returns an ILogger
        /// &lt;/summary&gt;
        public ILogger Logger
        {
            get { return ProfilingLogger.Logger; }
        }

        /// &lt;summary&gt;
        /// Returns a ProfilingLogger
        /// &lt;/summary&gt;
        public virtual ProfilingLogger ProfilingLogger
        {
            get { return UmbracoContext.Application.ProfilingLogger; }
        }

        /// &lt;summary&gt;
        /// Returns the current ApplicationContext
        /// &lt;/summary&gt;
        public virtual ApplicationContext ApplicationContext
        {
            get { return UmbracoContext.Application; }
        }

        /// &lt;summary&gt;
        /// Returns a ServiceContext
        /// &lt;/summary&gt;
        public ServiceContext Services
        {
            get { return ApplicationContext.Services; }
        }

        /// &lt;summary&gt;
        /// Returns a DatabaseContext
        /// &lt;/summary&gt;
        public DatabaseContext DatabaseContext
        {
            get { return ApplicationContext.DatabaseContext; }
        }

        /// &lt;summary&gt;
        /// Returns an UmbracoHelper object
        /// &lt;/summary&gt;
        public virtual UmbracoHelper Umbraco
        {
            get { return _umbraco ?? (_umbraco = new UmbracoHelper(UmbracoContext)); }
        }

        /// &lt;summary&gt;
        /// Returns the current UmbracoContext
        /// &lt;/summary&gt;
        public virtual UmbracoContext UmbracoContext { get; private set; }

        /// &lt;summary&gt;
        /// Returns the WebSecurity instance
        /// &lt;/summary&gt;
        public WebSecurity Security
        {
            get { return UmbracoContext.Security; }
        }

        /// &lt;summary&gt;
        /// Returns the MemberHelper instance
        /// &lt;/summary&gt;
        public MembershipHelper Members
        {
            get { return Umbraco.MembershipHelper; }
        }

        /// &lt;summary&gt;
        /// Useful for debugging
        /// &lt;/summary&gt;
        internal Guid InstanceId { get; private set; }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,15,18,43,0],[19,9,19,10,0],[21,9,21,10,0],[23,9,23,74,0],[24,9,24,10,0],[25,13,25,40,0],[25,41,25,91,0],[26,13,26,45,0],[27,13,27,41,0],[28,9,28,10,0],[30,9,30,103,0],[31,9,31,10,0],[32,13,32,40,0],[32,41,32,91,0],[33,13,33,39,0],[33,40,33,89,0],[34,13,34,45,0],[35,13,35,41,0],[36,13,36,38,0],[37,9,37,10,0],[46,9,46,10,0],[47,13,47,48,0],[48,9,48,10,0],[55,9,55,10,0],[56,13,56,48,0],[57,9,57,10,0],[64,17,64,18,0],[64,19,64,49,0],[64,50,64,51,0],[72,17,72,18,0],[72,19,72,69,0],[72,70,72,71,0],[80,17,80,18,0],[80,19,80,53,0],[80,54,80,55,0],[88,17,88,18,0],[88,19,88,54,0],[88,55,88,56,0],[96,17,96,18,0],[96,19,96,61,0],[96,62,96,63,0],[104,17,104,18,0],[104,19,104,85,0],[104,86,104,87,0],[110,56,110,60,0],[110,61,110,73,0],[117,17,117,18,0],[117,19,117,50,0],[117,51,117,52,0],[125,17,125,18,0],[125,19,125,51,0],[125,52,125,53,0],[131,36,131,40,0],[131,41,131,53,0]]);
    </script>
  </body>
</html>