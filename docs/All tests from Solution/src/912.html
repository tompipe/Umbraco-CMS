<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Security\Identity\ExternalSignInAutoLinkOptions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using Microsoft.AspNet.Identity.Owin;
using Microsoft.Owin;
using Umbraco.Core;
using Umbraco.Core.Configuration;
using Umbraco.Core.Models.Identity;

namespace Umbraco.Web.Security.Identity
{
    /// &lt;summary&gt;
    /// Options used to configure auto-linking external OAuth providers
    /// &lt;/summary&gt;
    public sealed class ExternalSignInAutoLinkOptions
    {
        public ExternalSignInAutoLinkOptions(
            bool autoLinkExternalAccount = false,
            string defaultUserType = &quot;editor&quot;, 
            string[] defaultAllowedSections = null, 
            string defaultCulture = null)
        {
            Mandate.ParameterNotNullOrEmpty(defaultUserType, &quot;defaultUserType&quot;);

            _defaultUserType = defaultUserType;
            _defaultAllowedSections = defaultAllowedSections ?? new[] { &quot;content&quot;, &quot;media&quot; };
            _autoLinkExternalAccount = autoLinkExternalAccount;
            _defaultCulture = defaultCulture ?? GlobalSettings.DefaultUILanguage;
        }

        private readonly string _defaultUserType;

        /// &lt;summary&gt;
        /// A callback executed during account auto-linking and before the user is persisted
        /// &lt;/summary&gt;
        public Action&lt;BackOfficeIdentityUser, ExternalLoginInfo&gt; OnAutoLinking { get; set; }

        /// &lt;summary&gt;
        /// The default User Type alias to use for auto-linking users
        /// &lt;/summary&gt;
        public string GetDefaultUserType(UmbracoContext umbracoContext, ExternalLoginInfo loginInfo)
        {
            return _defaultUserType;
        }

        private readonly string[] _defaultAllowedSections;

        /// &lt;summary&gt;
        /// The default allowed sections to use for auto-linking users
        /// &lt;/summary&gt;
        public string[] GetDefaultAllowedSections(UmbracoContext umbracoContext, ExternalLoginInfo loginInfo)
        {
            return _defaultAllowedSections;
        }

        private readonly bool _autoLinkExternalAccount;

        /// &lt;summary&gt;
        /// For private external auth providers such as Active Directory, which when set to true will automatically
        /// create a local user if the external provider login was successful.
        /// 
        /// For public auth providers this should always be false!!!
        /// &lt;/summary&gt;
        public bool ShouldAutoLinkExternalAccount(UmbracoContext umbracoContext, ExternalLoginInfo loginInfo)
        {
            return _autoLinkExternalAccount;
        }
        
        private readonly string _defaultCulture;
       
        /// &lt;summary&gt;
        /// The default Culture to use for auto-linking users
        /// &lt;/summary&gt;
        public string GetDefaultCulture(UmbracoContext umbracoContext, ExternalLoginInfo loginInfo)
        {
            return _defaultCulture;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[15,9,19,42,0],[20,9,20,10,0],[21,13,21,81,0],[23,13,23,48,0],[24,13,24,94,0],[25,13,25,64,0],[26,13,26,82,0],[27,9,27,10,0],[34,82,34,86,0],[34,87,34,91,0],[40,9,40,10,0],[41,13,41,37,0],[42,9,42,10,0],[50,9,50,10,0],[51,13,51,44,0],[52,9,52,10,0],[63,9,63,10,0],[64,13,64,45,0],[65,9,65,10,0],[73,9,73,10,0],[74,13,74,36,0],[75,9,75,10,0]]);
    </script>
  </body>
</html>