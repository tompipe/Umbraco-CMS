<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Models\DetachedContent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using Umbraco.Core.Models;
using Umbraco.Core.Models.PublishedContent;

namespace Umbraco.Web.Models
{
    internal class DetachedContent
    {
        private readonly Dictionary&lt;string, IPublishedProperty&gt; _properties;

        /// &lt;summary&gt;
        /// Initialized a new instance of the &lt;see cref=&quot;DetachedContent&quot;/&gt; class with properties.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;properties&quot;&gt;The properties&lt;/param&gt;
        /// &lt;remarks&gt;Properties must be detached or nested properties ie their property type must be detached or nested.
        /// Such a detached content can be part of a published property value.&lt;/remarks&gt;
        public DetachedContent(IEnumerable&lt;IPublishedProperty&gt; properties)
        {
            _properties = properties.ToDictionary(x =&gt; x.PropertyTypeAlias, x =&gt; x, StringComparer.InvariantCultureIgnoreCase);
        }

        // don&#39;t uncomment until you know what you are doing
        /*
        public DetachedContent(IPublishedContent content)
        {
            _properties = content.Properties.ToDictionary(x =&gt; x.PropertyTypeAlias, x =&gt; x, StringComparer.InvariantCultureIgnoreCase);
        }
        */

        // don&#39;t uncomment until you know what you are doing
        // at the moment, I don&#39;t fully
        /*
        public DetachedContent(IContent content, bool isPreviewing)
        {
            var publishedContentType = PublishedContentType.Get(PublishedItemType.Content, content.ContentType.Alias);
            _properties = PublishedProperty.MapProperties(publishedContentType.PropertyTypes, content.Properties,
                (t, v) =&gt; PublishedProperty.GetDetached(t.Detached(), v, isPreviewing))
                .ToDictionary(x =&gt; x.PropertyTypeAlias, x =&gt; x, StringComparer.InvariantCultureIgnoreCase);
        }

        public DetachedContent(IMedia media, bool isPreviewing)
        {
            var publishedContentType = PublishedContentType.Get(PublishedItemType.Media, media.ContentType.Alias);
            _properties = PublishedProperty.MapProperties(publishedContentType.PropertyTypes, media.Properties,
                (t, v) =&gt; PublishedProperty.GetDetached(t.Detached(), v, isPreviewing))
                .ToDictionary(x =&gt; x.PropertyTypeAlias, x =&gt; x, StringComparer.InvariantCultureIgnoreCase);
        }

        public DetachedContent(IMember member, bool isPreviewing)
        {
            var publishedContentType = PublishedContentType.Get(PublishedItemType.Member, member.ContentType.Alias);
            _properties = PublishedProperty.MapProperties(publishedContentType.PropertyTypes, member.Properties,
                (t, v) =&gt; PublishedProperty.GetDetached(t.Detached(), v, isPreviewing))
                .ToDictionary(x =&gt; x.PropertyTypeAlias, x =&gt; x, StringComparer.InvariantCultureIgnoreCase);
        }
        */

        public ICollection&lt;IPublishedProperty&gt; Properties
        {
            get { return _properties.Values; }
        }

        public IPublishedProperty GetProperty(string alias)
        {
            IPublishedProperty property;
            return _properties.TryGetValue(alias, out property) ? property : null;
        }

        public bool HasProperty(string alias)
        {
            var property = GetProperty(alias);
            return property != null;
        }

        public bool HasValue(string alias)
        {
            var property = GetProperty(alias);
            return property != null &amp;&amp; property.HasValue;
        }

        public object GetPropertyValue(string alias)
        {
            var property = GetProperty(alias);
            return property == null ? null : property.Value;
        }

        public object GetPropertyValue(string alias, string defaultValue)
        {
            var property = GetProperty(alias);
            return property == null || property.HasValue == false ? defaultValue : property.Value;
        }

        public object GetPropertyValue(string alias, object defaultValue)
        {
            var property = GetProperty(alias);
            return property == null || property.HasValue == false ? defaultValue : property.Value;
        }

        public T GetPropertyValue&lt;T&gt;(string alias)
        {
            var property = GetProperty(alias);
            if (property == null) return default(T);
            return property.GetValue(false, default(T));
        }

        public T GetPropertyValue&lt;T&gt;(string alias, T defaultValue)
        {
            var property = GetProperty(alias);
            if (property == null) return defaultValue;
            return property.GetValue(true, defaultValue);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[19,9,19,75,0],[20,9,20,10,0],[21,13,21,56,0],[21,56,21,75,0],[21,75,21,82,0],[21,82,21,83,0],[21,83,21,128,0],[21,13,21,128,0],[22,9,22,10,0],[62,17,62,18,0],[62,19,62,45,0],[62,46,62,47,0],[66,9,66,10,0],[68,13,68,83,0],[69,9,69,10,0],[72,9,72,10,0],[73,13,73,47,0],[74,13,74,37,0],[75,9,75,10,0],[78,9,78,10,0],[79,13,79,47,0],[80,13,80,58,0],[81,9,81,10,0],[84,9,84,10,0],[85,13,85,47,0],[86,13,86,61,0],[87,9,87,10,0],[90,9,90,10,0],[91,13,91,47,0],[92,13,92,99,0],[93,9,93,10,0],[96,9,96,10,0],[97,13,97,47,0],[98,13,98,99,0],[99,9,99,10,0],[102,9,102,10,0],[103,13,103,47,0],[104,13,104,34,0],[104,35,104,53,0],[105,13,105,57,0],[106,9,106,10,0],[109,9,109,10,0],[110,13,110,47,0],[111,13,111,34,0],[111,35,111,55,0],[112,13,112,58,0],[113,9,113,10,0]]);
    </script>
  </body>
</html>