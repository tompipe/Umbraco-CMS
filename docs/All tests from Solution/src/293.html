<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\TestHelpers\Entities\MockedMember.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using Umbraco.Core.Models;
using Umbraco.Core.Models.Membership;

namespace Umbraco.Tests.TestHelpers.Entities
{
    public class MockedMember
    {
        public static Member CreateSimpleMember(IMemberType contentType, string name, string email, string password, string username, Guid? key = null)
        {
            var member = new Member(name, email, username, password, contentType)
                         {
                             CreatorId = 0,
                             Email = email,
                             RawPasswordValue = password,
                             Username = username
                         };

            if (key.HasValue)
            {
                member.Key = key.Value;
            }

            member.SetValue(&quot;title&quot;, name + &quot; member&quot;);
            member.SetValue(&quot;bodyText&quot;, &quot;This is a subpage&quot;);
            member.SetValue(&quot;author&quot;, &quot;John Doe&quot;);

            member.ResetDirtyProperties(false);

            return member;
        }

        public static IEnumerable&lt;IMember&gt; CreateSimpleMember(IMemberType memberType, int amount, Action&lt;int, IMember&gt; onCreating = null)
        {
            var list = new List&lt;IMember&gt;();

            for (int i = 0; i &lt; amount; i++)
            {
                var name = &quot;Member No-&quot; + i;
                var member = new Member(name, &quot;test&quot; + i + &quot;@test.com&quot;, &quot;test&quot; + i, &quot;test&quot; + i, memberType);
                member.SetValue(&quot;title&quot;, name + &quot; member&quot; + i);
                member.SetValue(&quot;bodyText&quot;, &quot;This is a subpage&quot; + i);
                member.SetValue(&quot;author&quot;, &quot;John Doe&quot; + i);

                if (onCreating != null)
                {
                    onCreating(i, member);
                }

                member.ResetDirtyProperties(false);
                
                list.Add(member);
            }

            return list;
        } 
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[11,9,11,10,1],[12,13,18,28,1],[20,13,20,30,1],[21,13,21,14,1],[22,17,22,40,1],[23,13,23,14,1],[25,13,25,56,1],[26,13,26,62,1],[27,13,27,51,1],[29,13,29,48,1],[31,13,31,27,1],[32,9,32,10,1],[35,9,35,10,1],[36,13,36,44,1],[38,18,38,27,1],[38,29,38,39,1],[38,41,38,44,1],[39,13,39,14,1],[40,17,40,45,1],[41,17,41,109,1],[42,17,42,64,1],[43,17,43,70,1],[44,17,44,59,1],[46,17,46,40,1],[47,17,47,18,1],[48,21,48,43,1],[49,17,49,18,1],[51,17,51,52,1],[53,17,53,34,1],[54,13,54,14,1],[56,13,56,25,1],[57,9,57,10,1]]);
    </script>
  </body>
</html>