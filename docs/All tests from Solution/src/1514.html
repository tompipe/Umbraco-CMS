<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Services\TaskService.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using Umbraco.Core.Events;
using Umbraco.Core.Logging;
using Umbraco.Core.Models;
using Umbraco.Core.Persistence;
using Umbraco.Core.Persistence.Querying;
using Umbraco.Core.Persistence.UnitOfWork;

namespace Umbraco.Core.Services
{
    public class TaskService : RepositoryService, ITaskService
    {
        public TaskService(IDatabaseUnitOfWorkProvider provider, RepositoryFactory repositoryFactory, ILogger logger, IEventMessagesFactory eventMessagesFactory)
            : base(provider, repositoryFactory, logger, eventMessagesFactory)
        {
        }

        public TaskType GetTaskTypeByAlias(string taskTypeAlias)
        {
            using (var repo = RepositoryFactory.CreateTaskTypeRepository(UowProvider.GetUnitOfWork()))
            {
                return repo.GetByQuery(new Query&lt;TaskType&gt;().Where(type =&gt; type.Alias == taskTypeAlias)).FirstOrDefault();
            }
        }

        public TaskType GetTaskTypeById(int id)
        {
            using (var repo = RepositoryFactory.CreateTaskTypeRepository(UowProvider.GetUnitOfWork()))
            {
                return repo.Get(id);
            }
        }

        public void Save(TaskType taskType)
        {
            var uow = UowProvider.GetUnitOfWork();
            using (var repo = RepositoryFactory.CreateTaskTypeRepository(uow))
            {
                repo.AddOrUpdate(taskType);
                uow.Commit();
            }
        }

        public void Delete(TaskType taskTypeEntity)
        {
            var uow = UowProvider.GetUnitOfWork();
            using (var repo = RepositoryFactory.CreateTaskTypeRepository(uow))
            {
                repo.Delete(taskTypeEntity);
                uow.Commit();
            }
        }

        public IEnumerable&lt;TaskType&gt; GetAllTaskTypes()
        {
            using (var repo = RepositoryFactory.CreateTaskTypeRepository(UowProvider.GetUnitOfWork()))
            {
                return repo.GetAll();
            }
        }


        public IEnumerable&lt;Task&gt; GetTasks(int? itemId = null, int? assignedUser = null, int? ownerUser = null, string taskTypeAlias = null, bool includeClosed = false)
        {
            using (var repo = RepositoryFactory.CreateTaskRepository(UowProvider.GetUnitOfWork()))
            {
                return repo.GetTasks(itemId, assignedUser, ownerUser, taskTypeAlias);
            }
        }

        /// &lt;summary&gt;
        /// Saves a task
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;task&quot;&gt;&lt;/param&gt;
        public void Save(Task task)
        {
            var uow = UowProvider.GetUnitOfWork();
            using (var repo = RepositoryFactory.CreateTaskRepository(uow))
            {
                repo.AddOrUpdate(task);
                uow.Commit();
            }
        }

        public void Delete(Task task)
        {
            var uow = UowProvider.GetUnitOfWork();
            using (var repo = RepositoryFactory.CreateTaskRepository(uow))
            {
                repo.Delete(task);
                uow.Commit();
            }
        }

        public Task GetTaskById(int id)
        {
            using (var repo = RepositoryFactory.CreateTaskRepository(UowProvider.GetUnitOfWork()))
            {
                return repo.Get(id);
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,15,16,78,0],[17,9,17,10,0],[18,9,18,10,0],[21,9,21,10,0],[22,20,22,102,0],[23,13,23,14,0],[24,17,24,123,0],[26,9,26,10,0],[29,9,29,10,0],[30,20,30,102,0],[31,13,31,14,0],[32,17,32,37,0],[34,9,34,10,0],[37,9,37,10,0],[38,13,38,51,0],[39,20,39,78,0],[40,13,40,14,0],[41,17,41,44,0],[42,17,42,30,0],[43,13,43,14,0],[44,9,44,10,0],[47,9,47,10,0],[48,13,48,51,0],[49,20,49,78,0],[50,13,50,14,0],[51,17,51,45,0],[52,17,52,30,0],[53,13,53,14,0],[54,9,54,10,0],[57,9,57,10,0],[58,20,58,102,0],[59,13,59,14,0],[60,17,60,38,0],[62,9,62,10,0],[66,9,66,10,0],[67,20,67,98,0],[68,13,68,14,0],[69,17,69,86,0],[71,9,71,10,0],[78,9,78,10,0],[79,13,79,51,0],[80,20,80,74,0],[81,13,81,14,0],[82,17,82,40,0],[83,17,83,30,0],[84,13,84,14,0],[85,9,85,10,0],[88,9,88,10,0],[89,13,89,51,0],[90,20,90,74,0],[91,13,91,14,0],[92,17,92,35,0],[93,17,93,30,0],[94,13,94,14,0],[95,9,95,10,0],[98,9,98,10,0],[99,20,99,98,0],[100,13,100,14,0],[101,17,101,37,0],[103,9,103,10,0]]);
    </script>
  </body>
</html>