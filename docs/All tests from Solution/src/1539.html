<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Services\TagService.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using Umbraco.Core.Events;
using Umbraco.Core.Logging;
using Umbraco.Core.Models;
using Umbraco.Core.Persistence;
using Umbraco.Core.Persistence.Querying;
using Umbraco.Core.Persistence.UnitOfWork;

namespace Umbraco.Core.Services
{
    /// &lt;summary&gt;
    /// Tag service to query for tags in the tags db table. The tags returned are only relevant for published content &amp; saved media or members 
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// If there is unpublished content with tags, those tags will not be contained
    /// &lt;/remarks&gt;
    public class TagService : RepositoryService, ITagService
    {
      
        public TagService(IDatabaseUnitOfWorkProvider provider, RepositoryFactory repositoryFactory, ILogger logger, IEventMessagesFactory eventMessagesFactory)
            : base(provider, repositoryFactory, logger, eventMessagesFactory)
        {
        }

        public TaggedEntity GetTaggedEntityById(int id)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntityById(id);
            } 
        }

        public TaggedEntity GetTaggedEntityByKey(Guid key)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntityByKey(key);
            } 
        }

        /// &lt;summary&gt;
        /// Gets tagged Content by a specific &#39;Tag Group&#39;.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;The &lt;see cref=&quot;TaggedEntity&quot;/&gt; contains the Id and Tags of the Content, not the actual Content item.&lt;/remarks&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;TaggedEntity&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;TaggedEntity&gt; GetTaggedContentByTagGroup(string tagGroup)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntitiesByTagGroup(TaggableObjectTypes.Content, tagGroup);
            }         
        }

        /// &lt;summary&gt;
        /// Gets tagged Content by a specific &#39;Tag&#39; and optional &#39;Tag Group&#39;.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;The &lt;see cref=&quot;TaggedEntity&quot;/&gt; contains the Id and Tags of the Content, not the actual Content item.&lt;/remarks&gt;
        /// &lt;param name=&quot;tag&quot;&gt;Tag&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;TaggedEntity&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;TaggedEntity&gt; GetTaggedContentByTag(string tag, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntitiesByTag(TaggableObjectTypes.Content, tag, tagGroup);
            }         
        }

        /// &lt;summary&gt;
        /// Gets tagged Media by a specific &#39;Tag Group&#39;.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;The &lt;see cref=&quot;TaggedEntity&quot;/&gt; contains the Id and Tags of the Media, not the actual Media item.&lt;/remarks&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;TaggedEntity&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;TaggedEntity&gt; GetTaggedMediaByTagGroup(string tagGroup)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntitiesByTagGroup(TaggableObjectTypes.Media, tagGroup);
            }    
        }

        /// &lt;summary&gt;
        /// Gets tagged Media by a specific &#39;Tag&#39; and optional &#39;Tag Group&#39;.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;The &lt;see cref=&quot;TaggedEntity&quot;/&gt; contains the Id and Tags of the Media, not the actual Media item.&lt;/remarks&gt;
        /// &lt;param name=&quot;tag&quot;&gt;Tag&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;TaggedEntity&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;TaggedEntity&gt; GetTaggedMediaByTag(string tag, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntitiesByTag(TaggableObjectTypes.Media, tag, tagGroup);
            }    
        }

        /// &lt;summary&gt;
        /// Gets tagged Members by a specific &#39;Tag Group&#39;.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;The &lt;see cref=&quot;TaggedEntity&quot;/&gt; contains the Id and Tags of the Member, not the actual Member item.&lt;/remarks&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;TaggedEntity&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;TaggedEntity&gt; GetTaggedMembersByTagGroup(string tagGroup)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntitiesByTagGroup(TaggableObjectTypes.Member, tagGroup);
            }    
        }

        /// &lt;summary&gt;
        /// Gets tagged Members by a specific &#39;Tag&#39; and optional &#39;Tag Group&#39;.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;The &lt;see cref=&quot;TaggedEntity&quot;/&gt; contains the Id and Tags of the Member, not the actual Member item.&lt;/remarks&gt;
        /// &lt;param name=&quot;tag&quot;&gt;Tag&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;TaggedEntity&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;TaggedEntity&gt; GetTaggedMembersByTag(string tag, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTaggedEntitiesByTag(TaggableObjectTypes.Member, tag, tagGroup);
            }    
        }

        /// &lt;summary&gt;
        /// Gets every tag stored in the database
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetAllTags(string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForEntityType(TaggableObjectTypes.All, tagGroup);
            }  
        }

        /// &lt;summary&gt;
        /// Gets all tags for content items
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetAllContentTags(string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForEntityType(TaggableObjectTypes.Content, tagGroup);
            }
        }

        /// &lt;summary&gt;
        /// Gets all tags for media items
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetAllMediaTags(string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForEntityType(TaggableObjectTypes.Media, tagGroup);
            }
        }

        /// &lt;summary&gt;
        /// Gets all tags for member items
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetAllMemberTags(string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForEntityType(TaggableObjectTypes.Member, tagGroup);
            }
        }

        /// &lt;summary&gt;
        /// Gets all tags attached to a property by entity id
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;contentId&quot;&gt;The content item id to get tags for&lt;/param&gt;
        /// &lt;param name=&quot;propertyTypeAlias&quot;&gt;Property type alias&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetTagsForProperty(int contentId, string propertyTypeAlias, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForProperty(contentId, propertyTypeAlias, tagGroup);
            }
        }

        /// &lt;summary&gt;
        /// Gets all tags attached to an entity (content, media or member) by entity id
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;contentId&quot;&gt;The content item id to get tags for&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetTagsForEntity(int contentId, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForEntity(contentId, tagGroup);
            }
        }

        /// &lt;summary&gt;
        /// Gets all tags attached to a property by entity id
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;contentId&quot;&gt;The content item id to get tags for&lt;/param&gt;
        /// &lt;param name=&quot;propertyTypeAlias&quot;&gt;Property type alias&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetTagsForProperty(Guid contentId, string propertyTypeAlias, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForProperty(contentId, propertyTypeAlias, tagGroup);
            }
        }

        /// &lt;summary&gt;
        /// Gets all tags attached to an entity (content, media or member) by entity id
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Use the optional tagGroup parameter to limit the 
        /// result to a specific &#39;Tag Group&#39;.&lt;/remarks&gt;
        /// &lt;param name=&quot;contentId&quot;&gt;The content item id to get tags for&lt;/param&gt;
        /// &lt;param name=&quot;tagGroup&quot;&gt;Optional name of the &#39;Tag Group&#39;&lt;/param&gt;
        /// &lt;returns&gt;An enumerable list of &lt;see cref=&quot;ITag&quot;/&gt;&lt;/returns&gt;
        public IEnumerable&lt;ITag&gt; GetTagsForEntity(Guid contentId, string tagGroup = null)
        {
            using (var repository = RepositoryFactory.CreateTagRepository(UowProvider.GetUnitOfWork()))
            {
                return repository.GetTagsForEntity(contentId, tagGroup);
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,15,22,78,1],[23,9,23,10,1],[24,9,24,10,1],[27,9,27,10,0],[28,20,28,103,0],[29,13,29,14,0],[30,17,30,59,0],[32,9,32,10,0],[35,9,35,10,0],[36,20,36,103,0],[37,13,37,14,0],[38,17,38,61,0],[40,9,40,10,0],[49,9,49,10,0],[50,20,50,103,0],[51,13,51,14,0],[52,17,52,102,0],[54,9,54,10,0],[64,9,64,10,0],[65,20,65,103,0],[66,13,66,14,0],[67,17,67,102,0],[69,9,69,10,0],[78,9,78,10,0],[79,20,79,103,0],[80,13,80,14,0],[81,17,81,100,0],[83,9,83,10,0],[93,9,93,10,0],[94,20,94,103,0],[95,13,95,14,0],[96,17,96,100,0],[98,9,98,10,0],[107,9,107,10,0],[108,20,108,103,0],[109,13,109,14,0],[110,17,110,101,0],[112,9,112,10,0],[122,9,122,10,0],[123,20,123,103,0],[124,13,124,14,0],[125,17,125,101,0],[127,9,127,10,0],[135,9,135,10,0],[136,20,136,103,0],[137,13,137,14,0],[138,17,138,91,0],[140,9,140,10,0],[150,9,150,10,1],[151,20,151,103,1],[152,13,152,14,1],[153,17,153,95,1],[155,9,155,10,1],[165,9,165,10,0],[166,20,166,103,0],[167,13,167,14,0],[168,17,168,93,0],[170,9,170,10,0],[180,9,180,10,0],[181,20,181,103,0],[182,13,182,14,0],[183,17,183,94,0],[185,9,185,10,0],[197,9,197,10,0],[198,20,198,103,0],[199,13,199,14,0],[200,17,200,94,0],[202,9,202,10,0],[213,9,213,10,1],[214,20,214,103,1],[215,13,215,14,1],[216,17,216,73,1],[218,9,218,10,1],[230,9,230,10,0],[231,20,231,103,0],[232,13,232,14,0],[233,17,233,94,0],[235,9,235,10,0],[246,9,246,10,0],[247,20,247,103,0],[248,13,248,14,0],[249,17,249,73,0],[251,9,251,10,0]]);
    </script>
  </body>
</html>