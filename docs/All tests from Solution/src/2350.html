<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\UmbracoExamine\ContentExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Security;
using System.Xml;
using System.Xml.Linq;
using System.Xml.XPath;
using umbraco;
using umbraco.cms.businesslogic;
using umbraco.cms.businesslogic.web;
using Examine.LuceneEngine;

namespace UmbracoExamine
{
    /// &lt;summary&gt;
    /// Static methods to help query umbraco xml
    /// &lt;/summary&gt;
    public static class ContentExtensions
    {

        /// &lt;summary&gt;
        /// Converts a content node to XDocument
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;cacheOnly&quot;&gt;true if data is going to be returned from cache&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;remarks&gt;
        /// If the type of node is not a Document, the cacheOnly has no effect, it will use the API to return
        /// the xml. 
        /// &lt;/remarks&gt;
		[Obsolete(&quot;This method is no longer used and will be removed in future versions&quot;)]
        public static XDocument ToXDocument(this Content node, bool cacheOnly)
        {
            if (cacheOnly &amp;&amp; node.GetType().Equals(typeof(Document)))
            {
                var umbXml = LegacyLibrary.GetXmlNodeById(node.Id.ToString());
                if (umbXml != null)
                {
                    return umbXml.ToXDocument();    
                }
            }

            //this will also occur if umbraco hasn&#39;t cached content yet....

            //if it&#39;s not a using cache and it&#39;s not cacheOnly, then retrieve the Xml using the API
            return node.ToXDocument();
        }

        /// &lt;summary&gt;
        /// Converts a content node to Xml
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;node&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
       	[Obsolete(&quot;This method is no longer used and will be removed in future versions&quot;)]
        private static XDocument ToXDocument(this Content node)
        {
            var xDoc = new XmlDocument();
            var xNode = xDoc.CreateNode(XmlNodeType.Element, &quot;node&quot;, &quot;&quot;);
            node.XmlPopulate(xDoc, ref xNode, false);

            if (xNode.Attributes[&quot;nodeTypeAlias&quot;] == null)
            {
                //we&#39;ll add the nodeTypeAlias ourselves                                
                XmlAttribute d = xDoc.CreateAttribute(&quot;nodeTypeAlias&quot;);
                d.Value = node.ContentType.Alias;
                xNode.Attributes.Append(d);
            }

            return new XDocument(xNode.ToXElement());
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[33,9,33,10,0],[34,13,34,70,0],[35,13,35,14,0],[36,17,36,79,0],[37,17,37,36,0],[38,17,38,18,0],[39,21,39,49,0],[41,13,41,14,0],[46,13,46,39,0],[47,9,47,10,0],[56,9,56,10,0],[57,13,57,42,0],[58,13,58,74,0],[59,13,59,54,0],[61,13,61,59,0],[62,13,62,14,0],[64,17,64,72,0],[65,17,65,50,0],[66,17,66,44,0],[67,13,67,14,0],[69,13,69,54,0],[70,9,70,10,0]]);
    </script>
  </body>
</html>