<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\EnumerableExtensionsTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Linq;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Tests;
using umbraco.BusinessLogic;

namespace Umbraco.Tests
{
    [TestFixture]
    public class EnumerableExtensionsTests
    {

        [Test]
        public void Unsorted_Sequence_Equal()
        {
            var list1 = new[] { 1, 2, 3, 4, 5, 6 };
            var list2 = new[] { 6, 5, 3, 2, 1, 4 };
            var list3 = new[] { 6, 5, 4, 3, 2, 2 };

            Assert.IsTrue(list1.UnsortedSequenceEqual(list2));
            Assert.IsTrue(list2.UnsortedSequenceEqual(list1));
            Assert.IsFalse(list1.UnsortedSequenceEqual(list3));

            Assert.IsTrue(((IEnumerable&lt;object&gt;)null).UnsortedSequenceEqual(null));
            Assert.IsFalse(((IEnumerable&lt;int&gt;)null).UnsortedSequenceEqual(list1));
            Assert.IsFalse(list1.UnsortedSequenceEqual(null));
        }

        [Test]
        public void Contains_All()
        {
            var list1 = new[] {1, 2, 3, 4, 5, 6};
            var list2 = new[] {6, 5, 3, 2, 1, 4};
            var list3 = new[] {6, 5, 4, 3};

            Assert.IsTrue(list1.ContainsAll(list2));
            Assert.IsTrue(list2.ContainsAll(list1));
            Assert.IsTrue(list1.ContainsAll(list3));
            Assert.IsFalse(list3.ContainsAll(list1));
        }

        [Test]
        public void Flatten_List_2()
        {
            var hierarchy = new TestItem()
                {
                    Children = new List&lt;TestItem&gt;()
                        {
                            new TestItem(),
                            new TestItem(),
                            new TestItem()
                        }
                };

            var flattened = hierarchy.Children.FlattenList(x =&gt; x.Children);
            var selectRecursive = hierarchy.Children.SelectRecursive(x =&gt; x.Children);

            Assert.AreEqual(3, flattened.Count());
            Assert.AreEqual(3, selectRecursive.Count());

            Assert.IsTrue(flattened.SequenceEqual(selectRecursive));
        }

        [Test]
        public void Flatten_List()
        {
            var hierarchy = new TestItem()
                {
                    Children = new List&lt;TestItem&gt;()
	                    {
	                        new TestItem()
	                            {
	                                Children = new List&lt;TestItem&gt;()
	                                    {
	                                        new TestItem()
	                                            {
	                                                Children = new List&lt;TestItem&gt;()
	                                                    {
	                                                        new TestItem()
	                                                            {
	                                                                Children = new List&lt;TestItem&gt;()
	                                                                    {
	                                                                        new TestItem(),
                                                                            new TestItem()
	                                                                    }
	                                                            }
	                                                    }
	                                            }
	                                    }
	                            },
	                        new TestItem()
	                            {
	                                Children = new List&lt;TestItem&gt;()
	                                    {
	                                        new TestItem()
	                                            {
	                                                Children = new List&lt;TestItem&gt;()
	                                                    {
	                                                        new TestItem()
	                                                            {
	                                                                Children = new List&lt;TestItem&gt;()
	                                                            }
	                                                    }
	                                            },
	                                        new TestItem()
	                                            {
	                                                Children = new List&lt;TestItem&gt;()
	                                                    {
	                                                        new TestItem()
	                                                            {
	                                                                Children = new List&lt;TestItem&gt;()
	                                                            }
	                                                    }
	                                            }
	                                    }
	                            },
	                    }
                };

            var flattened = hierarchy.Children.FlattenList(x =&gt; x.Children);
            var selectRecursive = hierarchy.Children.FlattenList(x =&gt; x.Children);

            Assert.AreEqual(10, flattened.Count());
            Assert.AreEqual(10, selectRecursive.Count());

            Assert.IsTrue(flattened.SequenceEqual(selectRecursive));
        }

        private class TestItem
        {
            public TestItem()
            {
                Children = Enumerable.Empty&lt;TestItem&gt;();
            }
            public IEnumerable&lt;TestItem&gt; Children { get; set; }
        }

	    [Test]
        public void InGroupsOf_ReturnsAllElements()
        {
            var integers = new[] { 0, 1, 2, 3, 4, 5, 6, 7, 8 };

            var groupsOfTwo = integers.InGroupsOf(2).ToArray();

            var flattened = groupsOfTwo.SelectMany(x =&gt; x).ToArray();

            Assert.That(groupsOfTwo.Length, Is.EqualTo(5));
            Assert.That(flattened.Length, Is.EqualTo(integers.Length));
            CollectionAssert.AreEquivalent(integers, flattened);

            var groupsOfMassive = integers.InGroupsOf(100).ToArray();
            Assert.That(groupsOfMassive.Length, Is.EqualTo(1));
            flattened = groupsOfMassive.SelectMany(x =&gt; x).ToArray();
            Assert.That(flattened.Length, Is.EqualTo(integers.Length));
            CollectionAssert.AreEquivalent(integers, flattened);
        }

        [TestCase]
        public void DistinctBy_ReturnsDistinctElements_AndResetsIteratorCorrectly()
        {
            // Arrange
            var tuple1 = new System.Tuple&lt;string, string&gt;(&quot;fruit&quot;, &quot;apple&quot;);
            var tuple2 = new System.Tuple&lt;string, string&gt;(&quot;fruit&quot;, &quot;orange&quot;);
            var tuple3 = new System.Tuple&lt;string, string&gt;(&quot;fruit&quot;, &quot;banana&quot;);
            var tuple4 = new System.Tuple&lt;string, string&gt;(&quot;fruit&quot;, &quot;banana&quot;); // Should be filtered out
            var list = new List&lt;System.Tuple&lt;string, string&gt;&gt;()
                {
                    tuple1,
                    tuple2,
                    tuple3,
                    tuple4
                };

            // Act
            var iteratorSource = list.DistinctBy(x =&gt; x.Item2);

            // Assert
            // First check distinction
            Assert.AreEqual(3, iteratorSource.Count());

            // Check for iterator block mistakes - reset to original query first
            iteratorSource = list.DistinctBy(x =&gt; x.Item2);
            Assert.AreEqual(iteratorSource.Count(), iteratorSource.ToList().Count());
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,1],[17,13,17,52,1],[18,13,18,52,1],[19,13,19,52,1],[21,13,21,63,1],[22,13,22,63,1],[23,13,23,64,1],[25,13,25,84,1],[26,13,26,83,1],[27,13,27,63,1],[28,9,28,10,1],[32,9,32,10,1],[33,13,33,50,1],[34,13,34,50,1],[35,13,35,44,1],[37,13,37,53,1],[38,13,38,53,1],[39,13,39,53,1],[40,13,40,54,1],[41,9,41,10,1],[45,9,45,10,1],[46,13,54,19,1],[56,13,56,65,1],[56,65,56,75,1],[56,75,56,77,1],[56,13,56,77,1],[57,13,57,75,1],[57,75,57,85,1],[57,85,57,87,1],[57,13,57,87,1],[59,13,59,51,1],[60,13,60,57,1],[62,13,62,69,1],[63,9,63,10,1],[67,9,67,10,1],[68,13,119,19,1],[121,13,121,65,1],[121,65,121,75,1],[121,75,121,77,1],[121,13,121,77,1],[122,13,122,71,1],[122,71,122,81,1],[122,81,122,83,1],[122,13,122,83,1],[124,13,124,52,1],[125,13,125,58,1],[127,13,127,69,1],[128,9,128,10,1],[132,13,132,30,1],[133,13,133,14,1],[134,17,134,57,1],[135,13,135,14,1],[136,53,136,57,1],[136,58,136,62,1],[141,9,141,10,1],[142,13,142,64,1],[144,13,144,64,1],[146,13,146,57,1],[146,57,146,58,1],[146,58,146,70,1],[146,13,146,70,1],[148,13,148,60,1],[149,13,149,72,1],[150,13,150,65,1],[152,13,152,70,1],[153,13,153,64,1],[154,13,154,57,1],[154,57,154,58,1],[154,58,154,70,1],[154,13,154,70,1],[155,13,155,72,1],[156,13,156,65,1],[157,9,157,10,1],[161,9,161,10,1],[163,13,163,77,1],[164,13,164,78,1],[165,13,165,78,1],[166,13,166,78,1],[167,13,173,19,1],[176,13,176,55,1],[176,55,176,62,1],[176,62,176,64,1],[176,13,176,64,1],[180,13,180,56,1],[183,13,183,51,1],[183,51,183,58,1],[183,58,183,60,1],[183,13,183,60,1],[184,13,184,86,1],[185,9,185,10,1]]);
    </script>
  </body>
</html>