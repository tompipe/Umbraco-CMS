<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\SettingControls\Pickers\Content.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using umbraco.cms.businesslogic.datatype;
using System.Web.UI.WebControls;

namespace umbraco.editorControls.SettingControls.Pickers
{
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class Content : DataEditorSettingType
    {
        private ContentPickerWithXpathOption cc = new ContentPickerWithXpathOption();

        private string _val = string.Empty;
        public override string Value
        {
            get
            {
                return cc.Value;
            }
            set
            {
                if (!string.IsNullOrEmpty(value))
                    _val = value;
            }
        }

        public override System.Web.UI.Control RenderControl(DataEditorSetting sender)
        {

            cc.ShowXPath = false;
            cc.ID = sender.GetName().Replace(&quot; &quot;, &quot;_&quot;);

            cc.Value = _val;
            return cc;
        }
    }

    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class ContentWithXpath : DataEditorSettingType
    {
        private ContentPickerWithXpathOption cc = new ContentPickerWithXpathOption();

        private string _val = string.Empty;
        public override string Value
        {
            get
            {
                return cc.Value;
            }
            set
            {
                if (!string.IsNullOrEmpty(value))
                    _val = value;
            }
        }

        public override System.Web.UI.Control RenderControl(DataEditorSetting sender)
        {
            cc.ShowXPath = true;
            cc.ID = sender.GetName().Replace(&quot; &quot;, &quot;_&quot;);

            cc.Value = _val;
            return cc;
        }
    }


    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class ContentPickerWithXpathOption : WebControl
    {
        private bool _showXPath = true;

        public bool ShowXPath
        {
            get { return _showXPath; }
            set { _showXPath = value; }
        }

        private umbraco.controls.ContentPicker cc;
        private TextBox tb;

        public ContentPickerWithXpathOption()
        {
            EnsureChildControls();
        }

        protected override void OnInit(EventArgs e)
        {


            Page.ClientScript.RegisterClientScriptBlock(this.GetType(), &quot;contentpickerxpath&quot;, @&quot;
                    
                function showXpathTextbox(control)
                {
                        $(&#39;.picker&#39;,$(&#39;#&#39; + control)).hide();
                        $(&#39;.xpath&#39;,$(&#39;#&#39; + control)).show();
                }

                function showContentPicker(control)
                {
                        $(&#39;.xpath&#39;,$(&#39;#&#39; + control)).hide();
                        $(&#39;.xpath input&#39;,$(&#39;#&#39; + control)).val(&#39;&#39;);
                        $(&#39;.picker&#39;,$(&#39;#&#39; + control)).show();
                }
            &quot;, true);

            base.OnInit(e);
        }

        protected override void CreateChildControls()
        {
            cc = new umbraco.controls.ContentPicker();
            this.Controls.Add(cc);


            if (_showXPath)
            {
                tb = new TextBox();
                tb.CssClass = &quot;guiInputText guiInputStandardSize&quot;;
                this.Controls.Add(tb);
            }
        }

        protected override void RenderChildren(System.Web.UI.HtmlTextWriter writer)
        {

            writer.Write(string.Format(&quot;&lt;div class=\&quot;picker\&quot;{0}&gt;&quot;, tb.Text != string.Empty ? &quot; style=\&quot;display:none\&quot;&quot; : &quot;&quot;));
            cc.RenderControl(writer);

            if (_showXPath)
            {
                writer.Write(string.Format(
                    &quot;&amp;nbsp&lt;a href=\&quot;javascript:showXpathTextbox(&#39;{0}&#39;);\&quot;&gt;Or enter Xpath&lt;/a&gt;&quot;,
                    this.ClientID));

                writer.Write(&quot;&lt;/div&gt;&quot;);

                writer.Write(string.Format(&quot;&lt;div class=\&quot;xpath\&quot;{0}&gt;&quot;, !(tb.Text != string.Empty) ? &quot; style=\&quot;display:none\&quot;&quot; : &quot;&quot;));
                tb.RenderControl(writer);

                writer.Write(string.Format(
                    &quot;&amp;nbsp;&lt;a href=\&quot;javascript:showContentPicker(&#39;{0}&#39;);\&quot;&gt;Or pick node&lt;/a&gt;&quot;,
                    this.ClientID));
            }

            writer.Write(&quot;&lt;/div&gt;&quot;);
        }




        private string _val = string.Empty;
        public string Value
        {
            get
            {

                if (_showXPath &amp;&amp; tb.Text != string.Empty)
                    return tb.Text;
                else
                    return cc.Value;
            }
            set
            {
                if (!string.IsNullOrEmpty(value))
                {
                    _val = value;

                    int nodeId;

                    if (int.TryParse(_val, out nodeId))
                        cc.Value = _val;
                    else if (ShowXPath)
                        tb.Text = _val;
                }
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[13,9,13,86,0],[15,9,15,44,0],[19,13,19,14,0],[20,17,20,33,0],[21,13,21,14,0],[23,13,23,14,0],[24,17,24,50,0],[25,21,25,34,0],[26,13,26,14,0],[30,9,30,10,0],[32,13,32,34,0],[33,13,33,56,0],[35,13,35,29,0],[36,13,36,23,0],[37,9,37,10,0],[43,9,43,86,0],[45,9,45,44,0],[49,13,49,14,0],[50,17,50,33,0],[51,13,51,14,0],[53,13,53,14,0],[54,17,54,50,0],[55,21,55,34,0],[56,13,56,14,0],[60,9,60,10,0],[61,13,61,33,0],[62,13,62,56,0],[64,13,64,29,0],[65,13,65,23,0],[66,9,66,10,0],[73,9,73,40,0],[77,17,77,18,0],[77,19,77,37,0],[77,38,77,39,0],[78,17,78,18,0],[78,19,78,38,0],[78,39,78,40,0],[84,9,84,46,0],[85,9,85,10,0],[86,13,86,35,0],[87,9,87,10,0],[90,9,90,10,0],[93,13,107,22,0],[109,13,109,28,0],[110,9,110,10,0],[113,9,113,10,0],[114,13,114,55,0],[115,13,115,35,0],[118,13,118,28,0],[119,13,119,14,0],[120,17,120,36,0],[121,17,121,67,0],[122,17,122,39,0],[123,13,123,14,0],[124,9,124,10,0],[127,9,127,10,0],[129,13,129,128,0],[130,13,130,38,0],[132,13,132,28,0],[133,13,133,14,0],[134,17,136,37,0],[138,17,138,40,0],[140,17,140,134,0],[141,17,141,42,0],[143,17,145,37,0],[146,13,146,14,0],[148,13,148,36,0],[149,9,149,10,0],[154,9,154,44,0],[158,13,158,14,0],[160,17,160,59,0],[161,21,161,36,0],[163,21,163,37,0],[164,13,164,14,0],[166,13,166,14,0],[167,17,167,50,0],[168,17,168,18,0],[169,21,169,34,0],[173,21,173,56,0],[174,25,174,41,0],[175,26,175,40,0],[176,25,176,40,0],[177,17,177,18,0],[178,13,178,14,0]]);
    </script>
  </body>
</html>