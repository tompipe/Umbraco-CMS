<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Persistence\Migrations\Syntax\Create\Expressions\CreateConstraintExpression.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Linq;
using Umbraco.Core.Persistence.DatabaseModelDefinitions;
using Umbraco.Core.Persistence.SqlSyntax;

namespace Umbraco.Core.Persistence.Migrations.Syntax.Create.Expressions
{
    public class CreateConstraintExpression : MigrationExpressionBase
    {
        public CreateConstraintExpression(DatabaseProviders current, DatabaseProviders[] databaseProviders, ISqlSyntaxProvider sqlSyntax, ConstraintType constraint) 
            : base(current, databaseProviders, sqlSyntax)
        {
            Constraint = new ConstraintDefinition(constraint);
        }
        

        public ConstraintDefinition Constraint { get; private set; }

        public override string ToString()
        {
            var constraintType = (Constraint.IsPrimaryKeyConstraint) ? &quot;PRIMARY KEY&quot; : &quot;UNIQUE&quot;;

            if (Constraint.IsPrimaryKeyConstraint &amp;&amp; SqlSyntax.SupportsClustered())
                constraintType += &quot; CLUSTERED&quot;;

            if (Constraint.IsNonUniqueConstraint)
                constraintType = string.Empty;

            var columns = new string[Constraint.Columns.Count];

            for (int i = 0; i &lt; Constraint.Columns.Count; i++)
            {
                columns[i] = SqlSyntax.GetQuotedColumnName(Constraint.Columns.ElementAt(i));
            }

            return string.Format(SqlSyntax.CreateConstraint,
                                 SqlSyntax.GetQuotedTableName(Constraint.TableName),
                                 SqlSyntax.GetQuotedName(Constraint.ConstraintName),
                                 constraintType,
                                 string.Join(&quot;, &quot;, columns));
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[10,15,10,58,1],[11,9,11,10,1],[12,13,12,63,1],[13,9,13,10,1],[16,50,16,54,1],[16,55,16,67,1],[19,9,19,10,1],[20,13,20,97,1],[22,13,22,84,1],[23,17,23,48,0],[25,13,25,50,1],[26,17,26,47,0],[28,13,28,64,1],[30,18,30,27,1],[30,29,30,57,1],[30,59,30,62,1],[31,13,31,14,1],[32,17,32,93,1],[33,13,33,14,1],[35,13,39,62,1],[40,9,40,10,1]]);
    </script>
  </body>
</html>