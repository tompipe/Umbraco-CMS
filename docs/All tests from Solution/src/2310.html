<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.MacroEngines\RazorCore\BaseContext.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web.WebPages;
using umbraco.cms.businesslogic.macro;
using umbraco.interfaces;
using umbraco.MacroEngines.Library;

namespace umbraco.MacroEngines
{
    public abstract class BaseContext&lt;T&gt; : WebPage, IMacroContext
    {

        private MacroModel _macro;
        private INode _node;
        protected T CurrentModel;
        protected IParameterDictionary ParameterDictionary;
        protected ICultureDictionary CultureDictionary;

        public dynamic Parameter { get { return ParameterDictionary; } }
        public dynamic Dictionary { get { return CultureDictionary; } }

        public MacroModel Macro { get { return _macro; } }
        public INode Node { get { return _node; } }

        public T Current { get { return CurrentModel; } }
        public new dynamic Model { get { return CurrentModel; } }

        public virtual void SetMembers(MacroModel macro, INode node)
        {
            if (macro == null)
                throw new ArgumentNullException(&quot;macro&quot;);
            if (node == null)
                throw new ArgumentNullException(&quot;node&quot;);
            _macro = macro;
            ParameterDictionary = new UmbracoParameterDictionary(macro.Properties);
            CultureDictionary = new UmbracoCultureDictionary();
            _node = node;
        }

        protected override void ConfigurePage(WebPageBase parentPage)
        {
            if (parentPage == null)
                return;
            //Inject SetMembers Into New Context
            if (parentPage is IMacroContext)
            {
                var macroContext = (IMacroContext)parentPage;
                SetMembers(macroContext.Macro, macroContext.Node);
            }
        }

        public string GetParameter(string alias)
        {
            return ParameterDictionary[alias];
        }

        public string GetDictionary(string key)
        {
            return CultureDictionary[key];
        }

        public RazorLibraryCore Library
        {
            get
            {
                return new RazorLibraryCore(this._node);
            }
        }


    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[18,40,18,41,0],[18,42,18,69,0],[18,70,18,71,0],[19,41,19,42,0],[19,43,19,68,0],[19,69,19,70,0],[21,39,21,40,0],[21,41,21,55,0],[21,56,21,57,0],[22,33,22,34,0],[22,35,22,48,0],[22,49,22,50,0],[24,32,24,33,0],[24,34,24,54,0],[24,55,24,56,0],[25,40,25,41,0],[25,42,25,62,0],[25,63,25,64,0],[28,9,28,10,0],[29,13,29,31,0],[30,17,30,58,0],[31,13,31,30,0],[32,17,32,57,0],[33,13,33,28,0],[34,13,34,84,0],[35,13,35,64,0],[36,13,36,26,0],[37,9,37,10,0],[40,9,40,10,0],[41,13,41,36,0],[42,17,42,24,0],[44,13,44,45,0],[45,13,45,14,0],[46,17,46,62,0],[47,17,47,67,0],[48,13,48,14,0],[49,9,49,10,0],[52,9,52,10,0],[53,13,53,47,0],[54,9,54,10,0],[57,9,57,10,0],[58,13,58,43,0],[59,9,59,10,0],[64,13,64,14,0],[65,17,65,57,0],[66,13,66,14,0]]);
    </script>
  </body>
</html>