<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.cms\businesslogic\datatype\DataEditorSettingsStorage.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Linq;
using System.Text;
using umbraco.DataLayer;

namespace umbraco.cms.businesslogic.datatype
{
    [Obsolete(&quot;This class is no longer used and will be removed from the codebase in the future.&quot;)]
    public class DataEditorSettingsStorage
    {
        private ISqlHelper sqlHelper;

        public DataEditorSettingsStorage()
        {
            var databaseSettings = ConfigurationManager.ConnectionStrings[Umbraco.Core.Configuration.GlobalSettings.UmbracoConnectionName];
            var dataHelper = DataLayerHelper.CreateSqlHelper(databaseSettings.ConnectionString, false);

            init(DataLayerHelper.CreateSqlHelper(dataHelper.ConnectionString, false));
        }

        private void init(ISqlHelper connection)
        {
            sqlHelper = connection;
        }

        public List&lt;Setting&lt;string, string&gt;&gt; GetSettings(int dataTypeNodeID)
        {
            string sql = &quot;select * from cmsDataTypePreValues where datatypenodeid = @datatypenodeid&quot;;
            using (IRecordsReader settingsReader = sqlHelper.ExecuteReader(sql, sqlHelper.CreateParameter(&quot;@datatypenodeid&quot;, dataTypeNodeID)))
            {
                List&lt;Setting&lt;string, string&gt;&gt; settings = new List&lt;Setting&lt;string, string&gt;&gt;();

                while (settingsReader.Read())
                {
                    Setting&lt;string, string&gt; setting = new Setting&lt;string, string&gt;();
                    setting.Key = settingsReader.GetString(&quot;alias&quot;);
                    setting.Value = settingsReader.GetString(&quot;value&quot;);
                    settings.Add(setting);
                }

                return settings;
            }
        }


        public void ClearSettings(int dataTypeNodeID)
        {
            string sql = &quot;delete from cmsDataTypePreValues where datatypenodeid = @datatypenodeid&quot;;
            sqlHelper.ExecuteNonQuery(sql, sqlHelper.CreateParameter(&quot;@datatypenodeid&quot;, dataTypeNodeID));
        }


        public void InsertSettings(int dataTypeNodeID, List&lt;Setting&lt;string, string&gt;&gt; settings)
        {
            int i = 0;
            foreach (Setting&lt;string, string&gt; s in settings)
            {
                string sql = &quot;insert into cmsDataTypePreValues (datatypenodeid,[value],sortorder,alias) values (@datatypenodeid,@value,@sortorder,@alias)&quot;;
                sqlHelper.ExecuteNonQuery(sql,
                    sqlHelper.CreateParameter(&quot;@datatypenodeid&quot;, dataTypeNodeID),
                    sqlHelper.CreateParameter(&quot;@alias&quot;, s.Key),
                    sqlHelper.CreateParameter(&quot;@value&quot;, s.Value),
                    sqlHelper.CreateParameter(&quot;@sortorder&quot;, i));

                i++;
            }

        }


        public void InsertSetting(int dataTypeNodeID, string key, string value, int sortOrder)
        {

            string sql = &quot;insert into cmsDataTypePreValues (datatypenodeid,[value],sortorder,alias) values (@datatypenodeid,@value,@sortorder,@alias)&quot;;
            sqlHelper.ExecuteNonQuery(sql,
                sqlHelper.CreateParameter(&quot;@datatypenodeid&quot;, dataTypeNodeID),
                sqlHelper.CreateParameter(&quot;@alias&quot;, key),
                sqlHelper.CreateParameter(&quot;@value&quot;, value),
                sqlHelper.CreateParameter(&quot;@sortorder&quot;, sortOrder));

        }

        public void UpdateSettings(int dataTypeNodeID, List&lt;Setting&lt;string, string&gt;&gt; settings)
        {
            ClearSettings(dataTypeNodeID);
            InsertSettings(dataTypeNodeID, settings);
        }

        #region IDisposable Members

        public void Dispose()
        {
            sqlHelper.Dispose();
            sqlHelper = null;
        }

        #endregion
    }

    public struct Setting&lt;K, V&gt;
    {
        public K Key { get; set; }
        public V Value { get; set; }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[15,9,15,43,0],[16,9,16,10,0],[17,13,17,140,0],[18,13,18,104,0],[20,13,20,87,0],[21,9,21,10,0],[24,9,24,10,0],[25,13,25,36,0],[26,9,26,10,0],[29,9,29,10,0],[30,13,30,102,0],[31,20,31,142,0],[32,13,32,14,0],[33,17,33,94,0],[35,17,35,46,0],[36,17,36,18,0],[37,21,37,85,0],[38,21,38,69,0],[39,21,39,71,0],[40,21,40,43,0],[41,17,41,18,0],[43,17,43,33,0],[45,9,45,10,0],[49,9,49,10,0],[50,13,50,100,0],[51,13,51,106,0],[52,9,52,10,0],[56,9,56,10,0],[57,13,57,23,0],[58,13,58,20,0],[58,22,58,47,0],[58,48,58,50,0],[58,51,58,59,0],[59,13,59,14,0],[60,17,60,156,0],[61,17,65,65,0],[67,17,67,21,0],[68,13,68,14,0],[70,9,70,10,0],[74,9,74,10,0],[76,13,76,152,0],[77,13,81,69,0],[83,9,83,10,0],[86,9,86,10,0],[87,13,87,43,0],[88,13,88,54,0],[89,9,89,10,0],[94,9,94,10,0],[95,13,95,33,0],[96,13,96,30,0],[97,9,97,10,0],[104,24,104,28,0],[104,29,104,33,0],[105,26,105,30,0],[105,31,105,35,0]]);
    </script>
  </body>
</html>