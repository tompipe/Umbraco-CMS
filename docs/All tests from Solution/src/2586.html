<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.datalayer\SqlHelpers\SqlServer\SqlServerHelper.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
/************************************************************************************
 * 
 *  Umbraco Data Layer
 *  MIT Licensed work
 *  ï¿½2008 Ruben Verborgh
 * 
 ***********************************************************************************/

using System;
using System.Data;
using System.Data.SqlClient;
using System.Xml;
using SH = Microsoft.ApplicationBlocks.Data.SqlHelper;
using System.Diagnostics;

namespace umbraco.DataLayer.SqlHelpers.SqlServer
{
    /// &lt;summary&gt;
    /// Sql Helper for an SQL Server database.
    /// &lt;/summary&gt;
    public class SqlServerHelper : SqlHelper&lt;SqlParameter&gt;
    {
        /// &lt;summary&gt;
        /// Initializes a new instance of the &lt;see cref=&quot;SqlServerHelper&quot;/&gt; class.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;connectionString&quot;&gt;The connection string.&lt;/param&gt;
        public SqlServerHelper(string connectionString) : base(connectionString)
        {
            m_Utility = new SqlServerUtility(this);
        }

        /// &lt;summary&gt;
        /// Creates a new parameter for use with this specific implementation of ISqlHelper.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;parameterName&quot;&gt;Name of the parameter.&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;Value of the parameter.&lt;/param&gt;
        /// &lt;returns&gt;A new parameter of the correct type.&lt;/returns&gt;
        /// &lt;remarks&gt;Abstract factory pattern&lt;/remarks&gt;
        public override IParameter CreateParameter(string parameterName, object value)
        {
            return new SqlServerParameter(parameterName, value);
        }

        /// &lt;summary&gt;
        /// Executes a command that returns a single value.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;commandText&quot;&gt;The command text.&lt;/param&gt;
        /// &lt;param name=&quot;parameters&quot;&gt;The parameters.&lt;/param&gt;
        /// &lt;returns&gt;The return value of the command.&lt;/returns&gt;
        protected override object ExecuteScalar(string commandText, SqlParameter[] parameters)
        {
            #if DEBUG &amp;&amp; DebugDataLayer
                // Log Query Execution
                Trace.TraceInformation(GetType().Name + &quot; SQL ExecuteScalar: &quot; + commandText);
            #endif

            return SH.ExecuteScalar(ConnectionString, CommandType.Text, commandText, parameters);
        }

        /// &lt;summary&gt;
        /// Executes a command and returns the number of rows affected.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;commandText&quot;&gt;The command text.&lt;/param&gt;
        /// &lt;param name=&quot;parameters&quot;&gt;The parameters.&lt;/param&gt;
        /// &lt;returns&gt;
        /// The number of rows affected by the command.
        /// &lt;/returns&gt;
        protected override int ExecuteNonQuery(string commandText, SqlParameter[] parameters)
        {
            #if DEBUG &amp;&amp; DebugDataLayer
                // Log Query Execution
                Trace.TraceInformation(GetType().Name + &quot; SQL ExecuteNonQuery: &quot; + commandText);
            #endif

            return SH.ExecuteNonQuery(ConnectionString, CommandType.Text, commandText, parameters);
        }

        /// &lt;summary&gt;
        /// Executes a command and returns a records reader containing the results.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;commandText&quot;&gt;The command text.&lt;/param&gt;
        /// &lt;param name=&quot;parameters&quot;&gt;The parameters.&lt;/param&gt;
        /// &lt;returns&gt;
        /// A data reader containing the results of the command.
        /// &lt;/returns&gt;
        protected override IRecordsReader ExecuteReader(string commandText, SqlParameter[] parameters)
        {
            #if DEBUG &amp;&amp; DebugDataLayer
                // Log Query Execution
                Trace.TraceInformation(GetType().Name + &quot; SQL ExecuteReader: &quot; + commandText);
            #endif

            return new SqlServerDataReader(SH.ExecuteReader(ConnectionString, CommandType.Text,
                                                            commandText, parameters));
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[27,59,27,81,0],[28,9,28,10,0],[29,13,29,52,0],[30,9,30,10,0],[40,9,40,10,0],[41,13,41,65,0],[42,9,42,10,0],[51,9,51,10,0],[54,17,54,95,0],[57,13,57,98,0],[58,9,58,10,0],[69,9,69,10,0],[72,17,72,97,0],[75,13,75,100,0],[76,9,76,10,0],[87,9,87,10,0],[90,17,90,95,0],[93,13,94,87,0],[95,9,95,10,0]]);
    </script>
  </body>
</html>