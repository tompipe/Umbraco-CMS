<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\HealthCheck\Checks\Config\MacroErrorsCheck.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Linq;
using Umbraco.Core.Services;

namespace Umbraco.Web.HealthCheck.Checks.Config
{
    [HealthCheck(&quot;D0F7599E-9B2A-4D9E-9883-81C7EDC5616F&quot;, &quot;Macro errors&quot;,
        Description = &quot;Checks to make sure macro errors are not set to throw a YSOD (yellow screen of death), which would prevent certain or all pages from loading completely.&quot;,
        Group = &quot;Configuration&quot;)]
    public class MacroErrorsCheck : AbstractConfigCheck
    {
        private readonly ILocalizedTextService _textService;

        public MacroErrorsCheck(HealthCheckContext healthCheckContext) : base(healthCheckContext)
        {
            _textService = healthCheckContext.ApplicationContext.Services.TextService;
        }

        public override string FilePath
        {
            get { return &quot;~/Config/umbracoSettings.config&quot;; }
        }

        public override string XPath
        {
            get { return &quot;/settings/content/MacroErrors&quot;; }
        }

        public override ValueComparisonType ValueComparisonType
        {
            get { return ValueComparisonType.ShouldEqual; }
        }

        public override IEnumerable&lt;AcceptableConfiguration&gt; Values
        {
            get
            {
                var values = new List&lt;AcceptableConfiguration&gt;
                {
                    new AcceptableConfiguration
                    {
                        IsRecommended = true,
                        Value = &quot;inline&quot;
                    },
                    new AcceptableConfiguration
                    {
                        IsRecommended = false,
                        Value = &quot;silent&quot;
                    }
                };

                return values;
            }
        }
        
        public override string CheckSuccessMessage
        {
            get
            {
                return _textService.Localize(&quot;healthcheck/macroErrorModeCheckSuccessMessage&quot;,
                    new[] { CurrentValue, Values.First(v =&gt; v.IsRecommended).Value });
            }
        }

        public override string CheckErrorMessage
        {
            get
            {
                return _textService.Localize(&quot;healthcheck/macroErrorModeCheckErrorMessage&quot;,
                    new[] { CurrentValue, Values.First(v =&gt; v.IsRecommended).Value });
            }
        }

        public override string RectifySuccessMessage
        {
            get
            {
                return _textService.Localize(&quot;healthcheck/macroErrorModeCheckRectifySuccessMessage&quot;,
                    new[] { Values.First(v =&gt; v.IsRecommended).Value });
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[14,74,14,98,0],[15,9,15,10,0],[16,13,16,87,0],[17,9,17,10,0],[21,17,21,18,0],[21,19,21,60,0],[21,61,21,62,0],[26,17,26,18,0],[26,19,26,58,0],[26,59,26,60,0],[31,17,31,18,0],[31,19,31,58,0],[31,59,31,60,0],[37,13,37,14,0],[38,17,50,19,0],[52,17,52,31,0],[53,13,53,14,0],[59,13,59,14,0],[60,17,61,61,0],[61,61,61,76,0],[61,76,61,87,0],[60,17,61,87,0],[62,13,62,14,0],[68,13,68,14,0],[69,17,70,61,0],[70,61,70,76,0],[70,76,70,87,0],[69,17,70,87,0],[71,13,71,14,0],[77,13,77,14,0],[78,17,79,47,0],[79,47,79,62,0],[79,62,79,73,0],[78,17,79,73,0],[80,13,80,14,0]]);
    </script>
  </body>
</html>