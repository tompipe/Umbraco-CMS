<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\PublishedContent\RootNodeTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;
using umbraco;
using umbraco.MacroEngines;
using Umbraco.Web;
using Umbraco.Web.Models;
using Umbraco.Web.Security;

namespace Umbraco.Tests.PublishedContent
{
    [TestFixture]
    public class RootNodeTests : PublishedContentTestBase
    {
        [Test]
        public void PublishedContentHasNoRootNode()
        {
            var ctx = GetUmbracoContext(&quot;/test&quot;, 1234);

            // there is no content node with ID -1
            var content = ctx.ContentCache.GetById(-1);
            Assert.IsNull(content);

            // content at root has null parent
            content = ctx.ContentCache.GetById(1046);
            Assert.IsNotNull(content);
            Assert.AreEqual(1, content.Level);
            Assert.IsNull(content.Parent);

            // and yet is has siblings, etc.
            var siblings = content.Siblings();
            Assert.AreEqual(2, siblings.Count());

            // non-existing content is null
            content = ctx.ContentCache.GetById(666);
            Assert.IsNull(content);
        }

        [Test]
        public void LegacyDynamicNodeSortOfHasRootNode()
        {
            // there is a node with ID -1
            var node = new DynamicNode(-1);
            Assert.IsNotNull(node);
            Assert.AreEqual(-1, node.Id);

            // content at root
            node = new DynamicNode(1046);
            Assert.IsNotNull(node);
            Assert.AreEqual(1, node.Level);

            // has no parent
            // (confirmed in 4.7 and 6.1)
            Assert.IsNull(node.Parent);

            // has siblings etc - no idea how we&#39;re supposed to get them?
            //var siblings = node.Parent.Children; 
            //Assert.AreEqual(2, siblings.Count());

            // non-existing content is &quot;zero node&quot;
            node = new DynamicNode(666, DynamicBackingItemType.Content); // set type to avoid Examine in tests
            Assert.IsNotNull(node);
            Assert.AreEqual(0, node.Id);
        }

        [Test]
        public void Fix_U4_4374()
        {
            var node = new DynamicNode(-1);
            var id = node.DescendantsOrSelf().First().Id;
            Assert.AreEqual(-1, id);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[19,9,19,10,1],[20,13,20,56,1],[23,13,23,56,1],[24,13,24,36,1],[27,13,27,54,1],[28,13,28,39,1],[29,13,29,47,1],[30,13,30,43,1],[33,13,33,47,1],[34,13,34,50,1],[37,13,37,53,1],[38,13,38,36,1],[39,9,39,10,1],[43,9,43,10,1],[45,13,45,44,1],[46,13,46,36,1],[47,13,47,42,1],[50,13,50,42,1],[51,13,51,36,1],[52,13,52,44,1],[56,13,56,40,1],[63,13,63,73,1],[64,13,64,36,1],[65,13,65,41,1],[66,9,66,10,1],[70,9,70,10,1],[71,13,71,44,1],[72,13,72,58,1],[73,13,73,37,1],[74,9,74,10,1]]);
    </script>
  </body>
</html>