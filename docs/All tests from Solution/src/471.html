<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\Trees\loadScripts.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Linq;
using System.Text;
using System.Web;
using System.Xml;
using System.Configuration;
using Umbraco.Core;
using umbraco.BasePages;
using umbraco.BusinessLogic;
using umbraco.businesslogic;
using umbraco.cms.businesslogic;
using umbraco.cms.businesslogic.cache;
using umbraco.cms.businesslogic.contentitem;
using umbraco.cms.businesslogic.datatype;
using umbraco.cms.businesslogic.language;
using umbraco.cms.businesslogic.media;
using umbraco.cms.businesslogic.member;
using umbraco.cms.businesslogic.property;
using umbraco.cms.businesslogic.web;
using umbraco.interfaces;
using umbraco.DataLayer;
using umbraco.BusinessLogic.Utils;
using umbraco.cms.presentation.Trees;
using umbraco.BusinessLogic.Actions;
using Umbraco.Core.IO;
using Umbraco.Core;


namespace umbraco
{
    [Tree(Constants.Applications.Settings, &quot;scripts&quot;, &quot;Scripts&quot;, &quot;icon-folder&quot;, &quot;icon-folder&quot;, sortOrder: 2)]
    public class loadScripts : FileSystemTree
    {
        public loadScripts(string application) : base(application) { }
        protected override void CreateRootNode(ref XmlTreeNode rootNode)
        {
            rootNode.NodeType = &quot;init&quot; + TreeAlias;
            rootNode.NodeID = &quot;init&quot;;
            rootNode.Text = ui.Text(&quot;treeHeaders&quot;, &quot;scripts&quot;);
        }

        public override void RenderJS(ref StringBuilder Javascript)
        {
            Javascript.Append(
                @&quot;
			function openScriptEditor(id) {
			    UmbClientMgr.contentFrame(&#39;settings/scripts/editScript.aspx?file=&#39; + id);
			}
            function openScriptFolder(id) {
			    return false;
			}
		&quot;);
        }

        protected override string FilePath
        {
            get
            {
                return SystemDirectories.Scripts + &quot;/&quot;;
            }
        }

        protected override string FileSearchPattern
        {

            get { return UmbracoSettings.ScriptFileTypes; }
        }

        protected override void OnRenderFolderNode(ref XmlTreeNode xNode)
        {

            xNode.Menu = new List&lt;IAction&gt;(new IAction[]
            {
                ActionNew.Instance, 
                ContextMenuSeperator.Instance, 
                ActionDelete.Instance, 
                ContextMenuSeperator.Instance, 
                ActionRefresh.Instance
            });
            xNode.Action = &quot;javascript:void(0)&quot;;
            xNode.NodeType = &quot;scriptsFolder&quot;;
            xNode.Action = &quot;javascript:void(0);&quot;;
        }

        protected override void OnRenderFileNode(ref XmlTreeNode xNode)
        {
            xNode.Action = xNode.Action.Replace(&quot;openFile&quot;, &quot;openScriptEditor&quot;);

            // add special icons for javascript files
            if (xNode.Text.Contains(&quot;.js&quot;))
            {
                xNode.Icon = &quot;icon-script&quot;;
                xNode.OpenIcon = &quot;icon-script&quot;;
            }
            else
            {
                xNode.Icon = &quot;icon-code&quot;;
                xNode.OpenIcon = &quot;icon-code&quot;;
            }

            xNode.Text = xNode.Text.StripFileExtension();
        }


    }

}

    </pre>
    <script type="text/javascript">
      highlightRanges([[38,50,38,67,0],[38,68,38,69,0],[38,70,38,71,0],[40,9,40,10,0],[41,13,41,52,0],[42,13,42,38,0],[43,13,43,63,0],[44,9,44,10,0],[47,9,47,10,0],[48,13,56,6,0],[57,9,57,10,0],[62,13,62,14,0],[63,17,63,56,0],[64,13,64,14,0],[70,17,70,18,0],[70,19,70,58,0],[70,59,70,60,0],[74,9,74,10,0],[76,13,83,16,0],[84,13,84,49,0],[85,13,85,46,0],[86,13,86,50,0],[87,9,87,10,0],[90,9,90,10,0],[91,13,91,81,0],[94,13,94,44,0],[95,13,95,14,0],[96,17,96,44,0],[97,17,97,48,0],[98,13,98,14,0],[100,13,100,14,0],[101,17,101,42,0],[102,17,102,46,0],[103,13,103,14,0],[105,13,105,58,0],[106,9,106,10,0]]);
    </script>
  </body>
</html>