<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Configurations\GlobalSettingsTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Web.Mvc;
using System.Web.Routing;
using NUnit.Framework;
using Umbraco.Core.Configuration;
using Umbraco.Core.IO;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Configurations
{
    [TestFixture]
	public class GlobalSettingsTests : BaseWebTest
	{

		public override void Initialize()
		{            
			base.Initialize();
            SettingsForTests.UmbracoPath = &quot;~/umbraco&quot;;
		}

		public override void TearDown()
		{
            //ensure this is reset
		    SystemDirectories.Root = null;
            SettingsForTests.UmbracoPath = &quot;~/umbraco&quot;;
            //reset the app config		            
			base.TearDown();
			
		}

        [Test]
        public void Is_Debug_Mode()
        {
            Assert.That(Umbraco.Core.Configuration.GlobalSettings.DebugMode, Is.EqualTo(true));
        }

        [Ignore]
        [Test]
        public void Is_Version_From_Assembly_Correct()
        {
            Assert.That(UmbracoVersion.GetSemanticVersion(), Is.EqualTo(&quot;6.0.0&quot;));
        }

        [TestCase(&quot;~/umbraco&quot;, &quot;/&quot;, &quot;umbraco&quot;)]
        [TestCase(&quot;~/umbraco&quot;, &quot;/MyVirtualDir&quot;, &quot;umbraco&quot;)]
        [TestCase(&quot;~/customPath&quot;, &quot;/MyVirtualDir/&quot;, &quot;custompath&quot;)]
        [TestCase(&quot;~/some-wacky/nestedPath&quot;, &quot;/MyVirtualDir&quot;, &quot;some-wacky-nestedpath&quot;)]
        [TestCase(&quot;~/some-wacky/nestedPath&quot;, &quot;/MyVirtualDir/NestedVDir/&quot;, &quot;some-wacky-nestedpath&quot;)]
	    public void Umbraco_Mvc_Area(string path, string rootPath, string outcome)
        {
            SettingsForTests.UmbracoPath = path;
            SystemDirectories.Root = rootPath;
            Assert.AreEqual(outcome, Umbraco.Core.Configuration.GlobalSettings.UmbracoMvcArea);
        }

	    [TestCase(&quot;/umbraco/umbraco.aspx&quot;)]
		[TestCase(&quot;/umbraco/editContent.aspx&quot;)]
		[TestCase(&quot;/install/default.aspx&quot;)]
		[TestCase(&quot;/install/&quot;)]
		[TestCase(&quot;/install&quot;)]
		[TestCase(&quot;/install/?installStep=asdf&quot;)]
		[TestCase(&quot;/install/test.aspx&quot;)]
		[TestCase(&quot;/config/splashes/booting.aspx&quot;)]
		public void Is_Reserved_Path_Or_Url(string url)
		{
			Assert.IsTrue(Umbraco.Core.Configuration.GlobalSettings.IsReservedPathOrUrl(url));
		}

		[TestCase(&quot;/umbraco_client/Tree/treeIcons.css&quot;)]
		[TestCase(&quot;/umbraco_client/Tree/Themes/umbraco/style.css&quot;)]
		[TestCase(&quot;/umbraco_client/scrollingmenu/style.css&quot;)]		
		[TestCase(&quot;/base/somebasehandler&quot;)]
		[TestCase(&quot;/&quot;)]
		[TestCase(&quot;/home.aspx&quot;)]
		[TestCase(&quot;/umbraco-test&quot;)]
		[TestCase(&quot;/install-test&quot;)]
		[TestCase(&quot;/install.aspx&quot;)]
		public void Is_Not_Reserved_Path_Or_Url(string url)
		{
			Assert.IsFalse(Umbraco.Core.Configuration.GlobalSettings.IsReservedPathOrUrl(url));
		}


		[TestCase(&quot;/Do/Not/match&quot;, false)]
		[TestCase(&quot;/Umbraco/RenderMvcs&quot;, false)]
		[TestCase(&quot;/Umbraco/RenderMvc&quot;, true)]
		[TestCase(&quot;/Umbraco/RenderMvc/Index&quot;, true)]
		[TestCase(&quot;/Umbraco/RenderMvc/Index/1234&quot;, true)]
		[TestCase(&quot;/Umbraco/RenderMvc/Index/1234/9876&quot;, false)]
		[TestCase(&quot;/api&quot;, true)]
		[TestCase(&quot;/api/WebApiTest&quot;, true)]
		[TestCase(&quot;/api/WebApiTest/1234&quot;, true)]
		[TestCase(&quot;/api/WebApiTest/Index/1234&quot;, false)]		
		public void Is_Reserved_By_Route(string url, bool shouldMatch)
		{
			//reset the app config, we only want to test routes not the hard coded paths
		    Umbraco.Core.Configuration.GlobalSettings.ReservedPaths = &quot;&quot;;
		    Umbraco.Core.Configuration.GlobalSettings.ReservedUrls = &quot;&quot;;

			var routes = new RouteCollection();

			routes.MapRoute(
				&quot;Umbraco_default&quot;,
				&quot;Umbraco/RenderMvc/{action}/{id}&quot;,
				new { controller = &quot;RenderMvc&quot;, action = &quot;Index&quot;, id = UrlParameter.Optional });
			routes.MapRoute(
				&quot;WebAPI&quot;,
				&quot;api/{controller}/{id}&quot;,
				new { controller = &quot;WebApiTestController&quot;, action = &quot;Index&quot;, id = UrlParameter.Optional });


			var context = new FakeHttpContextFactory(url);
		

			Assert.AreEqual(
				shouldMatch,
				Umbraco.Core.Configuration.GlobalSettings.IsReservedPathOrUrl(url, context.HttpContext, routes));
		}
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[15,3,15,4,1],[16,4,16,22,1],[17,13,17,56,1],[18,3,18,4,1],[21,3,21,4,1],[23,7,23,37,1],[24,13,24,56,1],[26,4,26,20,1],[28,3,28,4,1],[32,9,32,10,1],[33,13,33,96,1],[34,9,34,10,1],[39,9,39,10,0],[40,13,40,83,0],[41,9,41,10,0],[49,9,49,10,1],[50,13,50,49,1],[51,13,51,47,1],[52,13,52,96,1],[53,9,53,10,1],[64,3,64,4,1],[65,4,65,86,1],[66,3,66,4,1],[78,3,78,4,1],[79,4,79,87,1],[80,3,80,4,1],[94,3,94,4,1],[96,7,96,68,1],[97,7,97,67,1],[99,4,99,39,1],[101,4,104,85,1],[105,4,108,96,1],[111,4,111,50,1],[114,4,116,102,1],[117,3,117,4,1]]);
    </script>
  </body>
</html>