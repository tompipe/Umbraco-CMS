<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Routing\ContentFinderByIdPath.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using Umbraco.Core.Logging;
using Umbraco.Core.Models;
using Umbraco.Core;
using Umbraco.Core.Configuration;
using Umbraco.Core.Configuration.UmbracoSettings;

namespace Umbraco.Web.Routing
{
	/// &lt;summary&gt;
	/// Provides an implementation of &lt;see cref=&quot;IContentFinder&quot;/&gt; that handles page identifiers.
	/// &lt;/summary&gt;
	/// &lt;remarks&gt;
	/// &lt;para&gt;Handles &lt;c&gt;/1234&lt;/c&gt; where &lt;c&gt;1234&lt;/c&gt; is the identified of a document.&lt;/para&gt;
	/// &lt;/remarks&gt;
	public class ContentFinderByIdPath : IContentFinder
    {
	    private readonly IWebRoutingSection _webRoutingSection;

	    public ContentFinderByIdPath()
            : this(UmbracoConfig.For.UmbracoSettings().WebRouting)
	    {
	        
	    }

	    public ContentFinderByIdPath(IWebRoutingSection webRoutingSection)
	    {
	        _webRoutingSection = webRoutingSection;
	    }

	    /// &lt;summary&gt;
		/// Tries to find and assign an Umbraco document to a &lt;c&gt;PublishedContentRequest&lt;/c&gt;.
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;docRequest&quot;&gt;The &lt;c&gt;PublishedContentRequest&lt;/c&gt;.&lt;/param&gt;		
		/// &lt;returns&gt;A value indicating whether an Umbraco document was found and assigned.&lt;/returns&gt;
		public bool TryFindContent(PublishedContentRequest docRequest)
        {

            if (docRequest.RoutingContext.UmbracoContext != null &amp;&amp; docRequest.RoutingContext.UmbracoContext.InPreviewMode == false
                &amp;&amp; _webRoutingSection.DisableFindContentByIdPath)
                return false;

            IPublishedContent node = null;
			var path = docRequest.Uri.GetAbsolutePathDecoded();

            var nodeId = -1;
			if (path != &quot;/&quot;) // no id if &quot;/&quot;
            {
				var noSlashPath = path.Substring(1);

                if (!Int32.TryParse(noSlashPath, out nodeId))
                    nodeId = -1;

                if (nodeId &gt; 0)
                {
					LogHelper.Debug&lt;ContentFinderByIdPath&gt;(&quot;Id={0}&quot;, () =&gt; nodeId);
                    node = docRequest.RoutingContext.UmbracoContext.ContentCache.GetById(nodeId);

                    if (node != null)
                    {
						docRequest.PublishedContent = node;
						LogHelper.Debug&lt;ContentFinderByIdPath&gt;(&quot;Found node with id={0}&quot;, () =&gt; docRequest.PublishedContent.Id);
                    }
                    else
                    {
                        nodeId = -1; // trigger message below
                    }
                }
            }

            if (nodeId == -1)
				LogHelper.Debug&lt;ContentFinderByIdPath&gt;(&quot;Not a node id&quot;);

            return node != null;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[21,15,21,67,1],[22,6,22,7,1],[24,6,24,7,1],[26,6,26,72,1],[27,6,27,7,1],[28,10,28,49,1],[29,6,29,7,1],[37,9,37,10,1],[39,13,40,66,1],[41,17,41,30,0],[43,13,43,43,1],[44,4,44,55,1],[46,13,46,29,1],[47,4,47,20,1],[48,13,48,14,1],[49,5,49,41,1],[51,17,51,62,1],[52,21,52,33,0],[54,17,54,32,1],[55,17,55,18,1],[56,6,56,61,1],[56,61,56,67,0],[56,67,56,69,1],[56,6,56,69,1],[57,21,57,98,1],[59,21,59,38,1],[60,21,60,22,1],[61,7,61,42,1],[62,7,62,78,1],[62,78,62,108,0],[62,108,62,110,1],[62,7,62,110,1],[63,21,63,22,1],[65,21,65,22,0],[66,25,66,37,0],[67,21,67,22,0],[68,17,68,18,1],[69,13,69,14,1],[71,13,71,30,1],[72,5,72,61,0],[74,13,74,33,1],[75,9,75,10,1]]);
    </script>
  </body>
</html>