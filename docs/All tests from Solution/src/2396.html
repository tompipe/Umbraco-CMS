<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.cms\businesslogic\language\Item.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Concurrent;
using System.ComponentModel;
using System.Data;
using System.Linq;

using Umbraco.Core;
using Umbraco.Core.Models;
using Umbraco.Core.Persistence;
using Umbraco.Core.Persistence.SqlSyntax;
using umbraco.DataLayer;
using umbraco.BusinessLogic;
using System.Collections.Generic;
using Umbraco.Core.Models.Rdbms;

namespace umbraco.cms.businesslogic.language
{
    [EditorBrowsable(EditorBrowsableState.Never)]
    [Obsolete(&quot;This class is no longer used, nor should it ever be used, it will be removed from the codebase in future versions&quot;)]
    public class Item
    {
        /// &lt;summary&gt;
        /// Unused, please do not use
        /// &lt;/summary&gt;
        [Obsolete(&quot;Obsolete, For querying the database use the new UmbracoDatabase object ApplicationContext.Current.DatabaseContext.Database&quot;, false)]
        protected static ISqlHelper SqlHelper
        {
            get { return Application.SqlHelper; }
        }

        /// &lt;summary&gt;
        /// Retrieves the value of a languagetranslated item given the key
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;key&quot;&gt;Unique identifier&lt;/param&gt;
        /// &lt;param name=&quot;languageId&quot;&gt;Umbraco languageid&lt;/param&gt;
        /// &lt;returns&gt;The language translated text&lt;/returns&gt;
        public static string Text(Guid key, int languageId)
        {

            var item = ApplicationContext.Current.Services.LocalizationService.GetDictionaryItemById(key);
            if (item != null)
            {
                var translation = item.Translations.FirstOrDefault(x =&gt; x.Language.Id == languageId);
                if (translation != null)
                {
                    return translation.Value;
                }
            }

            throw new ArgumentException(&quot;Key being requested does not exist&quot;);
        }

        /// &lt;summary&gt;
        /// returns True if there is a value associated to the unique identifier with the specified language
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;key&quot;&gt;Unique identifier&lt;/param&gt;
        /// &lt;param name=&quot;languageId&quot;&gt;Umbraco language id&lt;/param&gt;
        /// &lt;returns&gt;returns True if there is a value associated to the unique identifier with the specified language&lt;/returns&gt;
        public static bool hasText(Guid key, int languageId)
        {
            try
            {
                return Text(key, languageId).IsNullOrWhiteSpace() == false;
            }
            catch (ArgumentException)
            {
                return false;
            }
        }
        
        /// &lt;summary&gt;
        /// Updates the value of the language translated item, throws an exeption if the
        /// key does not exist
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;languageId&quot;&gt;Umbraco language id&lt;/param&gt;
        /// &lt;param name=&quot;key&quot;&gt;Unique identifier&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;The new dictionaryvalue&lt;/param&gt;

        public static void setText(int languageId, Guid key, string value)
        {
            var lang = ApplicationContext.Current.Services.LocalizationService.GetLanguageById(languageId);
            if (lang == null) return;

            var item = ApplicationContext.Current.Services.LocalizationService.GetDictionaryItemById(key);
            if (item != null)
            {
                var translation = item.Translations.FirstOrDefault(x =&gt; x.Language.Id == languageId);
                if (translation == null)
                {
                    throw new ArgumentException(&quot;Key does not exist&quot;);
                }
                var newTranslations = new List&lt;IDictionaryTranslation&gt;(item.Translations)
                {
                    new DictionaryTranslation(lang, value)
                };
                item.Translations = newTranslations;
                ApplicationContext.Current.Services.LocalizationService.Save(item);
            }
        }

        /// &lt;summary&gt;
        /// Adds a new languagetranslated item to the collection
        /// 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;languageId&quot;&gt;Umbraco languageid&lt;/param&gt;
        /// &lt;param name=&quot;key&quot;&gt;Unique identifier&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        public static void addText(int languageId, Guid key, string value)
        {
            var lang = ApplicationContext.Current.Services.LocalizationService.GetLanguageById(languageId);
            if (lang == null) return;

            var item = ApplicationContext.Current.Services.LocalizationService.GetDictionaryItemById(key);
            if (item != null)
            {
                var translation = item.Translations.FirstOrDefault(x =&gt; x.Language.Id == languageId);
                if (translation != null)
                {
                    throw new ArgumentException(&quot;Key being add&#39;ed already exists&quot;);
                }
                var newTranslations = new List&lt;IDictionaryTranslation&gt;(item.Translations)
                {
                    new DictionaryTranslation(lang, value)
                };
                item.Translations = newTranslations;
                ApplicationContext.Current.Services.LocalizationService.Save(item);
            }
        }
        
        /// &lt;summary&gt;
        /// Removes all languagetranslated texts associated to the unique identifier.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;key&quot;&gt;Unique identifier&lt;/param&gt;
        public static void removeText(Guid key)
        {
            var found = ApplicationContext.Current.Services.LocalizationService.GetDictionaryItemById(key);
            if (found != null)
            {
                ApplicationContext.Current.Services.LocalizationService.Delete(found);    
            }
        }

        /// &lt;summary&gt;
        /// Removes all entries by language id.
        /// Primary used when deleting a language from Umbraco.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;languageId&quot;&gt;&lt;/param&gt;
        [Obsolete(&quot;This is no longer used and will be removed from the codebase in future versions&quot;)]
        public static void RemoveByLanguage(int languageId)
        {
            var lang = ApplicationContext.Current.Services.LocalizationService.GetLanguageById(languageId);
            if (lang != null)
            {
                ApplicationContext.Current.Services.LocalizationService.Delete(lang);    
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[29,17,29,18,0],[29,19,29,48,0],[29,49,29,50,0],[39,9,39,10,0],[41,13,41,107,0],[42,13,42,30,0],[43,13,43,14,0],[44,17,44,73,0],[44,73,44,100,0],[44,100,44,102,0],[44,17,44,102,0],[45,17,45,41,0],[46,17,46,18,0],[47,21,47,46,0],[49,13,49,14,0],[51,13,51,79,0],[52,9,52,10,0],[61,9,61,10,0],[63,13,63,14,0],[64,17,64,76,0],[66,13,66,38,0],[67,13,67,14,0],[68,17,68,30,0],[70,9,70,10,0],[81,9,81,10,0],[82,13,82,108,0],[83,13,83,30,0],[83,31,83,38,0],[85,13,85,107,0],[86,13,86,30,0],[87,13,87,14,0],[88,17,88,73,0],[88,73,88,100,0],[88,100,88,102,0],[88,17,88,102,0],[89,17,89,41,0],[90,17,90,18,0],[91,21,91,71,0],[93,17,96,19,0],[97,17,97,53,0],[98,17,98,84,0],[99,13,99,14,0],[100,9,100,10,0],[110,9,110,10,0],[111,13,111,108,0],[112,13,112,30,0],[112,31,112,38,0],[114,13,114,107,0],[115,13,115,30,0],[116,13,116,14,0],[117,17,117,73,0],[117,73,117,100,0],[117,100,117,102,0],[117,17,117,102,0],[118,17,118,41,0],[119,17,119,18,0],[120,21,120,84,0],[122,17,125,19,0],[126,17,126,53,0],[127,17,127,84,0],[128,13,128,14,0],[129,9,129,10,0],[136,9,136,10,0],[137,13,137,108,0],[138,13,138,31,0],[139,13,139,14,0],[140,17,140,87,0],[141,13,141,14,0],[142,9,142,10,0],[151,9,151,10,0],[152,13,152,108,0],[153,13,153,30,0],[154,13,154,14,0],[155,17,155,86,0],[156,13,156,14,0],[157,9,157,10,0]]);
    </script>
  </body>
</html>