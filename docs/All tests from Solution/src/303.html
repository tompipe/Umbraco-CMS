<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Routing\ContentFinderByAliasWithDomainsTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using NUnit.Framework;
using Umbraco.Web.Routing;

namespace Umbraco.Tests.Routing
{
    
    [TestFixture]
    public class ContentFinderByAliasWithDomainsTests : ContentFinderByAliasTests
    {

        

        [TestCase(&quot;http://domain1.com/this/is/my/alias&quot;, &quot;de-DE&quot;, -1001)] // alias to domain&#39;s page fails - no alias on domain&#39;s home
        [TestCase(&quot;http://domain1.com/page2/alias&quot;, &quot;de-DE&quot;, 10011)] // alias to sub-page works
        [TestCase(&quot;http://domain1.com/en/flux&quot;, &quot;en-US&quot;, -10011)] // alias to domain&#39;s page fails - no alias on domain&#39;s home
        [TestCase(&quot;http://domain1.com/endanger&quot;, &quot;de-DE&quot;, 10011)] // alias to sub-page works, even with &quot;en...&quot;
        [TestCase(&quot;http://domain1.com/en/endanger&quot;, &quot;en-US&quot;, -10011)] // no
        [TestCase(&quot;http://domain1.com/only/one/alias&quot;, &quot;de-DE&quot;, 100111)] // ok
        [TestCase(&quot;http://domain1.com/entropy&quot;, &quot;de-DE&quot;, 100111)] // ok
        [TestCase(&quot;http://domain1.com/bar/foo&quot;, &quot;de-DE&quot;, 100111)] // ok
        [TestCase(&quot;http://domain1.com/en/bar/foo&quot;, &quot;en-US&quot;, -100111)] // no, alias must include &quot;en/&quot;
        [TestCase(&quot;http://domain1.com/en/bar/nil&quot;, &quot;en-US&quot;, 100111)] // ok, alias includes &quot;en/&quot;
        public void Lookup_By_Url_Alias_And_Domain(string inputUrl, string expectedCulture, int expectedNode)
        {
            //SetDomains1();

            var routingContext = GetRoutingContext(inputUrl);
            var url = routingContext.UmbracoContext.CleanedUmbracoUrl; //very important to use the cleaned up umbraco url
            var pcr = new PublishedContentRequest(url, routingContext);
            // must lookup domain
            pcr.Engine.FindDomain();

            if (expectedNode &gt; 0)
                Assert.AreEqual(expectedCulture, pcr.Culture.Name);

            var finder = new ContentFinderByUrlAlias();
            var result = finder.TryFindContent(pcr);

            if (expectedNode &gt; 0)
            {
                Assert.IsTrue(result);
                Assert.AreEqual(pcr.PublishedContent.Id, expectedNode);
            }
            else
            {
                Assert.IsFalse(result);
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[24,9,24,10,1],[27,13,27,62,1],[28,13,28,71,1],[29,13,29,72,1],[31,13,31,37,1],[33,13,33,34,1],[34,17,34,68,1],[36,13,36,56,1],[37,13,37,53,1],[39,13,39,34,1],[40,13,40,14,1],[41,17,41,39,1],[42,17,42,72,1],[43,13,43,14,1],[45,13,45,14,1],[46,17,46,40,1],[47,13,47,14,1],[48,9,48,10,1]]);
    </script>
  </body>
</html>