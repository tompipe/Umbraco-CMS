<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\dialogs\umbracoField.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Web;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using Umbraco.Core.Configuration;
using Umbraco.Core;
using Umbraco.Core.Persistence.SqlSyntax;
using umbraco.DataLayer;

namespace umbraco.dialogs
{
	/// &lt;summary&gt;
	/// Summary description for umbracoField.
	/// &lt;/summary&gt;
	public partial class umbracoField : BasePages.UmbracoEnsuredPage
	{
		string[] preValuesSource = { &quot;@createDate&quot;, &quot;@creatorName&quot;, &quot;@level&quot;, &quot;@nodeType&quot;, &quot;@nodeTypeAlias&quot;, &quot;@pageID&quot;, &quot;@pageName&quot;, &quot;@parentID&quot;, &quot;@path&quot;, &quot;@template&quot;, &quot;@updateDate&quot;, &quot;@writerID&quot;, &quot;@writerName&quot; };
		bool m_IsDictionaryMode = false;

		public umbracoField()
		{
			CurrentApp = BusinessLogic.DefaultApps.settings.ToString();
		}

		protected void Page_Load(object sender, System.EventArgs e)
		{

			//set labels on properties...
			pp_insertAltField.Text = ui.Text(&quot;templateEditor&quot;, &quot;alternativeField&quot;);
			pp_insertAltText.Text = ui.Text(&quot;templateEditor&quot;, &quot;alternativeText&quot;);
			pp_insertBefore.Text = ui.Text(&quot;templateEditor&quot;, &quot;preContent&quot;);
			pp_insertAfter.Text = ui.Text(&quot;templateEditor&quot;, &quot;postContent&quot;);

			pp_FormatAsDate.Text = ui.Text(&quot;templateEditor&quot;, &quot;formatAsDate&quot;);
			pp_casing.Text = ui.Text(&quot;templateEditor&quot;, &quot;casing&quot;);
			pp_encode.Text = ui.Text(&quot;templateEditor&quot;, &quot;encoding&quot;);
			


			if (UmbracoConfig.For.UmbracoSettings().Templates.UseAspNetMasterPages)
			{
				tagName.Value = &quot;umbraco:Item&quot;;
			}

			// either get page fields or dictionary items
			string fieldSql = &quot;&quot;;
			if (helper.Request(&quot;tagName&quot;) == &quot;UMBRACOGETDICTIONARY&quot;)
			{
				fieldSql = &quot;select &#39;#&#39;+[key] as alias from cmsDictionary order by alias&quot;;
				m_IsDictionaryMode = true;
				pp_insertField.Text = &quot;Insert Dictionary Item&quot;;
			}
			else
			{
                //exclude built-in memberhip properties from showing up here
			    var exclude = Constants.Conventions.Member.GetStandardPropertyTypeStubs()
                    .Select(x =&gt; SqlSyntaxContext.SqlSyntaxProvider.GetQuotedValue(x.Key)).ToArray();

				fieldSql = string.Format(
                    &quot;select distinct alias from cmsPropertyType where alias not in ({0}) order by alias&quot;,
                    string.Join(&quot;,&quot;, exclude));
				pp_insertField.Text = ui.Text(&quot;templateEditor&quot;, &quot;chooseField&quot;);
			}

			fieldPicker.ChooseText = ui.Text(&quot;templateEditor&quot;, &quot;chooseField&quot;);
			fieldPicker.StandardPropertiesLabel = ui.Text(&quot;templateEditor&quot;, &quot;standardFields&quot;);
			fieldPicker.CustomPropertiesLabel = ui.Text(&quot;templateEditor&quot;, &quot;customFields&quot;);

            using (var sqlHelper = BusinessLogic.Application.SqlHelper)
            using (IRecordsReader dataTypes = sqlHelper.ExecuteReader(fieldSql))
		    {
		        fieldPicker.DataTextField = &quot;alias&quot;;
		        fieldPicker.DataValueField = &quot;alias&quot;;
		        fieldPicker.DataSource = dataTypes;
		        fieldPicker.DataBind();
                fieldPicker.Attributes.Add(&quot;onChange&quot;, &quot;document.forms[0].field.value = document.forms[0].&quot; + fieldPicker.ClientID + &quot;[document.forms[0].&quot; + fieldPicker.ClientID + &quot;.selectedIndex].value;&quot;);
            }
		    altFieldPicker.ChooseText = ui.Text(&quot;templateEditor&quot;, &quot;chooseField&quot;);
			altFieldPicker.StandardPropertiesLabel = ui.Text(&quot;templateEditor&quot;, &quot;standardFields&quot;);
			altFieldPicker.CustomPropertiesLabel = ui.Text(&quot;templateEditor&quot;, &quot;customFields&quot;);

            using (var sqlHelper = BusinessLogic.Application.SqlHelper)
            using (IRecordsReader dataTypes2 = sqlHelper.ExecuteReader(fieldSql))
		    {
		        altFieldPicker.DataTextField = &quot;alias&quot;;
		        altFieldPicker.DataValueField = &quot;alias&quot;;
		        altFieldPicker.DataSource = dataTypes2;
		        altFieldPicker.DataBind();
                altFieldPicker.Attributes.Add(&quot;onChange&quot;, &quot;document.forms[0].useIfEmpty.value = document.forms[0].&quot; + altFieldPicker.ClientID + &quot;[document.forms[0].&quot; + altFieldPicker.ClientID + &quot;.selectedIndex].value;&quot;);
            }

		    // Pre values
			if (!m_IsDictionaryMode)
			{
				foreach (string s in preValuesSource)
				{
					fieldPicker.Items.Add(new ListItem(s, s.Replace(&quot;@&quot;, &quot;&quot;)));
					altFieldPicker.Items.Add(new ListItem(s, s.Replace(&quot;@&quot;, &quot;&quot;)));
				}
			}

		}


		/// &lt;summary&gt;
		/// JsInclude1 control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::ClientDependency.Core.Controls.JsInclude JsInclude1;

		/// &lt;summary&gt;
		/// JsInclude2 control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::ClientDependency.Core.Controls.JsInclude JsInclude2;

		/// &lt;summary&gt;
		/// tagName control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::System.Web.UI.HtmlControls.HtmlInputHidden tagName;

		/// &lt;summary&gt;
		/// pane_form control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.Pane pane_form;

		/// &lt;summary&gt;
		/// pp_insertField control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_insertField;

		/// &lt;summary&gt;
		/// fieldPicker control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.FieldDropDownList fieldPicker;

		/// &lt;summary&gt;
		/// pp_insertAltField control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_insertAltField;

		/// &lt;summary&gt;
		/// altFieldPicker control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.FieldDropDownList altFieldPicker;

		/// &lt;summary&gt;
		/// pp_insertAltText control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_insertAltText;

		/// &lt;summary&gt;
		/// pp_recursive control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_recursive;

		/// &lt;summary&gt;
		/// pp_insertBefore control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_insertBefore;

		/// &lt;summary&gt;
		/// pp_insertAfter control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_insertAfter;

		/// &lt;summary&gt;
		/// pp_FormatAsDate control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_FormatAsDate;

		/// &lt;summary&gt;
		/// pp_casing control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_casing;

		/// &lt;summary&gt;
		/// pp_encode control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_encode;

		/// &lt;summary&gt;
		/// pp_convertLineBreaks control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_convertLineBreaks;

		/// &lt;summary&gt;
		/// pp_removePTags control.
		/// &lt;/summary&gt;
		/// &lt;remarks&gt;
		/// Auto-generated field.
		/// To modify move field declaration from designer file to code-behind file.
		/// &lt;/remarks&gt;
		protected global::umbraco.uicontrols.PropertyPanel pp_removePTags;
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[24,3,24,207,0],[25,3,25,35,0],[27,3,27,24,0],[28,3,28,4,0],[29,4,29,63,0],[30,3,30,4,0],[33,3,33,4,0],[36,4,36,75,0],[37,4,37,73,0],[38,4,38,67,0],[39,4,39,67,0],[41,4,41,69,0],[42,4,42,57,0],[43,4,43,59,0],[47,4,47,75,0],[48,4,48,5,0],[49,5,49,36,0],[50,4,50,5,0],[53,4,53,25,0],[54,4,54,60,0],[55,4,55,5,0],[56,5,56,78,0],[57,5,57,31,0],[58,5,58,52,0],[59,4,59,5,0],[61,4,61,5,0],[63,8,64,34,0],[64,34,64,90,0],[64,90,64,102,0],[63,8,64,102,0],[66,5,68,48,0],[69,5,69,68,0],[70,4,70,5,0],[72,4,72,70,0],[73,4,73,86,0],[74,4,74,82,0],[76,20,76,71,0],[77,20,77,80,0],[78,7,78,8,0],[79,11,79,47,0],[80,11,80,48,0],[81,11,81,46,0],[82,11,82,34,0],[83,17,83,207,0],[84,13,84,14,0],[85,7,85,76,0],[86,4,86,89,0],[87,4,87,85,0],[89,20,89,71,0],[90,20,90,81,0],[91,7,91,8,0],[92,11,92,50,0],[93,11,93,51,0],[94,11,94,50,0],[95,11,95,37,0],[96,17,96,221,0],[97,13,97,14,0],[100,4,100,28,0],[101,4,101,5,0],[102,5,102,12,0],[102,14,102,22,0],[102,23,102,25,0],[102,26,102,41,0],[103,5,103,6,0],[104,6,104,65,0],[105,6,105,68,0],[106,5,106,6,0],[107,4,107,5,0],[109,3,109,4,0]]);
    </script>
  </body>
</html>