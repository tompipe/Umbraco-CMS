<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\PropertyEditors\LegacyParameterEditorAliasConverter.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Data;
using System.Linq;

namespace Umbraco.Core.PropertyEditors
{
    /// &lt;summary&gt;
    /// Used to map the legacy parameter editor aliases to the new ones, this is really just used during 
    /// installation but has been put in a separate class in case we need it for other purposes
    /// &lt;/summary&gt;
    public static class LegacyParameterEditorAliasConverter
    {
        /// &lt;summary&gt;
        /// The map consists of a key which is always the legacy alias + new alias (trimmed))
        /// &lt;/summary&gt;
        private static ConcurrentDictionary&lt;string, Tuple&lt;string, string&gt;&gt; _map = new ConcurrentDictionary&lt;string, Tuple&lt;string, string&gt;&gt;();

        /// &lt;summary&gt;
        /// Creates a map for the specified legacy alias and property editor alias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;legacyAlias&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;alias&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;true if the map was created or false if it was already created&lt;/returns&gt;
        public static bool CreateMap(string legacyAlias, string alias)
        {
            var key = legacyAlias.ToLowerInvariant() + alias.Trim();
            return _map.TryAdd(key, new Tuple&lt;string, string&gt;(legacyAlias, alias));
        }

        /// &lt;summary&gt;
        /// Gets an alias based on the legacy alias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;legacyAlias&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;throwIfNotFound&quot;&gt;if set to true will throw an exception if the map isn&#39;t found&lt;/param&gt;
        /// &lt;returns&gt;Returns the alias if found otherwise null if not found&lt;/returns&gt;
        public static string GetNewAliasFromLegacyAlias(string legacyAlias, bool throwIfNotFound = false)
        {
            var found = _map.FirstOrDefault(x =&gt; x.Value.Item1 == legacyAlias);
            if (found.Equals(default(KeyValuePair&lt;string, Tuple&lt;string, string&gt;&gt;)))
            {
                if (throwIfNotFound)
                {
                    throw new ObjectNotFoundException(&quot;Could not find a map for a property editor with a legacy alias of &quot; + legacyAlias);
                }
                return null;
            }
            return found.Value.Item2;
        }

        /// &lt;summary&gt;
        /// Gets a legacy Id based on the alias
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;alias&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;throwIfNotFound&quot;&gt;if set to true will throw an exception if the map isn&#39;t found&lt;/param&gt;
        /// &lt;returns&gt;Returns the legacy GUID of a property editor if found, otherwise returns null&lt;/returns&gt;
        public static string GetLegacyAliasFromNewAlias(string alias, bool throwIfNotFound = false)
        {
            var found = _map.FirstOrDefault(x =&gt; x.Value.Item2 == alias);
            if (found.Equals(default(KeyValuePair&lt;string, Tuple&lt;string, string&gt;&gt;)))
            {
                if (throwIfNotFound)
                {
                    throw new ObjectNotFoundException(&quot;Could not find a map for a property editor with an alias of &quot; + alias);
                }
                return null;
            }
            return found.Value.Item1;
        }

        internal static int Count()
        {
            return _map.Count;
        }

        internal static void Reset()
        {
            _map = new ConcurrentDictionary&lt;string, Tuple&lt;string, string&gt;&gt;();
        }

        /// &lt;summary&gt;
        /// A method that should be called on startup to register the mappings for the internal core editors
        /// &lt;/summary&gt;
        internal static void CreateMappingsForCoreEditors()
        {
            //All of these map to the content picker
            CreateMap(&quot;contentSubs&quot;, Constants.PropertyEditors.ContentPickerAlias);
            CreateMap(&quot;contentRandom&quot;, Constants.PropertyEditors.ContentPickerAlias);
            CreateMap(&quot;contentPicker&quot;, Constants.PropertyEditors.ContentPickerAlias);
            CreateMap(&quot;contentTree&quot;, Constants.PropertyEditors.ContentPickerAlias);
            CreateMap(&quot;contentAll&quot;, Constants.PropertyEditors.ContentPickerAlias);

            CreateMap(&quot;textMultiLine&quot;, Constants.PropertyEditors.TextboxMultipleAlias);
            CreateMap(&quot;text&quot;, Constants.PropertyEditors.TextboxAlias);
            CreateMap(&quot;bool&quot;, Constants.PropertyEditors.TrueFalseAlias);

            CreateMap(&quot;mediaCurrent&quot;, Constants.PropertyEditors.MediaPickerAlias);

            CreateMap(&quot;number&quot;, Constants.PropertyEditors.IntegerAlias);   
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,141,1],[27,9,27,10,1],[28,13,28,69,1],[29,13,29,84,1],[30,9,30,10,1],[39,9,39,10,1],[40,13,40,50,1],[40,50,40,78,1],[40,78,40,80,1],[40,13,40,80,1],[41,13,41,84,1],[42,13,42,14,1],[43,17,43,37,1],[44,17,44,18,0],[45,21,45,139,0],[47,17,47,29,1],[49,13,49,38,1],[50,9,50,10,1],[59,9,59,10,0],[60,13,60,50,0],[60,50,60,72,0],[60,72,60,74,0],[60,13,60,74,0],[61,13,61,84,0],[62,13,62,14,0],[63,17,63,37,0],[64,17,64,18,0],[65,21,65,127,0],[67,17,67,29,0],[69,13,69,38,0],[70,9,70,10,0],[73,9,73,10,0],[74,13,74,31,0],[75,9,75,10,0],[78,9,78,10,0],[79,13,79,78,0],[80,9,80,10,0],[86,9,86,10,1],[88,13,88,84,1],[89,13,89,86,1],[90,13,90,86,1],[91,13,91,84,1],[92,13,92,83,1],[94,13,94,88,1],[95,13,95,71,1],[96,13,96,73,1],[98,13,98,83,1],[100,13,100,73,1],[101,9,101,10,1]]);
    </script>
  </body>
</html>