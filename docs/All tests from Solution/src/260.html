<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Web\AngularIntegration\ContentModelSerializationTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Linq;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Web.Models.ContentEditing;

namespace Umbraco.Tests.Web.AngularIntegration
{
    [TestFixture]
    public class ContentModelSerializationTests
    {
        [Test]
        public void Content_Display_To_Json()
        {
            //create 3 tabs with 3 properties each
            var tabs = new List&lt;Tab&lt;ContentPropertyDisplay&gt;&gt;();
            for (var tabIndex = 0; tabIndex &lt; 3; tabIndex ++)
            {
                var props = new List&lt;ContentPropertyDisplay&gt;();
                for (var propertyIndex = 0; propertyIndex &lt; 3; propertyIndex ++)
                {
                    props.Add(new ContentPropertyDisplay
                        {
                            Alias = &quot;property&quot; + propertyIndex,
                            Label = &quot;Property &quot; + propertyIndex,
                            Id = propertyIndex,
                            Value = &quot;value&quot; + propertyIndex,
                            Config = new Dictionary&lt;string, object&gt; {{ propertyIndex.ToInvariantString(), &quot;value&quot; }},
                            Description = &quot;Description &quot; + propertyIndex,
                            View = &quot;~/Views/View&quot; + propertyIndex,
                            HideLabel = false
                        });                    
                }
                tabs.Add(new Tab&lt;ContentPropertyDisplay&gt;()
                    {
                        Alias = &quot;Tab&quot; + tabIndex,
                        Label = &quot;Tab&quot; + tabIndex,
                        Properties = props
                    });
            }

            var displayModel = new ContentItemDisplay
                {
                    Id = 1234,
                    Name = &quot;Test&quot;,
                    Tabs = tabs
                };

            var json = JsonConvert.SerializeObject(displayModel);

            var jObject = JObject.Parse(json);

            Assert.AreEqual(&quot;1234&quot;, jObject[&quot;id&quot;].ToString());
            Assert.AreEqual(&quot;Test&quot;, jObject[&quot;name&quot;].ToString());
            Assert.AreEqual(3, jObject[&quot;tabs&quot;].Count());
            for (var tab = 0; tab &lt; jObject[&quot;tabs&quot;].Count(); tab++)
            {
                Assert.AreEqual(&quot;Tab&quot; + tab, jObject[&quot;tabs&quot;][tab][&quot;alias&quot;].ToString());
                Assert.AreEqual(&quot;Tab&quot; + tab, jObject[&quot;tabs&quot;][tab][&quot;label&quot;].ToString());
                Assert.AreEqual(3, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;].Count());
                for (var prop = 0; prop &lt; jObject[&quot;tabs&quot;][tab][&quot;properties&quot;].Count(); prop++)
                {
                    Assert.AreEqual(&quot;property&quot; + prop, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;alias&quot;].ToString());
                    Assert.AreEqual(&quot;Property &quot; + prop, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;label&quot;].ToString());
                    Assert.AreEqual(prop, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;id&quot;].Value&lt;int&gt;());
                    Assert.AreEqual(&quot;value&quot; + prop, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;value&quot;].ToString());
                    Assert.AreEqual(&quot;{\&quot;&quot; + prop + &quot;\&quot;:\&quot;value\&quot;}&quot;, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;config&quot;].ToString(Formatting.None));
                    Assert.AreEqual(&quot;Description &quot; + prop, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;description&quot;].ToString());
                    Assert.AreEqual(false, jObject[&quot;tabs&quot;][tab][&quot;properties&quot;][prop][&quot;hideLabel&quot;].Value&lt;bool&gt;());
                }
            }                
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,1],[18,13,18,64,1],[19,18,19,34,1],[19,36,19,48,1],[19,50,19,61,1],[20,13,20,14,1],[21,17,21,64,1],[22,22,22,43,1],[22,45,22,62,1],[22,64,22,80,1],[23,17,23,18,1],[24,21,34,28,1],[35,17,35,18,1],[36,17,41,24,1],[42,13,42,14,1],[44,13,49,19,1],[51,13,51,66,1],[53,13,53,47,1],[55,13,55,63,1],[56,13,56,65,1],[57,13,57,57,1],[58,18,58,29,1],[58,31,58,60,1],[58,62,58,67,1],[59,13,59,14,1],[60,17,60,88,1],[61,17,61,88,1],[62,17,62,80,1],[63,22,63,34,1],[63,36,63,85,1],[63,87,63,93,1],[64,17,64,18,1],[65,21,65,118,1],[66,21,66,119,1],[67,21,67,104,1],[68,21,68,115,1],[69,21,69,147,1],[70,21,70,128,1],[71,21,71,113,1],[72,17,72,18,1],[73,13,73,14,1],[74,9,74,10,1]]);
    </script>
  </body>
</html>