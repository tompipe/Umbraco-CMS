<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\tinyMCE3\TinyMCE.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.UI;
using Umbraco.Core.Configuration;
using Umbraco.Core.Logging;
using umbraco.BasePages;
using umbraco.BusinessLogic;
using umbraco.cms.businesslogic.web;
using umbraco.editorControls.tinymce;
using umbraco.editorControls.tinyMCE3.webcontrol;
using umbraco.editorControls.wysiwyg;
using umbraco.interfaces;
using Umbraco.Core.IO;
using umbraco.presentation;
using umbraco.uicontrols;

namespace umbraco.editorControls.tinyMCE3
{
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class TinyMCE : TinyMCEWebControl, IDataEditor, IMenuElement
    {
        private readonly string _activateButtons = &quot;&quot;;
        private readonly string _advancedUsers = &quot;&quot;;
        private readonly SortedList _buttons = new SortedList();
        private readonly IData _data;
        private readonly string _disableButtons = &quot;help,visualaid,&quot;;
        private readonly string _editorButtons = &quot;&quot;;
        private readonly bool _enableContextMenu;
        private readonly bool _fullWidth;
        private readonly int _height;
        private readonly SortedList _mceButtons = new SortedList();
        private readonly ArrayList _menuIcons = new ArrayList();
        private readonly bool _showLabel;
        private readonly ArrayList _stylesheets = new ArrayList();
        private readonly int _width;

        private readonly int m_maxImageWidth = 500;
        private bool _isInitialized;
        private string _plugins = &quot;&quot;;

        public TinyMCE(IData Data, string Configuration)
        {
            _data = Data;
            try
            {
                string[] configSettings = Configuration.Split(&quot;|&quot;.ToCharArray());

                if (configSettings.Length &gt; 0)
                {
                    _editorButtons = configSettings[0];

                    if (configSettings.Length &gt; 1)
                        if (configSettings[1] == &quot;1&quot;)
                            _enableContextMenu = true;

                    if (configSettings.Length &gt; 2)
                        _advancedUsers = configSettings[2];

                    if (configSettings.Length &gt; 3)
                    {
                        if (configSettings[3] == &quot;1&quot;)
                            _fullWidth = true;
                        else if (configSettings[4].Split(&#39;,&#39;).Length &gt; 1)
                        {
                            _width = int.Parse(configSettings[4].Split(&#39;,&#39;)[0]);
                            _height = int.Parse(configSettings[4].Split(&#39;,&#39;)[1]);
                        }
                    }

                    // default width/height
                    if (_width &lt; 1)
                        _width = 500;
                    if (_height &lt; 1)
                        _height = 400;

                    // add stylesheets
                    if (configSettings.Length &gt; 4)
                    {
                        foreach (string s in configSettings[5].Split(&quot;,&quot;.ToCharArray()))
                            _stylesheets.Add(s);
                    }

                    if (configSettings.Length &gt; 6 &amp;&amp; configSettings[6] != &quot;&quot;)
                        _showLabel = bool.Parse(configSettings[6]);

                    if (configSettings.Length &gt; 7 &amp;&amp; configSettings[7] != &quot;&quot;)
                        m_maxImageWidth = int.Parse(configSettings[7]);

                    // sizing
                    if (!_fullWidth)
                    {
                        config.Add(&quot;width&quot;, _width.ToString());
                        config.Add(&quot;height&quot;, _height.ToString());
                    }

                    if (_enableContextMenu)
                        _plugins += &quot;,contextmenu&quot;;


                    // If the editor is used in umbraco, use umbraco&#39;s own toolbar
                    bool onFront = false;
                    if (GlobalSettings.RequestIsInUmbracoApplication(HttpContext.Current))
                    {
                        config.Add(&quot;theme_umbraco_toolbar_location&quot;, &quot;external&quot;);
                        config.Add(&quot;skin&quot;, &quot;umbraco&quot;);
                        config.Add(&quot;inlinepopups_skin &quot;, &quot;umbraco&quot;);
                    }
                    else
                    {
                        onFront = true;
                        config.Add(&quot;theme_umbraco_toolbar_location&quot;, &quot;top&quot;);
                    }

                    // load plugins
                    IDictionaryEnumerator pluginEnum = tinyMCEConfiguration.Plugins.GetEnumerator();
                    while (pluginEnum.MoveNext())
                    {
                        var plugin = (tinyMCEPlugin)pluginEnum.Value;
                        if (plugin.UseOnFrontend || (!onFront &amp;&amp; !plugin.UseOnFrontend))
                            _plugins += &quot;,&quot; + plugin.Name;
                    }

                    // add the umbraco overrides to the end
                    // NB: It is !!REALLY IMPORTANT!! that these plugins are added at the end
                    // as they make runtime modifications to default plugins, so require
                    // those plugins to be loaded first.
                    _plugins += &quot;,umbracopaste,umbracolink,umbracocontextmenu&quot;;

                    if (_plugins.StartsWith(&quot;,&quot;))
                        _plugins = _plugins.Substring(1, _plugins.Length - 1);
                    if (_plugins.EndsWith(&quot;,&quot;))
                        _plugins = _plugins.Substring(0, _plugins.Length - 1);

                    config.Add(&quot;plugins&quot;, _plugins);

                    // Check advanced settings
                    if (UmbracoEnsuredPage.CurrentUser != null &amp;&amp; (&quot;,&quot; + _advancedUsers + &quot;,&quot;).IndexOf(&quot;,&quot; + UmbracoEnsuredPage.CurrentUser.UserType.Id + &quot;,&quot;) &gt;
                        -1)
                        config.Add(&quot;umbraco_advancedMode&quot;, &quot;true&quot;);
                    else
                        config.Add(&quot;umbraco_advancedMode&quot;, &quot;false&quot;);

                    // Check maximum image width
                    config.Add(&quot;umbraco_maximumDefaultImageWidth&quot;, m_maxImageWidth.ToString());

                    // Styles
                    string cssFiles = String.Empty;
                    string styles = string.Empty;
                    foreach (string styleSheetId in _stylesheets)
                    {
                        if (styleSheetId.Trim() != &quot;&quot;)
                            try
                            {

                                //TODO: Fix this, it will no longer work!
                                var s = StyleSheet.GetStyleSheet(int.Parse(styleSheetId), false, false);

                                if (s.nodeObjectType == StyleSheet.ModuleObjectType)
                                {
                                    cssFiles += IOHelper.ResolveUrl(SystemDirectories.Css + &quot;/&quot; + s.Text + &quot;.css&quot;);

                                    foreach (StylesheetProperty p in s.Properties)
                                    {
                                        if (styles != string.Empty)
                                            styles += &quot;;&quot;;
                                        styles += p.Text + &quot;=&quot; + p.Alias;
                                    }

                                    cssFiles += &quot;,&quot;;
                                }
                            }
                            catch (Exception ee)
                            {
								LogHelper.Error&lt;TinyMCE&gt;(&quot;Error adding stylesheet to tinymce Id:&quot; + styleSheetId, ee);
                            }
                    }
                    // remove any ending comma (,)
                    if (!string.IsNullOrEmpty(cssFiles))
                    {
                        cssFiles = cssFiles.TrimEnd(&#39;,&#39;);
                    }

                    // language
                    string userLang = (UmbracoEnsuredPage.CurrentUser != null) ?
                        (User.GetCurrent().Language.Contains(&quot;-&quot;) ?
                            User.GetCurrent().Language.Substring(0, User.GetCurrent().Language.IndexOf(&quot;-&quot;)) : User.GetCurrent().Language)
                        : &quot;en&quot;;
                    config.Add(&quot;language&quot;, userLang);

                    config.Add(&quot;content_css&quot;, cssFiles);
                    config.Add(&quot;theme_umbraco_styles&quot;, styles);

                    // Add buttons
                    IDictionaryEnumerator ide = tinyMCEConfiguration.Commands.GetEnumerator();
                    while (ide.MoveNext())
                    {
                        var cmd = (tinyMCECommand)ide.Value;
                        if (_editorButtons.IndexOf(&quot;,&quot; + cmd.Alias + &quot;,&quot;) &gt; -1)
                            _activateButtons += cmd.Alias + &quot;,&quot;;
                        else
                            _disableButtons += cmd.Alias + &quot;,&quot;;
                    }

                    if (_activateButtons.Length &gt; 0)
                        _activateButtons = _activateButtons.Substring(0, _activateButtons.Length - 1);
                    if (_disableButtons.Length &gt; 0)
                        _disableButtons = _disableButtons.Substring(0, _disableButtons.Length - 1);

                    // Add buttons
                    initButtons();
                    _activateButtons = &quot;&quot;;

                    int separatorPriority = 0;
                    ide = _mceButtons.GetEnumerator();
                    while (ide.MoveNext())
                    {
                        string mceCommand = ide.Value.ToString();
                        var curPriority = (int)ide.Key;

                        // Check priority
                        if (separatorPriority &gt; 0 &amp;&amp;
                            Math.Floor(decimal.Parse(curPriority.ToString()) / 10) &gt;
                            Math.Floor(decimal.Parse(separatorPriority.ToString()) / 10))
                            _activateButtons += &quot;separator,&quot;;

                        _activateButtons += mceCommand + &quot;,&quot;;

                        separatorPriority = curPriority;
                    }


                    config.Add(&quot;theme_umbraco_buttons1&quot;, _activateButtons);
                    config.Add(&quot;theme_umbraco_buttons2&quot;, &quot;&quot;);
                    config.Add(&quot;theme_umbraco_buttons3&quot;, &quot;&quot;);
                    config.Add(&quot;theme_umbraco_toolbar_align&quot;, &quot;left&quot;);
                    config.Add(&quot;theme_umbraco_disable&quot;, _disableButtons);

                    config.Add(&quot;theme_umbraco_path &quot;, &quot;true&quot;);
                    config.Add(&quot;extended_valid_elements&quot;, &quot;div[*]&quot;);
                    config.Add(&quot;document_base_url&quot;, &quot;/&quot;);
                    config.Add(&quot;relative_urls&quot;, &quot;false&quot;);
                    config.Add(&quot;remove_script_host&quot;, &quot;true&quot;);
                    config.Add(&quot;event_elements&quot;, &quot;div&quot;);
                    config.Add(&quot;paste_auto_cleanup_on_paste&quot;, &quot;true&quot;);

                    config.Add(&quot;valid_elements&quot;,
                               tinyMCEConfiguration.ValidElements.Substring(1,
                                                                            tinyMCEConfiguration.ValidElements.Length -
                                                                            2));
                    config.Add(&quot;invalid_elements&quot;, tinyMCEConfiguration.InvalidElements);

                    // custom commands
                    if (tinyMCEConfiguration.ConfigOptions.Count &gt; 0)
                    {
                        ide = tinyMCEConfiguration.ConfigOptions.GetEnumerator();
                        while (ide.MoveNext())
                        {
                            config.Add(ide.Key.ToString(), ide.Value.ToString());
                        }
                    }

                    //if (HttpContext.Current.Request.Path.IndexOf(Umbraco.Core.IO.SystemDirectories.Umbraco) &gt; -1)
                    //    config.Add(&quot;language&quot;, User.GetUser(BasePage.GetUserId(BasePage.umbracoUserContextID)).Language);
                    //else
                    //    config.Add(&quot;language&quot;, System.Threading.Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName);

                    if (_fullWidth)
                    {
                        config.Add(&quot;auto_resize&quot;, &quot;true&quot;);
                        base.Columns = 30;
                        base.Rows = 30;
                    }
                    else
                    {
                        base.Columns = 0;
                        base.Rows = 0;
                    }
                    EnableViewState = false;
                }
            }
            catch (Exception ex)
            {
                throw new ArgumentException(&quot;Incorrect TinyMCE configuration.&quot;, &quot;Configuration&quot;, ex);
            }
        }

        #region TreatAsRichTextEditor

        public virtual bool TreatAsRichTextEditor
        {
            get { return false; }
        }

        #endregion

        #region ShowLabel

        public virtual bool ShowLabel
        {
            get { return _showLabel; }
        }

        #endregion

        #region Editor

        public Control Editor
        {
            get { return this; }
        }

        #endregion

        #region Save()

        public virtual void Save()
        {
            string parsedString = base.Text.Trim();
            string parsedStringForTinyMce = parsedString;
            if (parsedString != string.Empty)
            {
                parsedString = replaceMacroTags(parsedString).Trim();

                // tidy html - refactored, see #30534
                if (UmbracoConfig.For.UmbracoSettings().Content.TidyEditorContent)
                {
                    // always wrap in a &lt;div&gt; - using &lt;p&gt; was a bad idea
                    parsedString = &quot;&lt;div&gt;&quot; + parsedString + &quot;&lt;/div&gt;&quot;;

                    string tidyTxt = library.Tidy(parsedString, false);
                    if (tidyTxt != &quot;[error]&quot;)
                    {
                        parsedString = tidyTxt;

                        // remove pesky \r\n, and other empty chars
                        parsedString = parsedString.Trim(new char[] { &#39;\r&#39;, &#39;\n&#39;, &#39;\t&#39;, &#39; &#39; });

                        // compensate for breaking macro tags by tidy (?)
                        parsedString = parsedString.Replace(&quot;/?&gt;&quot;, &quot;/&gt;&quot;);

                        // remove the wrapping &lt;div&gt; - safer to check that it is still here
                        if (parsedString.StartsWith(&quot;&lt;div&gt;&quot;) &amp;&amp; parsedString.EndsWith(&quot;&lt;/div&gt;&quot;))
                            parsedString = parsedString.Substring(&quot;&lt;div&gt;&quot;.Length, parsedString.Length - &quot;&lt;div&gt;&lt;/div&gt;&quot;.Length);
                    }
                }

                // rescue umbraco tags
                parsedString = parsedString.Replace(&quot;|||?&quot;, &quot;&lt;?&quot;).Replace(&quot;/|||&quot;, &quot;/&gt;&quot;).Replace(&quot;|*|&quot;, &quot;\&quot;&quot;);

                // fix images
                parsedString = tinyMCEImageHelper.cleanImages(parsedString);

                // parse current domain and instances of slash before anchor (to fix anchor bug)
                // NH 31-08-2007
                if (HttpContext.Current.Request.ServerVariables != null)
                {
                    parsedString = parsedString.Replace(helper.GetBaseUrl(HttpContext.Current) + &quot;/#&quot;, &quot;#&quot;);
                    parsedString = parsedString.Replace(helper.GetBaseUrl(HttpContext.Current), &quot;&quot;);
                }
	            // if a paragraph is empty, remove it
	            if (parsedString.ToLower() == &quot;&lt;p&gt;&lt;/p&gt;&quot;)
                parsedString = &quot;&quot;;
	  
	            // save string after all parsing is done, but before CDATA replacement - to put back into TinyMCE
	            parsedStringForTinyMce = parsedString;

                //Allow CDATA nested into RTE without exceptions
                // GE 2012-01-18
                parsedString = parsedString.Replace(&quot;&lt;![CDATA[&quot;, &quot;&lt;!--CDATAOPENTAG--&gt;&quot;).Replace(&quot;]]&gt;&quot;, &quot;&lt;!--CDATACLOSETAG--&gt;&quot;);
            }

            _data.Value = parsedString;

            // update internal webcontrol value with parsed result
            base.Text = parsedStringForTinyMce;
        }

        #endregion

        public virtual string Plugins
        {
            get { return _plugins; }
            set { _plugins = value; }
        }

        public object[] MenuIcons
        {
            get
            {
                initButtons();

                var tempIcons = new object[_menuIcons.Count];
                for (int i = 0; i &lt; _menuIcons.Count; i++)
                    tempIcons[i] = _menuIcons[i];
                return tempIcons;
            }
        }


        #region IMenuElement Members

        public string ElementName
        {
            get { return &quot;div&quot;; }
        }

        public string ElementIdPreFix
        {
            get { return &quot;umbTinymceMenu&quot;; }
        }

        public string ElementClass
        {
            get { return &quot;tinymceMenuBar&quot;; }
        }

        public int ExtraMenuWidth
        {
            get
            {
                initButtons();
                return _buttons.Count * 40 + 300;
            }
        }

        #endregion

        protected override void OnLoad(EventArgs e)
        {
            try
            {
                // add current page info
                base.NodeId = ((cms.businesslogic.datatype.DefaultData)_data).NodeId;
                if (NodeId != 0)
                {
                    base.VersionId = ((cms.businesslogic.datatype.DefaultData)_data).Version;
                    config.Add(&quot;theme_umbraco_pageId&quot;, base.NodeId.ToString());
                    config.Add(&quot;theme_umbraco_versionId&quot;, base.VersionId.ToString());

                    // we&#39;ll need to make an extra check for the liveediting as that value is set after the constructor have initialized
                    config.Add(&quot;umbraco_toolbar_id&quot;,
                                   ElementIdPreFix +
                                   ((cms.businesslogic.datatype.DefaultData)_data).PropertyId);
                }
                else
                {
                    // this is for use when tinymce is used for non default Umbraco pages
                    config.Add(&quot;umbraco_toolbar_id&quot;,
                               ElementIdPreFix + &quot;_&quot; + this.ClientID);
                }
            }
            catch
            {
                // Empty catch as this is caused by the document doesn&#39;t exists yet,
                // like when using this on an autoform, partly replaced by the if/else check on nodeId above though
            }
            base.OnLoad(e);
        }

        protected override void OnInit(EventArgs e)
        {
            base.OnInit(e);
            //Allow CDATA nested into RTE without exceptions
            // GE 2012-01-18
            if (_data != null &amp;&amp; _data.Value != null)
                base.Text = _data.Value.ToString().Replace(&quot;&lt;!--CDATAOPENTAG--&gt;&quot;, &quot;&lt;![CDATA[&quot;).Replace(&quot;&lt;!--CDATACLOSETAG--&gt;&quot;, &quot;]]&gt;&quot;);
        }

        private string replaceMacroTags(string text)
        {
            while (findStartTag(text) &gt; -1)
            {
                string result = text.Substring(findStartTag(text), findEndTag(text) - findStartTag(text));
                text = text.Replace(result, generateMacroTag(result));
            }
            return text;
        }

        private string generateMacroTag(string macroContent)
        {
            string macroAttr = macroContent.Substring(5, macroContent.IndexOf(&quot;&gt;&quot;) - 5);
            string macroTag = &quot;|||?UMBRACO_MACRO &quot;;
            Hashtable attributes = ReturnAttributes(macroAttr);
            IDictionaryEnumerator ide = attributes.GetEnumerator();
            while (ide.MoveNext())
            {
                if (ide.Key.ToString().IndexOf(&quot;umb_&quot;) != -1)
                {
                    // Hack to compensate for Firefox adding all attributes as lowercase
                    string orgKey = ide.Key.ToString();
                    if (orgKey == &quot;umb_macroalias&quot;)
                        orgKey = &quot;umb_macroAlias&quot;;

                    macroTag += orgKey.Substring(4, orgKey.Length - 4) + &quot;=|*|&quot; +
                                ide.Value.ToString().Replace(&quot;\\r\\n&quot;, Environment.NewLine) + &quot;|*| &quot;;
                }
            }
            macroTag += &quot;/|||&quot;;

            return macroTag;
        }

		[Obsolete(&quot;Has been superceded by Umbraco.Core.XmlHelper.GetAttributesFromElement&quot;)]
		public static Hashtable ReturnAttributes(String tag)
		{
			var h = new Hashtable();
			foreach (var i in Umbraco.Core.XmlHelper.GetAttributesFromElement(tag))
			{
				h.Add(i.Key, i.Value);
			}
			return h;
		}

        private int findStartTag(string text)
        {
            string temp = &quot;&quot;;
            text = text.ToLower();
            if (text.IndexOf(&quot;ismacro=\&quot;true\&quot;&quot;) &gt; -1)
            {
                temp = text.Substring(0, text.IndexOf(&quot;ismacro=\&quot;true\&quot;&quot;));
                return temp.LastIndexOf(&quot;&lt;&quot;);
            }
            return -1;
        }

        private int findEndTag(string text)
        {
            string find = &quot;&lt;!-- endumbmacro --&gt;&quot;;

            int endMacroIndex = text.ToLower().IndexOf(find);
            string tempText = text.ToLower().Substring(endMacroIndex + find.Length,
                                                       text.Length - endMacroIndex - find.Length);
            int finalEndPos = 0;
            while (tempText.Length &gt; 5)
                if (tempText.Substring(finalEndPos, 6) == &quot;&lt;/div&gt;&quot;)
                    break;
                else
                    finalEndPos++;

            return endMacroIndex + find.Length + finalEndPos + 6;
        }

        private void initButtons()
        {
            if (!_isInitialized)
            {
                _isInitialized = true;

                // Add icons for the editor control:
                // Html
                // Preview
                // Style picker, showstyles
                // Bold, italic, Text Gen
                // Align: left, center, right
                // Lists: Bullet, Ordered, indent, undo indent
                // Link, Anchor
                // Insert: Image, macro, table, formular

                foreach (string button in _activateButtons.Split(&#39;,&#39;))
                {
                    if (button.Trim() != &quot;&quot;)
                    {
                        try
                        {
                            var cmd = (tinyMCECommand)tinyMCEConfiguration.Commands[button];

                            string appendValue = &quot;&quot;;
                            if (cmd.Value != &quot;&quot;)
                                appendValue = &quot;, &#39;&quot; + cmd.Value + &quot;&#39;&quot;;
                            _mceButtons.Add(cmd.Priority, cmd.Command);
                            _buttons.Add(cmd.Priority,
                                         new editorButton(cmd.Alias, ui.Text(&quot;buttons&quot;, cmd.Alias), cmd.Icon,
                                                          &quot;tinyMCE.execInstanceCommand(&#39;&quot; + ClientID + &quot;&#39;, &#39;&quot; +
                                                          cmd.Command + &quot;&#39;, &quot; + cmd.UserInterface + appendValue + &quot;)&quot;));
                        }
                        catch (Exception ee)
                        {
							LogHelper.Error&lt;TinyMCE&gt;(string.Format(&quot;TinyMCE: Error initializing button &#39;{0}&#39;&quot;, button), ee);
                        }
                    }
                }

                // add save icon
                int separatorPriority = 0;
                IDictionaryEnumerator ide = _buttons.GetEnumerator();
                while (ide.MoveNext())
                {
                    object buttonObj = ide.Value;
                    var curPriority = (int)ide.Key;

                    // Check priority
                    if (separatorPriority &gt; 0 &amp;&amp;
                        Math.Floor(decimal.Parse(curPriority.ToString()) / 10) &gt;
                        Math.Floor(decimal.Parse(separatorPriority.ToString()) / 10))
                        _menuIcons.Add(&quot;|&quot;);

                    try
                    {
                        var e = (editorButton)buttonObj;

                        MenuIconI menuItem = new MenuIconClass();

                        menuItem.OnClickCommand = e.onClickCommand;
                        menuItem.ImageURL = e.imageUrl;
                        menuItem.AltText = e.alttag;
                        menuItem.ID = e.id;
                        _menuIcons.Add(menuItem);
                    }
                    catch
                    {
                    }

                    separatorPriority = curPriority;
                }
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[24,9,24,55,0],[25,9,25,53,0],[26,9,26,65,0],[28,9,28,69,0],[29,9,29,53,0],[33,9,33,68,0],[34,9,34,65,0],[36,9,36,67,0],[39,9,39,52,0],[41,9,41,38,0],[43,9,43,57,0],[44,9,44,10,0],[45,13,45,26,0],[47,13,47,14,0],[48,17,48,82,0],[50,17,50,47,0],[51,17,51,18,0],[52,21,52,56,0],[54,21,54,51,0],[55,25,55,54,0],[56,29,56,55,0],[58,21,58,51,0],[59,25,59,60,0],[61,21,61,51,0],[62,21,62,22,0],[63,25,63,54,0],[64,29,64,47,0],[65,30,65,74,0],[66,25,66,26,0],[67,29,67,81,0],[68,29,68,82,0],[69,25,69,26,0],[70,21,70,22,0],[73,21,73,36,0],[74,25,74,38,0],[75,21,75,37,0],[76,25,76,39,0],[79,21,79,51,0],[80,21,80,22,0],[81,25,81,32,0],[81,34,81,42,0],[81,43,81,45,0],[81,46,81,88,0],[82,29,82,49,0],[83,21,83,22,0],[85,21,85,78,0],[86,25,86,68,0],[88,21,88,78,0],[89,25,89,72,0],[92,21,92,37,0],[93,21,93,22,0],[94,25,94,64,0],[95,25,95,66,0],[96,21,96,22,0],[98,21,98,44,0],[99,25,99,52,0],[103,21,103,42,0],[104,21,104,91,0],[105,21,105,22,0],[106,25,106,82,0],[107,25,107,55,0],[108,25,108,69,0],[109,21,109,22,0],[111,21,111,22,0],[112,25,112,40,0],[113,25,113,77,0],[114,21,114,22,0],[117,21,117,101,0],[118,21,118,50,0],[119,21,119,22,0],[120,25,120,70,0],[121,25,121,89,0],[122,29,122,59,0],[123,21,123,22,0],[129,21,129,80,0],[131,21,131,50,0],[132,25,132,79,0],[133,21,133,48,0],[134,25,134,79,0],[136,21,136,53,0],[139,21,140,28,0],[141,25,141,68,0],[143,25,143,69,0],[146,21,146,96,0],[149,21,149,52,0],[150,21,150,50,0],[151,21,151,28,0],[151,30,151,49,0],[151,50,151,52,0],[151,53,151,65,0],[152,21,152,22,0],[153,25,153,55,0],[155,29,155,30,0],[158,33,158,105,0],[160,33,160,85,0],[161,33,161,34,0],[162,37,162,116,0],[164,37,164,44,0],[164,46,164,66,0],[164,67,164,69,0],[164,70,164,82,0],[165,37,165,38,0],[166,41,166,68,0],[167,45,167,59,0],[168,41,168,74,0],[169,37,169,38,0],[171,37,171,53,0],[172,33,172,34,0],[173,29,173,30,0],[174,29,174,49,0],[175,29,175,30,0],[176,9,176,95,0],[177,29,177,30,0],[178,21,178,22,0],[180,21,180,57,0],[181,21,181,22,0],[182,25,182,58,0],[183,21,183,22,0],[186,21,189,32,0],[190,21,190,54,0],[192,21,192,57,0],[193,21,193,64,0],[196,21,196,95,0],[197,21,197,43,0],[198,21,198,22,0],[199,25,199,61,0],[200,25,200,80,0],[201,29,201,65,0],[203,29,203,64,0],[204,21,204,22,0],[206,21,206,53,0],[207,25,207,103,0],[208,21,208,52,0],[209,25,209,100,0],[212,21,212,35,0],[213,21,213,43,0],[215,21,215,47,0],[216,21,216,55,0],[217,21,217,43,0],[218,21,218,22,0],[219,25,219,66,0],[220,25,220,56,0],[223,25,225,90,0],[226,29,226,62,0],[228,25,228,62,0],[230,25,230,57,0],[231,21,231,22,0],[234,21,234,76,0],[235,21,235,62,0],[236,21,236,62,0],[237,21,237,71,0],[238,21,238,74,0],[240,21,240,63,0],[241,21,241,69,0],[242,21,242,58,0],[243,21,243,58,0],[244,21,244,62,0],[245,21,245,57,0],[246,21,246,71,0],[248,21,251,81,0],[252,21,252,90,0],[255,21,255,70,0],[256,21,256,22,0],[257,25,257,82,0],[258,25,258,47,0],[259,25,259,26,0],[260,29,260,82,0],[261,25,261,26,0],[262,21,262,22,0],[269,21,269,36,0],[270,21,270,22,0],[271,25,271,59,0],[272,25,272,43,0],[273,25,273,40,0],[274,21,274,22,0],[276,21,276,22,0],[277,25,277,42,0],[278,25,278,39,0],[279,21,279,22,0],[280,21,280,45,0],[281,17,281,18,0],[282,13,282,14,0],[283,13,283,33,0],[284,13,284,14,0],[285,17,285,102,0],[287,9,287,10,0],[293,17,293,18,0],[293,19,293,32,0],[293,33,293,34,0],[302,17,302,18,0],[302,19,302,37,0],[302,38,302,39,0],[311,17,311,18,0],[311,19,311,31,0],[311,32,311,33,0],[319,9,319,10,0],[320,13,320,52,0],[321,13,321,58,0],[322,13,322,46,0],[323,13,323,14,0],[324,17,324,70,0],[327,17,327,83,0],[328,17,328,18,0],[330,21,330,70,0],[332,21,332,72,0],[333,21,333,46,0],[334,21,334,22,0],[335,25,335,48,0],[338,25,338,96,0],[341,25,341,74,0],[344,25,344,97,0],[345,29,345,127,0],[346,21,346,22,0],[347,17,347,18,0],[350,17,350,110,0],[353,17,353,77,0],[357,17,357,73,0],[358,17,358,18,0],[359,21,359,109,0],[360,21,360,101,0],[361,17,361,18,0],[363,14,363,54,0],[364,17,364,35,0],[367,14,367,52,0],[371,17,371,128,0],[372,13,372,14,0],[374,13,374,40,0],[377,13,377,48,0],[378,9,378,10,0],[384,17,384,18,0],[384,19,384,35,0],[384,36,384,37,0],[385,17,385,18,0],[385,19,385,36,0],[385,37,385,38,0],[391,13,391,14,0],[392,17,392,31,0],[394,17,394,62,0],[395,22,395,31,0],[395,33,395,53,0],[395,55,395,58,0],[396,21,396,50,0],[397,17,397,34,0],[398,13,398,14,0],[406,17,406,18,0],[406,19,406,32,0],[406,33,406,34,0],[411,17,411,18,0],[411,19,411,43,0],[411,44,411,45,0],[416,17,416,18,0],[416,19,416,43,0],[416,44,416,45,0],[422,13,422,14,0],[423,17,423,31,0],[424,17,424,50,0],[425,13,425,14,0],[431,9,431,10,0],[433,13,433,14,0],[435,17,435,86,0],[436,17,436,33,0],[437,17,437,18,0],[438,21,438,94,0],[439,21,439,80,0],[440,21,440,86,0],[443,21,445,96,0],[446,17,446,18,0],[448,17,448,18,0],[450,21,451,71,0],[452,17,452,18,0],[453,13,453,14,0],[454,13,454,18,0],[455,13,455,14,0],[458,13,458,14,0],[459,13,459,28,0],[460,9,460,10,0],[463,9,463,10,0],[464,13,464,28,0],[467,13,467,54,0],[468,17,468,135,0],[469,9,469,10,0],[472,9,472,10,0],[473,13,473,44,0],[474,13,474,14,0],[475,17,475,107,0],[476,17,476,71,0],[477,13,477,14,0],[478,13,478,25,0],[479,9,479,10,0],[482,9,482,10,0],[483,13,483,89,0],[484,13,484,52,0],[485,13,485,64,0],[486,13,486,68,0],[487,13,487,35,0],[488,13,488,14,0],[489,17,489,62,0],[490,17,490,18,0],[492,21,492,56,0],[493,21,493,52,0],[494,25,494,51,0],[496,21,497,102,0],[498,17,498,18,0],[499,13,499,14,0],[500,13,500,32,0],[502,13,502,29,0],[503,9,503,10,0],[507,3,507,4,0],[508,4,508,28,0],[509,4,509,11,0],[509,13,509,18,0],[509,19,509,21,0],[509,22,509,74,0],[510,4,510,5,0],[511,5,511,27,0],[512,4,512,5,0],[513,4,513,13,0],[514,3,514,4,0],[517,9,517,10,0],[518,13,518,30,0],[519,13,519,35,0],[520,13,520,55,0],[521,13,521,14,0],[522,17,522,76,0],[523,17,523,46,0],[525,13,525,23,0],[526,9,526,10,0],[529,9,529,10,0],[530,13,530,50,0],[532,13,532,62,0],[533,13,534,99,0],[535,13,535,33,0],[536,13,536,40,0],[537,17,537,68,0],[538,21,538,27,0],[540,21,540,35,0],[542,13,542,66,0],[543,9,543,10,0],[546,9,546,10,0],[547,13,547,33,0],[548,13,548,14,0],[549,17,549,39,0],[561,17,561,24,0],[561,26,561,39,0],[561,40,561,42,0],[561,43,561,70,0],[562,17,562,18,0],[563,21,563,45,0],[564,21,564,22,0],[566,25,566,26,0],[567,29,567,93,0],[569,29,569,53,0],[570,29,570,49,0],[571,33,571,71,0],[572,29,572,72,0],[573,29,576,121,0],[577,25,577,26,0],[578,25,578,45,0],[579,25,579,26,0],[580,8,580,104,0],[581,25,581,26,0],[582,21,582,22,0],[583,17,583,18,0],[586,17,586,43,0],[587,17,587,70,0],[588,17,588,39,0],[589,17,589,18,0],[590,21,590,50,0],[591,21,591,52,0],[594,21,596,86,0],[597,25,597,45,0],[600,21,600,22,0],[601,25,601,57,0],[603,25,603,66,0],[605,25,605,68,0],[606,25,606,56,0],[607,25,607,53,0],[608,25,608,44,0],[609,25,609,50,0],[610,21,610,22,0],[611,21,611,26,0],[612,21,612,22,0],[613,21,613,22,0],[615,21,615,53,0],[616,17,616,18,0],[617,13,617,14,0],[618,9,618,10,0]]);
    </script>
  </body>
</html>