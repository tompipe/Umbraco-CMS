<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Persistence\Querying\MediaRepositorySqlClausesTest.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Diagnostics;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Core.Models.Rdbms;
using Umbraco.Core.Persistence;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Persistence.Querying
{
    [TestFixture]
    public class MediaRepositorySqlClausesTest : BaseUsingSqlCeSyntax
    {
        [Test]
        public void Can_Verify_Base_Clause()
        {
            var NodeObjectTypeId = new Guid(Constants.ObjectTypes.Media);

            var expected = new Sql();
            expected.Select(&quot;*&quot;)
                .From(&quot;[cmsContentVersion]&quot;)
                .InnerJoin(&quot;[cmsContent]&quot;).On(&quot;[cmsContentVersion].[ContentId] = [cmsContent].[nodeId]&quot;)
                .InnerJoin(&quot;[umbracoNode]&quot;).On(&quot;[cmsContent].[nodeId] = [umbracoNode].[id]&quot;)
                .Where(&quot;([umbracoNode].[nodeObjectType] = @0)&quot;, new Guid(&quot;b796f64c-1f99-4ffb-b886-4bf4bc011a9c&quot;));

            var sql = new Sql();
            sql.Select(&quot;*&quot;)
                .From&lt;ContentVersionDto&gt;()
                .InnerJoin&lt;ContentDto&gt;()
                .On&lt;ContentVersionDto, ContentDto&gt;(left =&gt; left.NodeId, right =&gt; right.NodeId)
                .InnerJoin&lt;NodeDto&gt;()
                .On&lt;ContentDto, NodeDto&gt;(left =&gt; left.NodeId, right =&gt; right.NodeId)
                .Where&lt;NodeDto&gt;(x =&gt; x.NodeObjectType == NodeObjectTypeId);

            Assert.That(sql.SQL, Is.EqualTo(expected.SQL));

            Assert.AreEqual(expected.Arguments.Length, sql.Arguments.Length);
            for (int i = 0; i &lt; expected.Arguments.Length; i++)
            {
                Assert.AreEqual(expected.Arguments[i], sql.Arguments[i]);
            }

            Debug.Print(sql.SQL);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,1],[17,13,17,74,1],[19,13,19,38,1],[20,13,24,115,1],[26,13,26,33,1],[27,13,33,76,1],[35,13,35,60,1],[37,13,37,78,1],[38,18,38,27,1],[38,29,38,58,1],[38,60,38,63,1],[39,13,39,14,1],[40,17,40,74,1],[41,13,41,14,1],[43,13,43,34,1],[44,9,44,10,1]]);
    </script>
  </body>
</html>