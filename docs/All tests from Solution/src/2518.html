<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.businesslogic\Utils\JSONSerializer.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Text;
using System.Web.Script.Serialization;
using System.Text.RegularExpressions;

namespace umbraco.businesslogic.Utils
{
	/// &lt;summary&gt;
	/// The built in JavaScriptSerializer does not allow you to export real JavaScript
	/// objects, functions, etc... only string values which isn&#39;t always what you want.
	/// See &lt;see cref=&quot;example&quot;/&gt;
	/// 
	/// Override the JavaScriptSerializer serialization process and look for any
	/// custom &quot;tags&quot; strings such as a @ symbol which depicts that the string value 
	/// should really be a JSON value, therefore the output removes the double quotes.
	/// 
	/// &lt;/summary&gt;
	/// &lt;example&gt;
	/// If you want to output:
	/// {&quot;myFunction&quot;: function() {alert(&#39;hello&#39;);}}
	/// The JavaScriptSerializer will not let you do this, it will render:
	/// {&quot;myFunction&quot;: &quot;function() {alert(&#39;hello&#39;);}&quot;}
	/// which means that JavaScript will interpret it as a string.
	/// This class allows you to output JavaScript objects, amongst other things.
	/// &lt;/example&gt;
	public class JSONSerializer : JavaScriptSerializer
	{

		public new string Serialize(object obj)
		{
			string output = base.Serialize(obj);

			//replaces all strings beginning with this prefix to have no double quotes
			Regex regex1 = new Regex(string.Format(&quot;(\&quot;{0}(.*?)\&quot;)+&quot;, PrefixJavaScriptObject),
				RegexOptions.Multiline
				| RegexOptions.CultureInvariant
				| RegexOptions.Compiled
			);
			string result = regex1.Replace(output, &quot;$2&quot;);
		
			return result;
		}

		private const string PrefixJavaScriptObject = &quot;@@@@&quot;;

		/// &lt;summary&gt;
		/// method for a string to be converted to a json object.
		/// &lt;/summary&gt;
		/// &lt;param name=&quot;s&quot;&gt;&lt;/param&gt;
		/// &lt;returns&gt;A string formatted with a special prefix&lt;/returns&gt;
		/// &lt;remarks&gt;
		/// This essentially just prefixes the string with a special key that we will use
		/// to parse with later during serialization.
		/// &lt;/remarks&gt;
		public static string ToJSONObject(string s)
		{
			return PrefixJavaScriptObject + s;
		}

	
	}

	

}


    </pre>
    <script type="text/javascript">
      highlightRanges([[31,3,31,4,0],[32,4,32,40,0],[35,4,39,6,0],[40,4,40,49,0],[42,4,42,18,0],[43,3,43,4,0],[57,3,57,4,0],[58,4,58,38,0],[59,3,59,4,0]]);
    </script>
  </body>
</html>