<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\DelegateExtensionsTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using Lucene.Net.Index;
using NUnit.Framework;
using Umbraco.Core;

namespace Umbraco.Tests
{
    [TestFixture]
    public class DelegateExtensionsTests
    {

        [Test]
        public void Only_Executes_Specific_Count()
        {
            var maxTries = 5;
            var totalTries = 0;
            DelegateExtensions.RetryUntilSuccessOrMaxAttempts((currentTry) =&gt;
            {
                totalTries = currentTry;
                return Attempt&lt;IndexWriter&gt;.Fail();
            }, 5, TimeSpan.FromMilliseconds(10));

            Assert.AreEqual(maxTries, totalTries);
        }

        [Test]
        public void Quits_On_Success_Count()
        {
            var maxTries = 5;
            var totalTries = 0;
            DelegateExtensions.RetryUntilSuccessOrMaxAttempts((currentTry) =&gt;
            {
                totalTries = currentTry;
                if (totalTries == 2)
                {
                    return Attempt&lt;string&gt;.Succeed();
                }                
                return Attempt&lt;string&gt;.Fail();
            }, 5, TimeSpan.FromMilliseconds(10));

            Assert.AreEqual(2, totalTries);
        }


    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,10,1],[15,13,15,30,1],[16,13,16,32,1],[17,13,18,13,1],[18,13,18,14,1],[18,14,19,17,1],[19,17,19,41,1],[19,41,20,17,1],[20,17,20,52,1],[20,52,21,13,1],[21,13,21,14,1],[21,14,21,50,1],[17,13,21,50,1],[23,13,23,51,1],[24,9,24,10,1],[28,9,28,10,1],[29,13,29,30,1],[30,13,30,32,1],[31,13,32,13,1],[32,13,32,14,1],[32,14,33,17,1],[33,17,33,41,1],[33,41,34,17,1],[34,17,34,37,1],[34,37,35,17,1],[35,17,35,18,1],[35,18,36,21,1],[36,21,36,54,1],[36,54,38,17,1],[38,17,38,47,1],[38,47,39,13,1],[39,13,39,14,1],[39,14,39,50,1],[31,13,39,50,1],[41,13,41,44,1],[42,9,42,10,1]]);
    </script>
  </body>
</html>