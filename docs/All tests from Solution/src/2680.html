<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\umbraco.editorControls\SettingControls\Pickers\BasePicker.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using umbraco.cms.businesslogic.datatype;

namespace umbraco.editorControls.SettingControls.Pickers
{
    [Obsolete(&quot;IDataType and all other references to the legacy property editors are no longer used this will be removed from the codebase in future versions&quot;)]
    public class BasePicker: DataEditorSettingType
    {
        public Guid ObjectGuid { get; set; }

        private System.Web.UI.WebControls.DropDownList ddl = new System.Web.UI.WebControls.DropDownList();

        private string _val = string.Empty;

        public override string Value
        {
            get
            {
                return ddl.SelectedValue;
            }
            set
            {
                if (!string.IsNullOrEmpty(value))
                    _val = value;
            }
        }

        public override System.Web.UI.Control RenderControl(DataEditorSetting sender)
        {

            ddl.ID = sender.GetName();

            ddl.Items.Clear();
            List&lt;KeyValuePair&lt;String, String&gt;&gt; items = new List&lt;KeyValuePair&lt;String, String&gt;&gt;();

            if (ObjectGuid != Guid.Empty)
            {
                Guid[] guids = umbraco.cms.businesslogic.CMSNode.getAllUniquesFromObjectType(ObjectGuid);
                foreach (Guid g in guids)
                {
                    umbraco.cms.businesslogic.CMSNode node = new umbraco.cms.businesslogic.CMSNode(g);
                    items.Add(new KeyValuePair&lt;string, string&gt;(node.Id.ToString(), node.Text));
                }
            }

            items.Sort(delegate(KeyValuePair&lt;String, String&gt; x, KeyValuePair&lt;String, String&gt; y) { return x.Value.CompareTo(y.Value); });

            foreach (KeyValuePair&lt;String, String&gt; kv in items)
            {
                ddl.Items.Add(new System.Web.UI.WebControls.ListItem(kv.Value, kv.Key));
            }

            System.Web.UI.WebControls.ListItem li = new System.Web.UI.WebControls.ListItem(&quot;Choose...&quot;, &quot;&quot;);
            li.Selected = true;
            ddl.Items.Insert(0, li);


            if (string.IsNullOrEmpty(_val) &amp;&amp; !string.IsNullOrEmpty(DefaultValue))
                ddl.SelectedValue = DefaultValue;
            else
                ddl.SelectedValue = _val;

            return ddl;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,34,12,38,0],[12,39,12,43,0],[14,9,14,107,0],[16,9,16,44,0],[21,13,21,14,0],[22,17,22,42,0],[23,13,23,14,0],[25,13,25,14,0],[26,17,26,50,0],[27,21,27,34,0],[28,13,28,14,0],[32,9,32,10,0],[34,13,34,39,0],[36,13,36,31,0],[37,13,37,97,0],[39,13,39,42,0],[40,13,40,14,0],[41,17,41,106,0],[42,17,42,24,0],[42,26,42,32,0],[42,33,42,35,0],[42,36,42,41,0],[43,17,43,18,0],[44,21,44,103,0],[45,21,45,96,0],[46,17,46,18,0],[47,13,47,14,0],[49,13,49,97,0],[49,97,49,98,0],[49,98,49,99,0],[49,99,49,133,0],[49,133,49,134,0],[49,134,49,135,0],[49,135,49,137,0],[49,13,49,137,0],[51,13,51,20,0],[51,22,51,53,0],[51,54,51,56,0],[51,57,51,62,0],[52,13,52,14,0],[53,17,53,89,0],[54,13,54,14,0],[56,13,56,109,0],[57,13,57,32,0],[58,13,58,37,0],[61,13,61,83,0],[62,17,62,50,0],[64,17,64,42,0],[66,13,66,24,0],[67,9,67,10,0]]);
    </script>
  </body>
</html>