<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Models\Mapping\MacroModelMapper.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using AutoMapper;
using Umbraco.Core;
using Umbraco.Core.Logging;
using Umbraco.Core.Models;
using Umbraco.Core.Models.Mapping;
using Umbraco.Core.PropertyEditors;
using Umbraco.Web.Models.ContentEditing;

namespace Umbraco.Web.Models.Mapping
{
    /// &lt;summary&gt;
    /// Declares model mappings for macros.
    /// &lt;/summary&gt;
    internal class MacroModelMapper : MapperConfiguration
    {
        public override void ConfigureMappings(IConfiguration config, ApplicationContext applicationContext)
        {
            //FROM IMacro TO EntityBasic
            config.CreateMap&lt;IMacro, EntityBasic&gt;()
                  .ForMember(entityBasic =&gt; entityBasic.Icon, expression =&gt; expression.UseValue(&quot;icon-settings-alt&quot;))
                  .ForMember(dto =&gt; dto.ParentId, expression =&gt; expression.UseValue(-1))
                  .ForMember(dto =&gt; dto.Path, expression =&gt; expression.ResolveUsing(macro =&gt; &quot;-1,&quot; + macro.Id))
                  .ForMember(dto =&gt; dto.Trashed, expression =&gt; expression.Ignore())
                  .ForMember(dto =&gt; dto.AdditionalData, expression =&gt; expression.Ignore());

            config.CreateMap&lt;IMacro, IEnumerable&lt;MacroParameter&gt;&gt;()
                    .ConvertUsing(macro =&gt; macro.Properties.Select(Mapper.Map&lt;MacroParameter&gt;).ToList());

            config.CreateMap&lt;IMacroProperty, MacroParameter&gt;()
                .ForMember(x =&gt; x.View, expression =&gt; expression.Ignore())
                .ForMember(x =&gt; x.Configuration, expression =&gt; expression.Ignore())
                .ForMember(x =&gt; x.Value, expression =&gt; expression.Ignore())
                .AfterMap((property, parameter) =&gt;
                {
                    //map the view and the config

                    var paramEditor = ParameterEditorResolver.Current.GetByAlias(property.EditorAlias);
                    if (paramEditor == null)
                    {
                        //we&#39;ll just map this to a text box
                        paramEditor = ParameterEditorResolver.Current.GetByAlias(Constants.PropertyEditors.TextboxAlias);
                        LogHelper.Warn&lt;MacroModelMapper&gt;(&quot;Could not resolve a parameter editor with alias &quot; + property.EditorAlias + &quot;, a textbox will be rendered in it&#39;s place&quot;);
                    }

                    parameter.View = paramEditor.ValueEditor.View;
                    //set the config
                    parameter.Configuration = paramEditor.Configuration;

                });

        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[20,9,20,10,1],[22,13,23,77,1],[23,77,23,117,1],[23,117,24,65,1],[24,65,24,88,1],[24,88,25,61,1],[25,61,25,94,1],[25,94,25,110,0],[25,110,25,111,1],[25,61,25,111,1],[25,111,26,64,1],[26,64,26,83,1],[26,83,27,71,1],[27,71,27,90,1],[27,90,27,92,1],[22,13,27,92,1],[29,13,30,44,1],[30,44,30,104,0],[30,104,30,106,1],[29,13,30,106,1],[32,13,33,55,1],[33,55,33,74,1],[33,74,34,64,1],[34,64,34,83,1],[34,83,35,56,1],[35,56,35,75,1],[35,75,37,17,1],[37,17,37,18,0],[37,18,40,21,1],[40,21,40,104,0],[40,104,41,21,1],[41,21,41,45,0],[41,45,42,21,1],[42,21,42,22,0],[42,22,44,25,1],[44,25,44,122,0],[44,122,45,25,1],[45,25,45,180,0],[45,180,46,21,1],[46,21,46,22,0],[46,22,48,21,1],[48,21,48,67,0],[48,67,50,21,1],[50,21,50,73,0],[50,73,52,17,1],[52,17,52,18,0],[52,18,52,20,1],[32,13,52,20,1],[54,9,54,10,1]]);
    </script>
  </body>
</html>