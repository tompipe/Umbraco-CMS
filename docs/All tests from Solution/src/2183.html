<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Dynamics\QueryableExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using System.Linq.Expressions;
using System.Reflection;

namespace Umbraco.Core.Dynamics
{
    /// &lt;summary&gt;
    /// Extension methods for IQueryable
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// NOTE: Ordering code taken from: http://stackoverflow.com/questions/41244/dynamic-linq-orderby-on-ienumerablet
    /// 
    /// ANOTHER NOTE: We have a bastardized version of Dynamic Linq existing at Umbraco.Web.Dynamics however it&#39;s been hacked so not
    /// sure we can use it for anything other than DynamicNode.
    /// &lt;/remarks&gt;
    internal static class QueryableExtensions
    {
        public static IOrderedQueryable&lt;T&gt; OrderBy&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)
        {
            return ApplyOrder&lt;T&gt;(source, property, &quot;OrderBy&quot;);
        }
        public static IOrderedQueryable&lt;T&gt; OrderByDescending&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)
        {
            return ApplyOrder&lt;T&gt;(source, property, &quot;OrderByDescending&quot;);
        }
        public static IOrderedQueryable&lt;T&gt; ThenBy&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)
        {
            return ApplyOrder&lt;T&gt;(source, property, &quot;ThenBy&quot;);
        }
        public static IOrderedQueryable&lt;T&gt; ThenByDescending&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)
        {
            return ApplyOrder&lt;T&gt;(source, property, &quot;ThenByDescending&quot;);
        }
        static IOrderedQueryable&lt;T&gt; ApplyOrder&lt;T&gt;(IQueryable&lt;T&gt; source, string property, string methodName)
        {
            string[] props = property.Split(&#39;.&#39;);
            Type type = typeof(T);
            ParameterExpression arg = Expression.Parameter(type, &quot;x&quot;);
            Expression expr = arg;
            foreach (string prop in props)
            {
                // use reflection (not ComponentModel) to mirror LINQ
                PropertyInfo pi = type.GetProperty(prop, BindingFlags.IgnoreCase | BindingFlags.Public | BindingFlags.Instance);
                expr = Expression.Property(expr, pi);
                type = pi.PropertyType;
            }
            Type delegateType = typeof(Func&lt;,&gt;).MakeGenericType(typeof(T), type);
            LambdaExpression lambda = Expression.Lambda(delegateType, expr, arg);

            object result = typeof(Queryable).GetMethods().Single(
                method =&gt; method.Name == methodName
                          &amp;&amp; method.IsGenericMethodDefinition
                          &amp;&amp; method.GetGenericArguments().Length == 2
                          &amp;&amp; method.GetParameters().Length == 2)
                                             .MakeGenericMethod(typeof(T), type)
                                             .Invoke(null, new object[] { source, lambda });
            return (IOrderedQueryable&lt;T&gt;)result;
        }


    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[20,9,20,10,1],[21,13,21,63,1],[22,9,22,10,1],[24,9,24,10,0],[25,13,25,73,0],[26,9,26,10,0],[28,9,28,10,0],[29,13,29,62,0],[30,9,30,10,0],[32,9,32,10,0],[33,13,33,72,0],[34,9,34,10,0],[36,9,36,10,1],[37,13,37,50,1],[38,13,38,35,1],[39,13,39,71,1],[40,13,40,35,1],[41,13,41,20,1],[41,22,41,33,1],[41,34,41,36,1],[41,37,41,42,1],[42,13,42,14,1],[44,17,44,129,1],[45,17,45,54,1],[46,17,46,40,1],[47,13,47,14,1],[48,13,48,82,1],[49,13,49,82,1],[51,13,52,27,1],[52,27,55,64,1],[55,64,57,93,1],[51,13,57,93,1],[58,13,58,49,1],[59,9,59,10,1]]);
    </script>
  </body>
</html>