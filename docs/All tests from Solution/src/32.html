<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\IO\PhysicalFileSystemTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using NUnit.Framework;
using Umbraco.Core.IO;


namespace Umbraco.Tests.IO
{
    [TestFixture, RequiresSTA]
    public class PhysicalFileSystemTests : AbstractFileSystemTests
    {
        public PhysicalFileSystemTests()
            : base(new PhysicalFileSystem(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, &quot;FileSysTests&quot;),
                &quot;/Media/&quot;))
        { }

        [SetUp]
        public void Setup()
        {
            
        }

        [TearDown]
        public void TearDown()
        {
            var path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, &quot;FileSysTests&quot;);
            if (Directory.Exists(path) == false) return;

            var files = Directory.GetFiles(path);
            foreach (var f in files)
            {
                File.Delete(f);
            }
            Directory.Delete(path, true);
        }

        protected override string ConstructUrl(string path)
        {
            return &quot;/Media/&quot; + path;
        }

        [Test]
        public void GetFullPathTest()
        {
            // outside of tests, one initializes the PhysicalFileSystem with eg ~/Dir
            // and then, rootPath = /path/to/Dir and rootUrl = /Dir/
            // here we initialize the PhysicalFileSystem with
            // rootPath = /path/to/FileSysTests
            // rootUrl = /Media/

            var basePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, &quot;FileSysTests&quot;);

            // ensure that GetFullPath
            // - does return the proper full path
            // - does properly normalize separators
            // - does throw on invalid paths

            var path = _fileSystem.GetFullPath(&quot;foo.tmp&quot;);
            Assert.AreEqual(Path.Combine(basePath, @&quot;foo.tmp&quot;), path);

            path = _fileSystem.GetFullPath(&quot;foo/bar.tmp&quot;);
            Assert.AreEqual(Path.Combine(basePath, @&quot;foo\bar.tmp&quot;), path);

            // that path is invalid as it would be outside the root directory
            Assert.Throws&lt;FileSecurityException&gt;(() =&gt; _fileSystem.GetFullPath(&quot;../../foo.tmp&quot;));
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[16,15,17,28,1],[18,9,18,10,1],[18,11,18,12,1],[22,9,22,10,1],[24,9,24,10,1],[28,9,28,10,1],[29,13,29,92,1],[30,13,30,49,1],[30,50,30,57,1],[32,13,32,50,1],[33,13,33,20,1],[33,22,33,27,1],[33,28,33,30,1],[33,31,33,36,1],[34,13,34,14,1],[35,17,35,32,1],[36,13,36,14,1],[37,13,37,42,1],[38,9,38,10,1],[41,9,41,10,1],[42,13,42,37,1],[43,9,43,10,1],[47,9,47,10,1],[54,13,54,96,1],[61,13,61,59,1],[62,13,62,71,1],[64,13,64,59,1],[65,13,65,75,1],[68,13,68,56,1],[68,56,68,96,1],[68,96,68,98,1],[68,13,68,98,1],[69,9,69,10,1]]);
    </script>
  </body>
</html>