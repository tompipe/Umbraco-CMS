<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\SystemUtilities.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Security;
using System.Web;

namespace Umbraco.Core
{
	/// &lt;summary&gt;
	/// Static helper methods for returning information about the current System
	/// &lt;/summary&gt;
	public static class SystemUtilities
	{
	    private static bool _knowTrustLevel;
	    private static AspNetHostingPermissionLevel _trustLevel;

		/// &lt;summary&gt;
		/// Get the current trust level of the hosted application
		/// &lt;/summary&gt;
		/// &lt;returns&gt;&lt;/returns&gt;
		public static AspNetHostingPermissionLevel GetCurrentTrustLevel()
		{
		    if (_knowTrustLevel) return _trustLevel;

			foreach (var trustLevel in new[] {
			                                 	AspNetHostingPermissionLevel.Unrestricted,
			                                 	AspNetHostingPermissionLevel.High,
			                                 	AspNetHostingPermissionLevel.Medium,
			                                 	AspNetHostingPermissionLevel.Low,
			                                 	AspNetHostingPermissionLevel.Minimal })
			{
				try
				{
					new AspNetHostingPermission(trustLevel).Demand();
				}
				catch (SecurityException)
				{
					continue;
				}

                _trustLevel = trustLevel;
			    _knowTrustLevel = true;
			    return _trustLevel;
			}

			_trustLevel = AspNetHostingPermissionLevel.None;
            _knowTrustLevel = true;
            return _trustLevel;
        }
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[19,3,19,4,1],[20,7,20,27,1],[20,28,20,47,0],[22,4,22,11,1],[22,13,22,27,1],[22,28,22,30,1],[22,31,27,76,1],[28,4,28,5,1],[30,5,30,6,1],[31,6,31,55,1],[32,5,32,6,1],[33,5,33,30,0],[34,5,34,6,0],[35,6,35,15,0],[38,17,38,42,1],[39,8,39,31,1],[40,8,40,27,1],[43,4,43,52,0],[44,13,44,36,0],[45,13,45,32,0],[46,9,46,10,1]]);
    </script>
  </body>
</html>