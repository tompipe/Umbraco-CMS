<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\create\script.ascx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using Umbraco.Core;
using Umbraco.Core.Configuration;
using Umbraco.Web.UI;
using umbraco.cms.helpers;
using umbraco.BasePages;
using Umbraco.Core.IO;

namespace umbraco.presentation.umbraco.create
{
	public partial class script : System.Web.UI.UserControl
	{
        protected override void OnLoad(EventArgs e)
        {
            base.OnLoad(e);
			sbmt.Text = ui.Text(&quot;create&quot;);

            // Enable new item in folders to place items in that folder.
            if (Request[&quot;nodeType&quot;] == &quot;scriptsFolder&quot;)
                rename.Text = Request[&quot;nodeId&quot;].EnsureEndsWith(&#39;/&#39;);
		}

		protected void SubmitClick(object sender, System.EventArgs e)
		{
            int createFolder = 0;
            if (scriptType.SelectedValue == &quot;&quot;)
            {
                createFolder = 1;
                ContainsValidator.Enabled = true;
                Page.Validate();
            }

			if (Page.IsValid)
			{
                string returnUrl = LegacyDialogHandler.Create(
                    new HttpContextWrapper(Context),
                    BasePage.Current.getUser(),
					helper.Request(&quot;nodeType&quot;),
					createFolder,
                    rename.Text + &#39;\u00A4&#39; + scriptType.SelectedValue);

				BasePage.Current.ClientTools
                    .ChangeContentFrameUrl(returnUrl)
                    .ReloadActionNode(false, true)
					.CloseModalWindow();

			}
		}

		override protected void OnInit(EventArgs e)
		{
			base.OnInit(e);

		    ContainsValidator.Enabled = false;

            string[] fileTypes = UmbracoConfig.For.UmbracoSettings().Content.ScriptFileTypes.ToArray();

            scriptType.Items.Add(new ListItem(ui.Text(&quot;folder&quot;), &quot;&quot;));
            scriptType.Items.FindByText(ui.Text(&quot;folder&quot;)).Selected = true;

            foreach (string str in fileTypes)
            {
                scriptType.Items.Add(new ListItem(&quot;.&quot; + str + &quot; file&quot;, str));
            }
		}

        /// &lt;summary&gt;
        /// rename control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::System.Web.UI.WebControls.TextBox rename;

        /// &lt;summary&gt;
        /// RequiredFieldValidator1 control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::System.Web.UI.WebControls.RequiredFieldValidator RequiredFieldValidator1;
        protected global::System.Web.UI.WebControls.RegularExpressionValidator EndsWithValidator;
	    protected global::System.Web.UI.WebControls.RegularExpressionValidator ContainsValidator;

        /// &lt;summary&gt;
        /// scriptType control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::System.Web.UI.WebControls.ListBox scriptType;

        /// &lt;summary&gt;
        /// CreateMacroCheckBox control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::System.Web.UI.WebControls.CheckBox CreateMacroCheckBox;

        /// &lt;summary&gt;
        /// sbmt control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::System.Web.UI.WebControls.Button sbmt;

	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[24,9,24,10,0],[25,13,25,28,0],[26,4,26,34,0],[29,13,29,56,0],[30,17,30,69,0],[31,3,31,4,0],[34,3,34,4,0],[35,13,35,34,0],[36,13,36,48,0],[37,13,37,14,0],[38,17,38,34,0],[39,17,39,50,0],[40,17,40,33,0],[41,13,41,14,0],[43,4,43,21,0],[44,4,44,5,0],[45,17,50,72,0],[52,5,55,26,0],[57,4,57,5,0],[58,3,58,4,0],[61,3,61,4,0],[62,4,62,19,0],[64,7,64,41,0],[66,13,66,104,0],[68,13,68,71,0],[69,13,69,76,0],[71,13,71,20,0],[71,22,71,32,0],[71,33,71,35,0],[71,36,71,45,0],[72,13,72,14,0],[73,17,73,78,0],[74,13,74,14,0],[75,3,75,4,0]]);
    </script>
  </body>
</html>