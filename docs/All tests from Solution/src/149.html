<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Integration\InstallPackage.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.IO;
using System.Linq;
using System.Threading;
using NUnit.Framework;
using OpenQA.Selenium;
using OpenQA.Selenium.Interactions;
using Umbraco.Core;
using Umbraco.Tests.TestHelpers;

namespace Umbraco.Tests.Integration
{
    [Ignore(&quot;We don&#39;t want to run Selenium tests on TeamCity&quot;)]
    [TestFixture]
    public class InstallPackage : BaseSeleniumTest
    {
        [SetUp]
        public override void Initialize()
        {
            base.Initialize();
        }
        
        [TearDown]
        public void TearDown()
        {
            base.TearDown();
        }

        [Test]
        public void Install_Courier_Package()
        {
            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/login.aspx?redir=&quot;);
            Driver.FindElement(By.Id(&quot;lname&quot;)).Clear();
            Driver.FindElement(By.Id(&quot;lname&quot;)).SendKeys(&quot;admin&quot;);
            Driver.FindElement(By.Id(&quot;passw&quot;)).Clear();
            Driver.FindElement(By.Id(&quot;passw&quot;)).SendKeys(&quot;test&quot;);
            Driver.FindElement(By.Id(&quot;Button1&quot;)).Click();
            Thread.Sleep(1000);

            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/umbraco.aspx#developer&quot;);
            Thread.Sleep(2000);

            var builder = new Actions(Driver);
            var packagesNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;init&#39;][3]&quot;));
            builder.MoveToElement(packagesNode).DoubleClick().Build().Perform();
            Thread.Sleep(1000);

            var installPackageNode = Driver.FindElement(By.XPath(&quot;/html/body/div[2]/div/div/div[2]/div/div/div/div/ul/li/ul/li[3]/ul/li[4]/a/div&quot;));
            builder.MoveToElement(installPackageNode).Click().Build().Perform();
            Thread.Sleep(1000);

            var rightFrame = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;right&#39;]&quot;));
            Driver.SwitchTo().Frame(rightFrame);

            const string packagesDir = @&quot;C:\\Downloads\\Packages\\&quot;;
            var file = new DirectoryInfo(packagesDir).GetFiles().First(f =&gt; f.Name.ToLowerInvariant().StartsWith(&quot;Courier&quot;.ToLowerInvariant()));
            
            Driver.FindElement(By.Id(&quot;cb&quot;)).Click();
            Driver.FindElement(By.XPath(&quot;//input[@type=&#39;file&#39;]&quot;)).SendKeys(file.FullName);
            Driver.FindElement(By.Id(&quot;body_ButtonLoadPackage&quot;)).Click();
            Driver.FindElement(By.Id(&quot;body_acceptCheckbox&quot;)).Click();
            Driver.FindElement(By.Id(&quot;body_ButtonInstall&quot;)).Click();
            Thread.Sleep(1000);

            var successPanel = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;body_Panel1_content&#39;]&quot;));
            Assert.IsNotNull(successPanel);
        }

        [Test]
        public void Install_Contour_Package()
        {
            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/login.aspx?redir=&quot;);
            Driver.FindElement(By.Id(&quot;lname&quot;)).Clear();
            Driver.FindElement(By.Id(&quot;lname&quot;)).SendKeys(&quot;admin&quot;);
            Driver.FindElement(By.Id(&quot;passw&quot;)).Clear();
            Driver.FindElement(By.Id(&quot;passw&quot;)).SendKeys(&quot;test&quot;);
            Driver.FindElement(By.Id(&quot;Button1&quot;)).Click();
            Thread.Sleep(1000);

            Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/umbraco.aspx#developer&quot;);
            Thread.Sleep(2000);

            var builder = new Actions(Driver);
            var packagesNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;init&#39;][3]&quot;));
            builder.MoveToElement(packagesNode).DoubleClick().Build().Perform();
            Thread.Sleep(1000);

            var installPackageNode = Driver.FindElement(By.XPath(&quot;/html/body/div[2]/div/div/div[2]/div/div/div/div/ul/li/ul/li[3]/ul/li[4]/a/div&quot;));
            builder.MoveToElement(installPackageNode).Click().Build().Perform();
            Thread.Sleep(1000);

            var rightFrame = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;right&#39;]&quot;));
            Driver.SwitchTo().Frame(rightFrame);

            const string packagesDir = @&quot;C:\\Downloads\\Packages\\&quot;;
            var file = new DirectoryInfo(packagesDir).GetFiles().First(f =&gt; f.Name.ToLowerInvariant().StartsWith(&quot;UmbracoContour&quot;.ToLowerInvariant()));

            Driver.FindElement(By.Id(&quot;cb&quot;)).Click();
            Driver.FindElement(By.XPath(&quot;//input[@type=&#39;file&#39;]&quot;)).SendKeys(file.FullName);
            Driver.FindElement(By.Id(&quot;body_ButtonLoadPackage&quot;)).Click();
            Driver.FindElement(By.Id(&quot;body_acceptCheckbox&quot;)).Click();
            Driver.FindElement(By.Id(&quot;body_ButtonInstall&quot;)).Click();
            Thread.Sleep(1000);

            var successPanel = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;body_Panel1_content&#39;]&quot;));
            Assert.IsNotNull(successPanel);
        }

        //[Test]
        //public void Install_CMS_Import_Package()
        //{
        //    Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/login.aspx?redir=&quot;);
        //    Driver.FindElement(By.Id(&quot;lname&quot;)).Clear();
        //    Driver.FindElement(By.Id(&quot;lname&quot;)).SendKeys(&quot;admin&quot;);
        //    Driver.FindElement(By.Id(&quot;passw&quot;)).Clear();
        //    Driver.FindElement(By.Id(&quot;passw&quot;)).SendKeys(&quot;test&quot;);
        //    Driver.FindElement(By.Id(&quot;Button1&quot;)).Click();
        //    Thread.Sleep(1000);

        //    Driver.Navigate().GoToUrl(BaseUrl + &quot;/umbraco/umbraco.aspx#developer&quot;);
        //    Thread.Sleep(2000);

        //    var builder = new Actions(Driver);
        //    var packagesNode = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;init&#39;][3]&quot;));
        //    builder.MoveToElement(packagesNode).DoubleClick().Build().Perform();
        //    Thread.Sleep(1000);

        //    var installPackageNode = Driver.FindElement(By.XPath(&quot;/html/body/div[2]/div/div/div[2]/div/div/div/div/ul/li/ul/li[3]/ul/li[4]/a/div&quot;));
        //    builder.MoveToElement(installPackageNode).Click().Build().Perform();
        //    Thread.Sleep(1000);

        //    var rightFrame = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;right&#39;]&quot;));
        //    Driver.SwitchTo().Frame(rightFrame);

        //    Driver.FindElement(By.Id(&quot;cb&quot;)).Click();
        //    Driver.FindElement(By.Id(&quot;body_file1&quot;)).SendKeys(&quot;C:\\Downloads\\Packages\\CMSImport-2.3.1.zip&quot;);
        //    Driver.FindElement(By.Id(&quot;body_ButtonLoadPackage&quot;)).Click();
        //    Driver.FindElement(By.Id(&quot;body_acceptCheckbox&quot;)).Click();
        //    Driver.FindElement(By.Id(&quot;body_ButtonInstall&quot;)).Click();
        //    Thread.Sleep(1000);

        //    var successPanel = Driver.FindElement(By.XPath(&quot;//*[@id=&#39;body_Panel1_content&#39;]&quot;));
        //    Assert.IsNotNull(successPanel);
        //}
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,10,0],[19,13,19,31,0],[20,9,20,10,0],[24,9,24,10,0],[25,13,25,29,0],[26,9,26,10,0],[30,9,30,10,0],[31,13,31,79,0],[32,13,32,56,0],[33,13,33,66,0],[34,13,34,56,0],[35,13,35,65,0],[36,13,36,58,0],[37,13,37,32,0],[39,13,39,84,0],[40,13,40,32,0],[42,13,42,47,0],[43,13,43,83,0],[44,13,44,81,0],[45,13,45,32,0],[47,13,47,149,0],[48,13,48,81,0],[49,13,49,32,0],[51,13,51,79,0],[52,13,52,49,0],[55,13,55,77,0],[55,77,55,143,0],[55,143,55,145,0],[55,13,55,145,0],[57,13,57,53,0],[58,13,58,91,0],[59,13,59,73,0],[60,13,60,70,0],[61,13,61,69,0],[62,13,62,32,0],[64,13,64,95,0],[65,13,65,44,0],[66,9,66,10,0],[70,9,70,10,0],[71,13,71,79,0],[72,13,72,56,0],[73,13,73,66,0],[74,13,74,56,0],[75,13,75,65,0],[76,13,76,58,0],[77,13,77,32,0],[79,13,79,84,0],[80,13,80,32,0],[82,13,82,47,0],[83,13,83,83,0],[84,13,84,81,0],[85,13,85,32,0],[87,13,87,149,0],[88,13,88,81,0],[89,13,89,32,0],[91,13,91,79,0],[92,13,92,49,0],[95,13,95,77,0],[95,77,95,150,0],[95,150,95,152,0],[95,13,95,152,0],[97,13,97,53,0],[98,13,98,91,0],[99,13,99,73,0],[100,13,100,70,0],[101,13,101,69,0],[102,13,102,32,0],[104,13,104,95,0],[105,13,105,44,0],[106,9,106,10,0]]);
    </script>
  </body>
</html>