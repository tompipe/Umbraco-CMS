<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Models\Membership\UmbracoMembershipMember.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Web.Security;
using Umbraco.Core.Configuration;

namespace Umbraco.Core.Models.Membership
{

    internal class UmbracoMembershipMember : MembershipUser
    {
        private readonly IMembershipUser _member;
        private readonly string _userName;
        private readonly object _providerUserKey;
        private readonly string _passwordQuestion;
        private readonly bool _isLockedOut;
        private readonly DateTime _lastLockoutDate;
        private readonly DateTime _creationDate;
        private DateTime _lastLoginDate;
        private readonly DateTime _lastPasswordChangedDate;
        private readonly string _providerName;
        private string _email;
        private string _comment;
        private bool _isApproved;
        private DateTime _lastActivityDate;

        //NOTE: We are only overriding the properties that matter, we don&#39;t override things like IsOnline since that is handled with the sub-class and the membership providers.

        //NOTE: We are not calling the base constructor which will validate that a provider with the specified name exists which causes issues with unit tests. The ctor
        // validation for that doesn&#39;t need to be there anyways (have checked the source).
        public UmbracoMembershipMember(IMembershipUser member, string providerName, bool providerKeyAsGuid = false)
        {
            _member = member;
            //NOTE: We are copying the values here so that everything is consistent with how the underlying built-in ASP.Net membership user
            // handles data! We don&#39;t want to do anything differently there but since we cannot use their ctor we&#39;ll need to handle this logic ourselves.
            if (member.Username != null)
                _userName = member.Username.Trim();
            if (member.Email != null)
                _email = member.Email.Trim();
            if (member.PasswordQuestion != null)
                _passwordQuestion = member.PasswordQuestion.Trim();
            _providerName = providerName;
            _providerUserKey = providerKeyAsGuid ? member.ProviderUserKey : member.Id;
            _comment = member.Comments;
            _isApproved = member.IsApproved;
            _isLockedOut = member.IsLockedOut;
            _creationDate = member.CreateDate.ToUniversalTime();
            _lastLoginDate = member.LastLoginDate.ToUniversalTime();
            //TODO: We currently don&#39;t really have any place to store this data!!
            _lastActivityDate = member.LastLoginDate.ToUniversalTime();
            _lastPasswordChangedDate = member.LastPasswordChangeDate.ToUniversalTime();
            _lastLockoutDate = member.LastLockoutDate.ToUniversalTime();
        }
        
        internal IMembershipUser Member
        {
            get { return _member; }
        }

        public override string UserName
        {
            get { return _userName; }
        }

        public override object ProviderUserKey
        {
            get { return _providerUserKey; }
        }

        public override string Email
        {
            get { return _email; }
            set { _email = value; }
        }

        public override string PasswordQuestion
        {
            get { return _passwordQuestion; }
        }

        public override string Comment
        {
            get { return _comment; }
            set { _comment = value; }
        }

        public override bool IsApproved
        {
            get { return _isApproved; }
            set { _isApproved = value; }
        }

        public override bool IsLockedOut
        {
            get { return _isLockedOut; }
        }

        public override DateTime LastLockoutDate
        {
            get { return _lastLockoutDate; }
        }

        public override DateTime CreationDate
        {
            get { return _creationDate; }
        }

        public override DateTime LastLoginDate
        {
            get { return _lastLoginDate; }
            set { _lastLoginDate = value; }
        }

        public override DateTime LastActivityDate
        {
            get { return _lastActivityDate; }
            set { _lastActivityDate = value; }
        }

        public override DateTime LastPasswordChangedDate
        {
            get { return _lastPasswordChangedDate; }
        }

        public override string ProviderName
        {
            get { return _providerName; }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[29,9,29,116,1],[30,9,30,10,1],[31,13,31,30,1],[34,13,34,41,1],[35,17,35,52,1],[36,13,36,38,1],[37,17,37,46,1],[38,13,38,49,1],[39,17,39,68,1],[40,13,40,42,1],[41,13,41,87,1],[42,13,42,40,1],[43,13,43,45,1],[44,13,44,47,1],[45,13,45,65,1],[46,13,46,69,1],[48,13,48,72,1],[49,13,49,88,1],[50,13,50,73,1],[51,9,51,10,1],[55,17,55,18,0],[55,19,55,34,0],[55,35,55,36,0],[60,17,60,18,0],[60,19,60,36,0],[60,37,60,38,0],[65,17,65,18,0],[65,19,65,43,0],[65,44,65,45,0],[70,17,70,18,0],[70,19,70,33,0],[70,34,70,35,0],[71,17,71,18,0],[71,19,71,34,0],[71,35,71,36,0],[76,17,76,18,0],[76,19,76,44,0],[76,45,76,46,0],[81,17,81,18,0],[81,19,81,35,0],[81,36,81,37,0],[82,17,82,18,0],[82,19,82,36,0],[82,37,82,38,0],[87,17,87,18,0],[87,19,87,38,0],[87,39,87,40,0],[88,17,88,18,0],[88,19,88,39,0],[88,40,88,41,0],[93,17,93,18,0],[93,19,93,39,0],[93,40,93,41,0],[98,17,98,18,0],[98,19,98,43,0],[98,44,98,45,0],[103,17,103,18,0],[103,19,103,40,0],[103,41,103,42,0],[108,17,108,18,0],[108,19,108,41,0],[108,42,108,43,0],[109,17,109,18,0],[109,19,109,42,0],[109,43,109,44,0],[114,17,114,18,0],[114,19,114,44,0],[114,45,114,46,0],[115,17,115,18,0],[115,19,115,45,0],[115,46,115,47,0],[120,17,120,18,0],[120,19,120,51,0],[120,52,120,53,0],[125,17,125,18,0],[125,19,125,40,0],[125,41,125,42,0]]);
    </script>
  </body>
</html>