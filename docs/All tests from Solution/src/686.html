<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\Mvc\ProfilingViewEngine.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Web.Mvc;

namespace Umbraco.Core.Profiling
{
	public class ProfilingViewEngine: IViewEngine
	{
		internal readonly IViewEngine Inner;
		private readonly string _name;

		public ProfilingViewEngine(IViewEngine inner)
		{
			Inner = inner;
			_name = inner.GetType().Name;
		}

		public ViewEngineResult FindPartialView(ControllerContext controllerContext, string partialViewName, bool useCache)
		{
			using (ProfilerResolver.Current.Profiler.Step(string.Format(&quot;{0}.FindPartialView, {1}, {2}&quot;, _name, partialViewName, useCache)))
			{
				return WrapResult(Inner.FindPartialView(controllerContext, partialViewName, useCache));
			}
		}

		public ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
		{
			using (ProfilerResolver.Current.Profiler.Step(string.Format(&quot;{0}.FindView, {1}, {2}, {3}&quot;, _name, viewName, masterName, useCache)))
			{
				return WrapResult(Inner.FindView(controllerContext, viewName, masterName, useCache));
			}
		}

		private static ViewEngineResult WrapResult(ViewEngineResult innerResult)
		{
			var profiledResult = innerResult.View != null ?
				                     new ViewEngineResult(new ProfilingView(innerResult.View), innerResult.ViewEngine) :
				                     new ViewEngineResult(innerResult.SearchedLocations);
			return profiledResult;
		}

		public void ReleaseView(ControllerContext controllerContext, IView view)
		{
			using (ProfilerResolver.Current.Profiler.Step(string.Format(&quot;{0}.ReleaseView, {1}&quot;, _name, view.GetType().Name)))
			{
				Inner.ReleaseView(controllerContext, view);
			}
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[10,3,10,48,1],[11,3,11,4,1],[12,4,12,18,1],[13,4,13,33,1],[14,3,14,4,1],[17,3,17,4,0],[18,4,18,132,0],[19,4,19,5,0],[20,5,20,92,0],[22,3,22,4,0],[25,3,25,4,0],[26,4,26,135,0],[27,4,27,5,0],[28,5,28,90,0],[30,3,30,4,0],[33,3,33,4,0],[34,4,36,78,0],[37,4,37,26,0],[38,3,38,4,0],[41,3,41,4,0],[42,4,42,117,0],[43,4,43,5,0],[44,5,44,48,0],[45,4,45,5,0],[46,3,46,4,0]]);
    </script>
  </body>
</html>