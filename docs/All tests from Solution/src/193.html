<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Tests\Resolvers\MacroFieldEditorsResolverTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using System.Web.UI;
using NUnit.Framework;
using Umbraco.Core;
using Umbraco.Core.Macros;
using Umbraco.Core.ObjectResolution;
using umbraco.interfaces;

namespace Umbraco.Tests.Resolvers
{
	[TestFixture]
    public class MacroFieldEditorsResolverTests : ResolverBaseTest
	{
		
		[TearDown]
		public void TearDown()
		{
            MacroFieldEditorsResolver.Reset();
		}

        // NOTE
        // ManyResolverTests ensure that we&#39;ll get our actions back and MacroFieldEditorsResolver works,
        // so all we&#39;re testing here is that plugin manager _does_ find our macro control types
        // which should be ensured by PlugingManagerTests anyway, so this is useless?
        [Test]
		public void FindAllTypes()
		{
            MacroFieldEditorsResolver.Current = new MacroFieldEditorsResolver(
                new ActivatorServiceProvider(), ProfilingLogger.Logger,
                () =&gt; PluginManager.ResolveMacroRenderings());

            Resolution.Freeze();
            
            var types = MacroFieldEditorsResolver.Current.MacroControlTypes;
			Assert.AreEqual(2, types.Count());

            // order is unspecified, but both must be there
            bool hasType1 = types.ElementAt(0) == typeof(ControlMacroRendering) || types.ElementAt(1) == typeof(ControlMacroRendering);
            bool hasType2 = types.ElementAt(0) == typeof(NonControlMacroRendering) || types.ElementAt(1) == typeof(NonControlMacroRendering);
            Assert.IsTrue(hasType1);
            Assert.IsTrue(hasType2);
        }

		#region Classes for tests

		public class ControlMacroRendering : Control, IMacroGuiRendering
		{
			public string Value
			{
				get { throw new NotImplementedException(); }
				set { throw new NotImplementedException(); }
			}

			public bool ShowCaption
			{
				get { throw new NotImplementedException(); }
			}
		}

		public class NonControlMacroRendering : IMacroGuiRendering
		{
			public string Value
			{
				get { throw new NotImplementedException(); }
				set { throw new NotImplementedException(); }
			}

			public bool ShowCaption
			{
				get { throw new NotImplementedException(); }
			}
		}

        #endregion
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,3,18,4,1],[19,13,19,47,1],[20,3,20,4,1],[28,3,28,4,1],[29,13,31,23,1],[31,23,31,61,1],[31,61,31,63,1],[29,13,31,63,1],[33,13,33,33,1],[35,13,35,77,1],[36,4,36,38,1],[39,13,39,136,1],[40,13,40,142,1],[41,13,41,37,1],[42,13,42,37,1],[43,9,43,10,1],[51,9,51,10,0],[51,11,51,47,0],[52,9,52,10,0],[52,11,52,47,0],[57,9,57,10,0],[57,11,57,47,0],[65,9,65,10,0],[65,11,65,47,0],[66,9,66,10,0],[66,11,66,47,0],[71,9,71,10,0],[71,11,71,47,0]]);
    </script>
  </body>
</html>