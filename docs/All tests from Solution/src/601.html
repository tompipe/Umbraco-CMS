<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Web\umbraco.presentation\umbraco\dialogs\Preview.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Globalization;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using Umbraco.Web;
using umbraco.cms.businesslogic.web;
using umbraco.presentation.preview;
using umbraco.BusinessLogic;

namespace umbraco.presentation.dialogs
{
    public partial class Preview : BasePages.UmbracoEnsuredPage
    {
        public Preview()
        {
            CurrentApp = DefaultApps.content.ToString();
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            var d = new Document(Request.GetItemAs&lt;int&gt;(&quot;id&quot;));
            var pc = new PreviewContent(UmbracoUser, Guid.NewGuid(), false);
            pc.PrepareDocument(UmbracoUser, d, true);
            pc.SavePreviewSet();
            docLit.Text = d.Text;
            changeSetUrl.Text = pc.PreviewsetPath;
            pc.ActivatePreviewCookie();
            Response.Redirect(&quot;../../&quot; + d.Id.ToString(CultureInfo.InvariantCulture) + &quot;.aspx&quot;, true);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[23,9,23,25,0],[24,9,24,10,0],[25,13,25,57,0],[26,9,26,10,0],[29,9,29,10,0],[30,13,30,64,0],[31,13,31,77,0],[32,13,32,54,0],[33,13,33,33,0],[34,13,34,34,0],[35,13,35,51,0],[36,13,36,40,0],[37,13,37,103,0],[38,9,38,10,0]]);
    </script>
  </body>
</html>