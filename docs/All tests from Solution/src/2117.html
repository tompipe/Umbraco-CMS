<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Manifest\ManifestBuilder.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.IO;
using Umbraco.Core.Cache;
using Umbraco.Core.IO;
using Umbraco.Core.PropertyEditors;

namespace Umbraco.Core.Manifest
{
    /// &lt;summary&gt;
    /// This reads in the manifests and stores some definitions in memory so we can look them on the server side
    /// &lt;/summary&gt;
    internal class ManifestBuilder
    {
        private readonly IRuntimeCacheProvider _cache;
        private readonly ManifestParser _parser;

        public ManifestBuilder(IRuntimeCacheProvider cache, ManifestParser parser)
        {
            _cache = cache;
            _parser = parser;
        }

        private const string GridEditorsKey = &quot;grideditors&quot;;
        private const string PropertyEditorsKey = &quot;propertyeditors&quot;;
        private const string ParameterEditorsKey = &quot;parametereditors&quot;;

        /// &lt;summary&gt;
        /// Returns all grid editors found in the manfifests
        /// &lt;/summary&gt;
        internal IEnumerable&lt;GridEditor&gt; GridEditors
        {
            get
            {
                return _cache.GetCacheItem&lt;IEnumerable&lt;GridEditor&gt;&gt;(
                    typeof (ManifestBuilder) + GridEditorsKey,
                    () =&gt;
                    {
                        var editors = new List&lt;GridEditor&gt;();
                        foreach (var manifest in _parser.GetManifests())
                        {
                            if (manifest.GridEditors != null)
                            {
                                editors.AddRange(ManifestParser.GetGridEditors(manifest.GridEditors));
                            }

                        }
                        return editors;
                    }, new TimeSpan(0, 10, 0));
            }
        }

        /// &lt;summary&gt;
        /// Returns all property editors found in the manfifests
        /// &lt;/summary&gt;
        internal IEnumerable&lt;PropertyEditor&gt; PropertyEditors
        {
            get
            {
                return _cache.GetCacheItem&lt;IEnumerable&lt;PropertyEditor&gt;&gt;(
                    typeof(ManifestBuilder) + PropertyEditorsKey,
                    () =&gt;
                    {
                        var editors = new List&lt;PropertyEditor&gt;();
                        foreach (var manifest in _parser.GetManifests())
                        {
                            if (manifest.PropertyEditors != null)
                            {
                                editors.AddRange(ManifestParser.GetPropertyEditors(manifest.PropertyEditors));
                            }

                        }
                        return editors;
                    }, new TimeSpan(0, 10, 0));
            }
        }

        /// &lt;summary&gt;
        /// Returns all parameter editors found in the manfifests and all property editors that are flagged to be parameter editors
        /// &lt;/summary&gt;
        internal IEnumerable&lt;ParameterEditor&gt; ParameterEditors
        {
            get
            {
                return _cache.GetCacheItem&lt;IEnumerable&lt;ParameterEditor&gt;&gt;(
                    typeof (ManifestBuilder) + ParameterEditorsKey,
                    () =&gt;
                    {
                        var editors = new List&lt;ParameterEditor&gt;();
                        foreach (var manifest in _parser.GetManifests())
                        {
                            if (manifest.ParameterEditors != null)
                            {
                                editors.AddRange(ManifestParser.GetParameterEditors(manifest.ParameterEditors));
                            }
                        }
                        return editors;
                    }, new TimeSpan(0, 10, 0));
            }
        } 
        
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[19,9,19,83,1],[20,9,20,10,1],[21,13,21,28,1],[22,13,22,30,1],[23,9,23,10,1],[35,13,35,14,0],[36,17,39,21,0],[39,21,39,22,0],[39,22,40,25,0],[40,25,40,62,0],[40,62,41,25,0],[41,25,41,32,0],[41,32,41,34,0],[41,34,41,46,0],[41,46,41,47,0],[41,47,41,49,0],[41,49,41,50,0],[41,50,41,72,0],[41,72,42,25,0],[42,25,42,26,0],[42,26,43,29,0],[43,29,43,62,0],[43,62,44,29,0],[44,29,44,30,0],[44,30,45,33,0],[45,33,45,103,0],[45,103,46,29,0],[46,29,46,30,0],[46,30,48,25,0],[48,25,48,26,0],[48,26,49,25,0],[49,25,49,40,0],[49,40,50,21,0],[50,21,50,22,0],[50,22,50,48,0],[36,17,50,48,0],[51,13,51,14,0],[60,13,60,14,1],[61,17,64,21,1],[64,21,64,22,1],[64,22,65,25,1],[65,25,65,66,1],[65,66,66,25,1],[66,25,66,32,1],[66,32,66,34,1],[66,34,66,46,0],[66,46,66,47,1],[66,47,66,49,1],[66,49,66,50,1],[66,50,66,72,1],[66,72,67,25,1],[67,25,67,26,0],[67,26,68,29,1],[68,29,68,66,0],[68,66,69,29,1],[69,29,69,30,0],[69,30,70,33,1],[70,33,70,111,0],[70,111,71,29,1],[71,29,71,30,0],[71,30,73,25,1],[73,25,73,26,0],[73,26,74,25,1],[74,25,74,40,1],[74,40,75,21,1],[75,21,75,22,1],[75,22,75,48,1],[61,17,75,48,1],[76,13,76,14,1],[85,13,85,14,0],[86,17,89,21,0],[89,21,89,22,0],[89,22,90,25,0],[90,25,90,67,0],[90,67,91,25,0],[91,25,91,32,0],[91,32,91,34,0],[91,34,91,46,0],[91,46,91,47,0],[91,47,91,49,0],[91,49,91,50,0],[91,50,91,72,0],[91,72,92,25,0],[92,25,92,26,0],[92,26,93,29,0],[93,29,93,67,0],[93,67,94,29,0],[94,29,94,30,0],[94,30,95,33,0],[95,33,95,113,0],[95,113,96,29,0],[96,29,96,30,0],[96,30,97,25,0],[97,25,97,26,0],[97,26,98,25,0],[98,25,98,40,0],[98,40,99,21,0],[99,21,99,22,0],[99,22,99,48,0],[86,17,99,48,0],[100,13,100,14,0]]);
    </script>
  </body>
</html>