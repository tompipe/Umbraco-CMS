<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Persistence\Factories\PublicAccessEntryFactory.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Linq;
using Umbraco.Core.Models;
using Umbraco.Core.Models.Rdbms;

namespace Umbraco.Core.Persistence.Factories
{
    internal class PublicAccessEntryFactory
    {
        public PublicAccessEntry BuildEntity(AccessDto dto)
        {
            var entity = new PublicAccessEntry(dto.Id, dto.NodeId, dto.LoginNodeId, dto.NoAccessNodeId, 
                dto.Rules.Select(x =&gt; new PublicAccessRule(x.Id, x.AccessId)
                {
                    RuleValue = x.RuleValue,
                    RuleType = x.RuleType,
                    CreateDate = x.CreateDate,
                    UpdateDate = x.UpdateDate
                }))
            {
                CreateDate = dto.CreateDate,
                UpdateDate = dto.UpdateDate
            };

            //on initial construction we don&#39;t want to have dirty properties tracked
            // http://issues.umbraco.org/issue/U4-1946
            entity.ResetDirtyProperties(false);
            return entity;
        }

        public AccessDto BuildDto(PublicAccessEntry entity)
        {
            var dto = new AccessDto
            {
                Id = entity.Key,
                NoAccessNodeId = entity.NoAccessNodeId,
                LoginNodeId = entity.LoginNodeId,
                NodeId = entity.ProtectedNodeId,
                CreateDate = entity.CreateDate,
                UpdateDate = entity.UpdateDate,
                Rules = entity.Rules.Select(x =&gt; new AccessRuleDto
                {
                    AccessId = x.AccessEntryId,
                    Id = x.Key,
                    RuleValue = x.RuleValue,
                    RuleType = x.RuleType,
                    CreateDate = x.CreateDate,
                    UpdateDate = x.UpdateDate
                }).ToList()
            };

            return dto;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[11,9,11,10,1],[12,13,13,39,1],[13,39,19,18,1],[19,18,23,15,1],[12,13,23,15,1],[27,13,27,48,1],[28,13,28,27,1],[29,9,29,10,1],[32,9,32,10,1],[33,13,41,50,1],[41,50,49,18,1],[49,18,50,15,1],[33,13,50,15,1],[52,13,52,24,1],[53,9,53,10,1]]);
    </script>
  </body>
</html>