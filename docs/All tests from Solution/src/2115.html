<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\Models\Identity\BackOfficeIdentityUser.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.Security.Claims;
using System.Threading.Tasks;
using Microsoft.AspNet.Identity;
using Umbraco.Core.Security;

namespace Umbraco.Core.Models.Identity
{
    public class BackOfficeIdentityUser : IdentityUser&lt;int, IIdentityUserLogin, IdentityUserRole&lt;string&gt;, IdentityUserClaim&lt;int&gt;&gt;
    {

        public BackOfficeIdentityUser()
        {
            StartMediaId = -1;
            StartContentId = -1;
            Culture = Configuration.GlobalSettings.DefaultUILanguage;
        }

        public virtual async Task&lt;ClaimsIdentity&gt; GenerateUserIdentityAsync(BackOfficeUserManager&lt;BackOfficeIdentityUser&gt; manager)
        {
            // NOTE the authenticationType must match the umbraco one
            // defined in CookieAuthenticationOptions.AuthenticationType
            var userIdentity = await manager.CreateIdentityAsync(this, Constants.Security.BackOfficeAuthenticationType);
            return userIdentity;
        }

        /// &lt;summary&gt;
        /// Gets/sets the user&#39;s real name
        /// &lt;/summary&gt;
        public string Name { get; set; }
        public int StartContentId { get; set; }
        public int StartMediaId { get; set; }
        public string[] AllowedSections { get; set; }
        public string Culture { get; set; }

        public string UserTypeAlias { get; set; }

        /// &lt;summary&gt;
        /// Lockout is always enabled
        /// &lt;/summary&gt;
        public override bool LockoutEnabled
        {
            get { return true; }
            set 
            {
                //do nothing 
            }
        }

        /// &lt;summary&gt;
        /// Based on the user&#39;s lockout end date, this will determine if they are locked out
        /// &lt;/summary&gt;
        internal bool IsLockedOut
        {
            get
            {
                var isLocked = (LockoutEndDateUtc.HasValue &amp;&amp; LockoutEndDateUtc.Value.ToLocalTime() &gt;= DateTime.Now);
                return isLocked;
            }
        }

        /// &lt;summary&gt;
        /// Overridden to make the retrieval lazy
        /// &lt;/summary&gt;
        public override ICollection&lt;IIdentityUserLogin&gt; Logins
        {
            get
            {
                if (_getLogins != null &amp;&amp; _getLogins.IsValueCreated == false)
                {
                    _logins = new ObservableCollection&lt;IIdentityUserLogin&gt;();
                    foreach (var l in _getLogins.Value)
                    {
                        _logins.Add(l);
                    }
                    //now assign events
                    _logins.CollectionChanged += Logins_CollectionChanged;
                }
                return _logins;
            }
        }

        public bool LoginsChanged { get; private set; }

        void Logins_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
        {
            LoginsChanged = true;
        }

        private ObservableCollection&lt;IIdentityUserLogin&gt; _logins;
        private Lazy&lt;IEnumerable&lt;IIdentityUserLogin&gt;&gt; _getLogins;

        /// &lt;summary&gt;
        /// Used to set a lazy call back to populate the user&#39;s Login list
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;callback&quot;&gt;&lt;/param&gt;
        public void SetLoginsCallback(Lazy&lt;IEnumerable&lt;IIdentityUserLogin&gt;&gt; callback)
        {
            if (callback == null) throw new ArgumentNullException(&quot;callback&quot;);
            _getLogins = callback;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[15,9,15,40,0],[16,9,16,10,0],[17,13,17,31,0],[18,13,18,33,0],[19,13,19,70,0],[20,9,20,10,0],[23,9,23,10,0],[26,13,26,121,0],[27,13,27,33,0],[28,9,28,10,0],[33,30,33,34,0],[33,35,33,39,0],[34,37,34,41,0],[34,42,34,46,0],[35,35,35,39,0],[35,40,35,44,0],[36,43,36,47,0],[36,48,36,52,0],[37,33,37,37,0],[37,38,37,42,0],[39,39,39,43,0],[39,44,39,48,0],[46,17,46,18,0],[46,19,46,31,0],[46,32,46,33,0],[48,13,48,14,0],[50,13,50,14,0],[59,13,59,14,0],[60,17,60,118,0],[61,17,61,33,0],[62,13,62,14,0],[71,13,71,14,0],[72,17,72,78,0],[73,17,73,18,0],[74,21,74,78,0],[75,21,75,28,0],[75,30,75,35,0],[75,36,75,38,0],[75,39,75,55,0],[76,21,76,22,0],[77,25,77,40,0],[78,21,78,22,0],[80,21,80,75,0],[81,17,81,18,0],[82,17,82,32,0],[83,13,83,14,0],[86,37,86,41,0],[86,42,86,54,0],[89,9,89,10,0],[90,13,90,34,0],[91,9,91,10,0],[101,9,101,10,0],[102,13,102,34,0],[102,35,102,79,0],[103,13,103,35,0],[104,9,104,10,0]]);
    </script>
  </body>
</html>