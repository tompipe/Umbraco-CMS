<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tom Pipe\Documents\Hexadigital\Code\Umbraco\Umbraco-CMS\src\Umbraco.Core\ObjectResolution\ResolverCollection.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Concurrent;
using System.Linq;

namespace Umbraco.Core.ObjectResolution
{
    /// &lt;summary&gt;
    /// Simply used to track all ManyObjectsResolverBase instances so that we can 
    /// reset them all at once really easily. 
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// Normally we&#39;d use TypeFinding for this but because many of the resolvers are internal this won&#39;t work.
    /// We&#39;d rather not keep a static list of them so we&#39;ll dynamically add to this list based on the base
    /// class of the ManyObjectsResolverBase.
    /// &lt;/remarks&gt;
    internal static class ResolverCollection
    {
        private static readonly ConcurrentDictionary&lt;ResolverBase, Action&gt; Resolvers = new ConcurrentDictionary&lt;ResolverBase, Action&gt;();

        /// &lt;summary&gt;
        /// Returns the number of resolvers created
        /// &lt;/summary&gt;
        internal static int Count
        {
            get { return Resolvers.Count; }
        }

        /// &lt;summary&gt;
        /// Resets all resolvers
        /// &lt;/summary&gt;
        internal static void ResetAll()
        {
            //take out each item from the bag and reset it
            var keys = Resolvers.Keys.ToArray();
            foreach (var k in keys)
            {
                Action resetAction;
                while (Resolvers.TryRemove(k, out resetAction))
                {
                    //call the reset action for the resolver
                    resetAction();
                }
            }
        }

        /// &lt;summary&gt;
        /// This is called when the static Reset method or a ResolverBase{T} is called.
        /// &lt;/summary&gt;
        internal static void Remove(ResolverBase resolver)
        {
            if (resolver == null) return;
            Action action;
            Resolvers.TryRemove(resolver, out action);
        }

        /// &lt;summary&gt;
        /// Adds a resolver to the collection
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;resolver&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;resetAction&quot;&gt;&lt;/param&gt;
        /// &lt;remarks&gt;
        /// This is called when the creation of a ResolverBase occurs
        /// &lt;/remarks&gt;
        internal static void Add(ResolverBase resolver, Action resetAction)
        {
            Resolvers.TryAdd(resolver, resetAction);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,137,1],[25,17,25,18,1],[25,19,25,42,1],[25,43,25,44,1],[32,9,32,10,1],[34,13,34,49,1],[35,13,35,20,1],[35,22,35,27,1],[35,28,35,30,1],[35,31,35,35,1],[36,13,36,14,1],[38,17,38,64,1],[39,17,39,18,1],[41,21,41,35,1],[42,17,42,18,1],[43,13,43,14,1],[44,9,44,10,1],[50,9,50,10,1],[51,13,51,34,1],[51,35,51,42,1],[53,13,53,55,1],[54,9,54,10,1],[65,9,65,10,1],[66,13,66,53,1],[67,9,67,10,1]]);
    </script>
  </body>
</html>